<!DOCTYPE html><html lang="ja"><head><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-XKSQ648BQ2"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}gtag('js',new Date());gtag('config','G-XKSQ648BQ2')</script><meta charSet="utf-8"/><meta name="format-detection" content="telephone=no"/><meta name="viewport" content="initial-scale=1.0, width=device-width"/><meta name="author" content="sekai"/><meta name="generator" content="https://github.com/kaz/nextjs-blog-scaffold"/><meta property="og:url" content="https://6715.jp/posts/18/"/><meta property="og:site_name" content="6715.jp"/><link rel="icon" href="https://res.cloudinary.com/narusejun/image/twitter_name/h_128/sekai67.jpg"/><link rel="canonical" href="https://6715.jp/posts/18/"/><title>クラウド東北きりたん その1 ～Win32APIでVOICEROIDを操作～ | 6715.jp</title><meta name="description" content="Win32APIでVOICEROIDをいじってみます 東北きりたん VOICEROID+ 東北きりたん EXを買いました。 http://www.ah-soft.com/voiceroid/kiri…"/><meta name="twitter:card" content="summary"/><meta property="og:title" content="クラウド東北きりたん その1 ～Win32APIでVOICEROIDを操作～ | 6715.jp"/><meta property="og:type" content="article"/><meta property="og:image" content="https://res.cloudinary.com/narusejun/image/twitter_name/h_128/sekai67.jpg"/><meta property="og:description" content="Win32APIでVOICEROIDをいじってみます 東北きりたん VOICEROID+ 東北きりたん EXを買いました。 http://www.ah-soft.com/voiceroid/kiri…"/><meta property="article:published_time" content="2017-05-25T00:00:00.000Z"/><meta property="article:author" content="sekai"/><meta property="article:tag" content="Python"/><meta property="article:tag" content="VOICEROID"/><meta property="article:tag" content="Win32API"/><meta property="article:tag" content="東北きりたん"/><meta name="next-head-count" content="22"/><link rel="preload" href="/_next/static/css/61bb26da18d2752efee9.css" as="style"/><link rel="stylesheet" href="/_next/static/css/61bb26da18d2752efee9.css" data-n-g=""/><link rel="preload" href="/_next/static/css/ad30b8ddc18c06e71d13.css" as="style"/><link rel="stylesheet" href="/_next/static/css/ad30b8ddc18c06e71d13.css" data-n-p=""/><noscript data-n-css=""></noscript></head><body><div id="__next"><header class="Header_header__1mCED"><h1><a href="/">6715.jp</a></h1></header><main class="posts_post__IJEgW"><section class="posts_meta__26MyQ"><small>2017-05-25</small><h1>クラウド東北きりたん その1 ～Win32APIでVOICEROIDを操作～</h1><div><div><img src="https://res.cloudinary.com/narusejun/image/twitter_name/h_128/sekai67.jpg" alt="sekai"/><a href="#profile">sekai</a></div><div><svg aria-hidden="true" role="img" class="octicon" viewBox="0 0 16 16" width="16" height="16" fill="currentColor" style="display:inline-block;user-select:none;vertical-align:text-bottom"><path fill-rule="evenodd" d="M2.5 7.775V2.75a.25.25 0 01.25-.25h5.025a.25.25 0 01.177.073l6.25 6.25a.25.25 0 010 .354l-5.025 5.025a.25.25 0 01-.354 0l-6.25-6.25a.25.25 0 01-.073-.177zm-1.5 0V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 010 2.474l-5.026 5.026a1.75 1.75 0 01-2.474 0l-6.25-6.25A1.75 1.75 0 011 7.775zM6 5a1 1 0 100 2 1 1 0 000-2z"></path></svg><a href="/tags/Python/">Python</a><a href="/tags/VOICEROID/">VOICEROID</a><a href="/tags/Win32API/">Win32API</a><a href="/tags/%E6%9D%B1%E5%8C%97%E3%81%8D%E3%82%8A%E3%81%9F%E3%82%93/">東北きりたん</a></div></div></section><div class="SocialShare_social__3xEln"><a rel="noopener noreferrer" target="_blank" href="https://social-plugins.line.me/lineit/share?url=https%3A%2F%2F6715.jp%2Fposts%2F18%2F"><span title="LINE" style="background-color:#00C300"><svg viewBox="0 0 24 24"><path fill="white" d="M19.365 9.863c.349 0 .63.285.63.631 0 .345-.281.63-.63.63H17.61v1.125h1.755c.349 0 .63.283.63.63 0 .344-.281.629-.63.629h-2.386c-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.63-.63h2.386c.346 0 .627.285.627.63 0 .349-.281.63-.63.63H17.61v1.125h1.755zm-3.855 3.016c0 .27-.174.51-.432.596-.064.021-.133.031-.199.031-.211 0-.391-.09-.51-.25l-2.443-3.317v2.94c0 .344-.279.629-.631.629-.346 0-.626-.285-.626-.629V8.108c0-.27.173-.51.43-.595.06-.023.136-.033.194-.033.195 0 .375.104.495.254l2.462 3.33V8.108c0-.345.282-.63.63-.63.345 0 .63.285.63.63v4.771zm-5.741 0c0 .344-.282.629-.631.629-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.63-.63.346 0 .628.285.628.63v4.771zm-2.466.629H4.917c-.345 0-.63-.285-.63-.629V8.108c0-.345.285-.63.63-.63.348 0 .63.285.63.63v4.141h1.756c.348 0 .629.283.629.63 0 .344-.282.629-.629.629M24 10.314C24 4.943 18.615.572 12 .572S0 4.943 0 10.314c0 4.811 4.27 8.842 10.035 9.608.391.082.923.258 1.058.59.12.301.079.766.038 1.08l-.164 1.02c-.045.301-.24 1.186 1.049.645 1.291-.539 6.916-4.078 9.436-6.975C23.176 14.393 24 12.458 24 10.314"></path></svg></span></a><a rel="noopener noreferrer" target="_blank" href="http://twitter.com/share?url=https%3A%2F%2F6715.jp%2Fposts%2F18%2F&amp;text=%E3%82%AF%E3%83%A9%E3%82%A6%E3%83%89%E6%9D%B1%E5%8C%97%E3%81%8D%E3%82%8A%E3%81%9F%E3%82%93%20%E3%81%9D%E3%81%AE1%20%EF%BD%9EWin32API%E3%81%A7VOICEROID%E3%82%92%E6%93%8D%E4%BD%9C%EF%BD%9E%20%7C%206715.jp"><span title="Twitter" style="background-color:#1DA1F2"><svg viewBox="0 0 24 24"><path fill="white" d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"></path></svg></span></a><a rel="noopener noreferrer" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2F6715.jp%2Fposts%2F18%2F"><span title="Facebook" style="background-color:#1877F2"><svg viewBox="0 0 24 24"><path fill="white" d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"></path></svg></span></a><a rel="noopener noreferrer" target="_blank" href="http://b.hatena.ne.jp/add?url=https%3A%2F%2F6715.jp%2Fposts%2F18%2F"><span title="Hatena Bookmark" style="background-color:#00A4DE"><svg viewBox="0 0 24 24"><path fill="white" d="M20.47 0C22.42 0 24 1.58 24 3.53v16.94c0 1.95-1.58 3.53-3.53 3.53H3.53C1.58 24 0 22.42 0 20.47V3.53C0 1.58 1.58 0 3.53 0h16.94zm-3.705 14.47c-.78 0-1.41.63-1.41 1.41s.63 1.414 1.41 1.414 1.41-.645 1.41-1.425-.63-1.41-1.41-1.41zM8.61 17.247c1.2 0 2.056-.042 2.58-.12.526-.084.976-.222 1.32-.412.45-.232.78-.564 1.02-.99s.36-.915.36-1.48c0-.78-.21-1.403-.63-1.87-.42-.48-.99-.734-1.74-.794.66-.18 1.156-.45 1.456-.81.315-.344.465-.824.465-1.424 0-.48-.103-.885-.3-1.26-.21-.36-.493-.645-.883-.87-.345-.195-.735-.315-1.215-.405-.464-.074-1.29-.12-2.474-.12H5.654v10.486H8.61zm.736-4.185c.705 0 1.185.088 1.44.262.27.18.39.495.39.93 0 .405-.135.69-.42.855-.27.18-.765.254-1.44.254H8.31v-2.297h1.05zm8.656.706v-7.06h-2.46v7.06H18zM8.925 9.08c.71 0 1.185.08 1.432.24.245.16.367.435.367.83 0 .38-.13.646-.39.804-.265.154-.747.232-1.452.232h-.57V9.08h.615z"></path></svg></span></a></div><article class="posts_content__YuXhG"><p>Win32APIでVOICEROIDをいじってみます<h1>東北きりたん</h1><p><a href=http://www.ah-soft.com/voiceroid/kiritan/ rel="noopener noreferrer"target=_blank>VOICEROID+ 東北きりたん EX</a>を買いました。<aside><a href=http://www.ah-soft.com/voiceroid/kiritan/ rel="noopener noreferrer"target=_blank style=background-image:url(http://www.ah-soft.com/images/common/socialicn_facebook.svg)><div><strong>VOICEROID+ 東北きりたん EX｜製品情報｜AHS(AH-Software)</strong><cite>www.ah-soft.com</cite><q cite=http://www.ah-soft.com/voiceroid/kiritan/>VOICEROID+ 東北きりたん EXは、声優「茜屋日海夏」の声を元に制作した、落ち着いていながらも可愛らしい声が特徴の入力文字読み上げソフトです。</q></div></a></aside><p><img alt src=kiritan.png><p>う～～～～んかわいい！！！ かわいいです。<p>声もしっとりしていて完全にボク好みです。最高。<h1>クラウドきりたん</h1><p>いろいろ使いみちが思いつくんですが、<strong>Windowsでしか動かない</strong>のがネックです……<p>HTTPでテキストをぶん投げたら音声が飛んでくる感じになったら色々幸せじゃないですか。 ということで作っていきたいと思います。<h2>Linuxで動かないかな？</h2><p>Linuxで動かすとすれば、Wineですね。<p><a href=http://pushl.net/blog/12/ rel="noopener noreferrer"target=_blank>Linux の Docker の中で voiceroid+ ゆかりさんを動かす</a>という記事を見つけました。 どうやらWineで動くみたい？しかもDockerの中で。すごい！<aside><a href=http://pushl.net/blog/12/ rel="noopener noreferrer"target=_blank style=background-image:url(http://pushl.net/blog/12/yukari_san.png)><div><strong>Linux の Docker の中で voiceroid+ ゆかりさんを動かす</strong><cite>pushl.net</cite><q cite=http://pushl.net/blog/12/></q></div></a></aside><p>試してみたんですが、うまくいきませんでした＞＜ <strong>VOICEROID+ EX</strong>になってからいろいろ変わったんでしょうか。<p>自分でもWine環境を作って試してみたんですが、 .NET Framework 3.5のインストールがうまく行かず失敗。<p>ということでWineは諦めます。<h2>WindowsServerで動かないかな？</h2><p>動作環境には当然乗っていませんが、Windows Server 2016で適当に試してみたら普通に動きました。<p>ですが、VOICEROIDにはGUIしかありません。 CUIから操作できれば全て解決なんですが、用意されてません。かなしい。<p>ということで、Win32APIを叩いて自作プログラムからVOICEROIDの機能を使えるようにしてみましょう。 とはいっても、GUIを無理やり操作して動かすだけです。 筋肉ソリューション感が否めませんが、仕方がないです。<h1>Win32APIを叩いてVOICEROIDを操作</h1><p>このテの話は、「ウィンドウ 操作 Win32API」とかでググると無限に見つかるかと思うので、ザックリとだけ説明します。<p><code>SendMessage</code>関数を使うとユーザのマウス操作やキーボード操作がエミュレートできるので、 うまい感じにテキストを入力させて保存ボタンを押させてあげれば、読み上げたwavファイルを得ることができそうです。<h2>やりました</h2><p>方針が定まったら書くだけ…… Pythonで書いてみました。<p>ffmpegを使っているので、別途用意が必要です。 必要なPythonのライブラリは<code>pypiwin32</code>です<pre><code class="hljs language-sh">pip install pypiwin32
</code></pre><h3>コード</h3><aside><a href=https://github.com/kaz/kiritan-voice rel="noopener noreferrer"target=_blank style=background-image:url(https://opengraph.githubassets.com/9a788297f5df43aaf6a607c9937e8433aad981c9a7c97f5388ae98a2618c7f53/kaz/kiritan-voice)><div><strong>kiritan-voice/talk.py at aa4c4e4ed39bb024fb50f5392c8375dc4f4fa448 · kaz/kiritan-voice</strong><cite>github.com</cite><q cite=https://github.com/kaz/kiritan-voice>VOICELOID Web API Server. Contribute to kaz/kiritan-voice development by creating an account on GitHub.</q></div></a></aside><pre><code class="hljs language-python"><span class=hljs-comment># coding: UTF-8</span>

<span class=hljs-keyword>import</span> os
<span class=hljs-keyword>import</span> sys
<span class=hljs-keyword>import</span> time
<span class=hljs-keyword>import</span> hashlib
<span class=hljs-keyword>import</span> threading
<span class=hljs-keyword>import</span> subprocess

<span class=hljs-keyword>from</span> win32con <span class=hljs-keyword>import</span> *
<span class=hljs-keyword>from</span> win32gui <span class=hljs-keyword>import</span> *
<span class=hljs-keyword>from</span> win32process <span class=hljs-keyword>import</span> *

<span class=hljs-comment># 共通設定</span>
waitSec = <span class=hljs-number>0.5</span>
windowName = <span class=hljs-string>"VOICEROID＋ 東北きりたん EX"</span>

<span class=hljs-function><span class=hljs-keyword>def</span> <span class=hljs-title>talk</span>(<span class=hljs-params>inputText</span>):</span>
	<span class=hljs-comment># 出力先ディレクトリ作成</span>
	outdir = <span class=hljs-string>"./output/"</span>
	<span class=hljs-keyword>try</span>:
		os.mkdir(outdir)
	<span class=hljs-keyword>except</span>:
		<span class=hljs-keyword>pass</span>

	<span class=hljs-comment># ファイルが存在してたらやめる</span>
	outfile = outdir + hashlib.md5(inputText.encode(<span class=hljs-string>"utf-8"</span>)).hexdigest() + <span class=hljs-string>".mp3"</span>
	<span class=hljs-keyword>if</span> os.path.exists(outfile):
		<span class=hljs-keyword>return</span> outfile

	<span class=hljs-comment># 一時ファイルが存在している間は待つ</span>
	tmpfile = <span class=hljs-string>"tmp.wav"</span>
	<span class=hljs-keyword>while</span> <span class=hljs-literal>True</span>:
		<span class=hljs-keyword>if</span> os.path.exists(outfile):
			time.sleep(waitSec)
		<span class=hljs-keyword>else</span>:
			<span class=hljs-keyword>break</span>

	<span class=hljs-keyword>while</span> <span class=hljs-literal>True</span>:
		<span class=hljs-comment># VOICEROIDプロセスを探す</span>
		window = FindWindow(<span class=hljs-literal>None</span>, windowName) <span class=hljs-keyword>or</span> FindWindow(<span class=hljs-literal>None</span>, windowName + <span class=hljs-string>"*"</span>)

		<span class=hljs-comment># 見つからなかったらVOICEROIDを起動</span>
		<span class=hljs-keyword>if</span> window == <span class=hljs-number>0</span>:
			subprocess.Popen([<span class=hljs-string>"C:\Program Files (x86)\AHS\VOICEROID+\KiritanEX\VOICEROID.exe"</span>])
			time.sleep(<span class=hljs-number>3</span> * waitSec)
		<span class=hljs-keyword>else</span>:
			<span class=hljs-keyword>break</span>

	<span class=hljs-keyword>while</span> <span class=hljs-literal>True</span>:
		<span class=hljs-comment># ダイアログが出ていたら閉じる</span>
		errorDialog = FindWindow(<span class=hljs-literal>None</span>, <span class=hljs-string>"エラー"</span>) <span class=hljs-keyword>or</span> FindWindow(<span class=hljs-literal>None</span>, <span class=hljs-string>"注意"</span>) <span class=hljs-keyword>or</span> FindWindow(<span class=hljs-literal>None</span>, <span class=hljs-string>"音声ファイルの保存"</span>)
		<span class=hljs-keyword>if</span> errorDialog:
			SendMessage(errorDialog, WM_CLOSE, <span class=hljs-number>0</span>, <span class=hljs-number>0</span>)
			time.sleep(waitSec)
		<span class=hljs-keyword>else</span>:
			<span class=hljs-keyword>break</span>

	<span class=hljs-comment># 最前列に持ってくる</span>
	SetWindowPos(window, HWND_TOPMOST, <span class=hljs-number>0</span>, <span class=hljs-number>0</span>, <span class=hljs-number>0</span>, <span class=hljs-number>0</span>, SWP_SHOWWINDOW | SWP_NOMOVE | SWP_NOSIZE)

	<span class=hljs-comment># 保存ダイアログの操作</span>
	<span class=hljs-function><span class=hljs-keyword>def</span> <span class=hljs-title>enumDialogCallback</span>(<span class=hljs-params>hwnd, param</span>):</span>
		className = GetClassName(hwnd)
		winText = GetWindowText(hwnd)

		<span class=hljs-comment># ファイル名を設定</span>
		<span class=hljs-keyword>if</span> className.count(<span class=hljs-string>"Edit"</span>):
			SendMessage(hwnd, WM_SETTEXT, <span class=hljs-number>0</span>, tmpfile)

		<span class=hljs-comment># 保存する</span>
		<span class=hljs-keyword>if</span> winText.count(<span class=hljs-string>"保存"</span>):
			SendMessage(hwnd, WM_LBUTTONDOWN, MK_LBUTTON, <span class=hljs-number>0</span>)
			SendMessage(hwnd, WM_LBUTTONUP, <span class=hljs-number>0</span>, <span class=hljs-number>0</span>)

	<span class=hljs-comment># 音声の保存</span>
	<span class=hljs-function><span class=hljs-keyword>def</span> <span class=hljs-title>save</span>():</span>
		time.sleep(waitSec)

		<span class=hljs-comment># ダイアログがあれば操作する</span>
		dialog = FindWindow(<span class=hljs-literal>None</span>, <span class=hljs-string>"音声ファイルの保存"</span>)
		<span class=hljs-keyword>if</span> dialog:
			EnumChildWindows(dialog, enumDialogCallback, <span class=hljs-literal>None</span>)
			<span class=hljs-keyword>return</span>

		<span class=hljs-comment># 再試行</span>
		save()

	<span class=hljs-comment># VOICEROIDを操作</span>
	<span class=hljs-function><span class=hljs-keyword>def</span> <span class=hljs-title>enumCallback</span>(<span class=hljs-params>hwnd, param</span>):</span>
		className = GetClassName(hwnd)
		winText = GetWindowText(hwnd)

		<span class=hljs-comment># テキストを入力する</span>
		<span class=hljs-keyword>if</span> className.count(<span class=hljs-string>"RichEdit20W"</span>):
			SendMessage(hwnd, WM_SETTEXT, <span class=hljs-number>0</span>, inputText)

		<span class=hljs-keyword>if</span> winText.count(<span class=hljs-string>"音声保存"</span>):
			<span class=hljs-comment># 最小化解除</span>
			ShowWindow(window, SW_SHOWNORMAL)

			<span class=hljs-comment># 保存ダイアログ操作用スレッド起動</span>
			threading.Thread(target=save).start()

			<span class=hljs-comment># 保存ボタンを押す</span>
			SendMessage(hwnd, WM_LBUTTONDOWN, MK_LBUTTON, <span class=hljs-number>0</span>)
			SendMessage(hwnd, WM_LBUTTONUP, <span class=hljs-number>0</span>, <span class=hljs-number>0</span>)

	<span class=hljs-comment># VOICEROIDにテキストを読ませる</span>
	EnumChildWindows(window, enumCallback, <span class=hljs-literal>None</span>)

	<span class=hljs-comment># プログレスダイアログが表示されている間は待つ</span>
	<span class=hljs-keyword>while</span> <span class=hljs-literal>True</span>:
		<span class=hljs-keyword>if</span> FindWindow(<span class=hljs-literal>None</span>, <span class=hljs-string>"音声保存"</span>):
			time.sleep(waitSec)
		<span class=hljs-keyword>else</span>:
			<span class=hljs-keyword>break</span>

	<span class=hljs-comment># MP3に変換</span>
	subprocess.run([<span class=hljs-string>"ffmpeg"</span>, <span class=hljs-string>"-i"</span>, tmpfile, <span class=hljs-string>"-acodec"</span>, <span class=hljs-string>"libmp3lame"</span>, <span class=hljs-string>"-ab"</span>, <span class=hljs-string>"128k"</span>, <span class=hljs-string>"-ac"</span>, <span class=hljs-string>"2"</span>, <span class=hljs-string>"-ar"</span>, <span class=hljs-string>"44100"</span>, outfile])

	<span class=hljs-comment># 一時ファイルが存在していたら消す</span>
	<span class=hljs-keyword>try</span>:
		os.remove(tmpfile)
		os.remove(tmpfile.replace(<span class=hljs-string>"wav"</span>, <span class=hljs-string>"txt"</span>))
	<span class=hljs-keyword>except</span>:
		<span class=hljs-keyword>pass</span>

	<span class=hljs-keyword>return</span> outfile

print(talk(sys.argv[<span class=hljs-number>1</span>]))
</code></pre><h2>注意</h2><p>一度適当なテキストを読み上げさせ、スクリプトを実行するディレクトリに保存させておく必要があります。 保存先ダイアログを操作するときに、保存先ディレクトリを変更せずに保存させるため、 スクリプトの実行ディレクトリと同じところがデフォルトになっていないと以後の処理が失敗します。<p>手抜きです……<h2>ハマりそうなポイント</h2><ul><li>ところどころにsleepを入れないと操作が失敗することがある<li>フォーカスが当たってないとか最小化されてるとかでボタン操作に失敗することがある<li>出力が終わってない状況で新しい読み上げをさせようとすると死ぬ<ul><li>今回は前のが終わるまでブロックするようにした</ul><li>Windowsのバージョンが違うと保存ウィンドウが違う気がするので上手く行かないかも<ul><li>今回はWindowsServer2016(Windows 10)です</ul><li>同じテキストの繰り返しを投げるとVOICEROIDがエラーを吐く<ul><li>よくわからん</ul></ul><h1>次回予告</h1><p>ということで、Pythonから好きなテキストをVOICEROIDに送って読み上げたWAVを得ることができるようになりました。 コレだけでもうだいぶ夢が広がるカンジですね！！<p>次回は、コイツをクラウドで動かしていつでもどこでもきりたんボイスが作れる環境を作ります。<aside><a href=/posts/19/ style=background-image:url(https://res.cloudinary.com/narusejun/image/twitter_name/h_128/sekai67.jpg)><div><strong>クラウド東北きりたん その2 ～AzureのWindowsServerでVOICEROIDを動かす～</strong><cite>6715.jp</cite><q cite=https://6715.jp/posts/19/>AzureのWindowsServerでVOICEROIDを動かします 前回の続きです。 あらすじ 前回はPythonからWin32APIをバシバシ叩いてきりたん好きなコトを喋らせることができるよう…</q></div></a></aside></article><div class="SocialShare_social__3xEln"><a rel="noopener noreferrer" target="_blank" href="https://social-plugins.line.me/lineit/share?url=https%3A%2F%2F6715.jp%2Fposts%2F18%2F"><span title="LINE" style="background-color:#00C300"><svg viewBox="0 0 24 24"><path fill="white" d="M19.365 9.863c.349 0 .63.285.63.631 0 .345-.281.63-.63.63H17.61v1.125h1.755c.349 0 .63.283.63.63 0 .344-.281.629-.63.629h-2.386c-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.63-.63h2.386c.346 0 .627.285.627.63 0 .349-.281.63-.63.63H17.61v1.125h1.755zm-3.855 3.016c0 .27-.174.51-.432.596-.064.021-.133.031-.199.031-.211 0-.391-.09-.51-.25l-2.443-3.317v2.94c0 .344-.279.629-.631.629-.346 0-.626-.285-.626-.629V8.108c0-.27.173-.51.43-.595.06-.023.136-.033.194-.033.195 0 .375.104.495.254l2.462 3.33V8.108c0-.345.282-.63.63-.63.345 0 .63.285.63.63v4.771zm-5.741 0c0 .344-.282.629-.631.629-.345 0-.627-.285-.627-.629V8.108c0-.345.282-.63.63-.63.346 0 .628.285.628.63v4.771zm-2.466.629H4.917c-.345 0-.63-.285-.63-.629V8.108c0-.345.285-.63.63-.63.348 0 .63.285.63.63v4.141h1.756c.348 0 .629.283.629.63 0 .344-.282.629-.629.629M24 10.314C24 4.943 18.615.572 12 .572S0 4.943 0 10.314c0 4.811 4.27 8.842 10.035 9.608.391.082.923.258 1.058.59.12.301.079.766.038 1.08l-.164 1.02c-.045.301-.24 1.186 1.049.645 1.291-.539 6.916-4.078 9.436-6.975C23.176 14.393 24 12.458 24 10.314"></path></svg></span></a><a rel="noopener noreferrer" target="_blank" href="http://twitter.com/share?url=https%3A%2F%2F6715.jp%2Fposts%2F18%2F&amp;text=%E3%82%AF%E3%83%A9%E3%82%A6%E3%83%89%E6%9D%B1%E5%8C%97%E3%81%8D%E3%82%8A%E3%81%9F%E3%82%93%20%E3%81%9D%E3%81%AE1%20%EF%BD%9EWin32API%E3%81%A7VOICEROID%E3%82%92%E6%93%8D%E4%BD%9C%EF%BD%9E%20%7C%206715.jp"><span title="Twitter" style="background-color:#1DA1F2"><svg viewBox="0 0 24 24"><path fill="white" d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"></path></svg></span></a><a rel="noopener noreferrer" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2F6715.jp%2Fposts%2F18%2F"><span title="Facebook" style="background-color:#1877F2"><svg viewBox="0 0 24 24"><path fill="white" d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"></path></svg></span></a><a rel="noopener noreferrer" target="_blank" href="http://b.hatena.ne.jp/add?url=https%3A%2F%2F6715.jp%2Fposts%2F18%2F"><span title="Hatena Bookmark" style="background-color:#00A4DE"><svg viewBox="0 0 24 24"><path fill="white" d="M20.47 0C22.42 0 24 1.58 24 3.53v16.94c0 1.95-1.58 3.53-3.53 3.53H3.53C1.58 24 0 22.42 0 20.47V3.53C0 1.58 1.58 0 3.53 0h16.94zm-3.705 14.47c-.78 0-1.41.63-1.41 1.41s.63 1.414 1.41 1.414 1.41-.645 1.41-1.425-.63-1.41-1.41-1.41zM8.61 17.247c1.2 0 2.056-.042 2.58-.12.526-.084.976-.222 1.32-.412.45-.232.78-.564 1.02-.99s.36-.915.36-1.48c0-.78-.21-1.403-.63-1.87-.42-.48-.99-.734-1.74-.794.66-.18 1.156-.45 1.456-.81.315-.344.465-.824.465-1.424 0-.48-.103-.885-.3-1.26-.21-.36-.493-.645-.883-.87-.345-.195-.735-.315-1.215-.405-.464-.074-1.29-.12-2.474-.12H5.654v10.486H8.61zm.736-4.185c.705 0 1.185.088 1.44.262.27.18.39.495.39.93 0 .405-.135.69-.42.855-.27.18-.765.254-1.44.254H8.31v-2.297h1.05zm8.656.706v-7.06h-2.46v7.06H18zM8.925 9.08c.71 0 1.185.08 1.432.24.245.16.367.435.367.83 0 .38-.13.646-.39.804-.265.154-.747.232-1.452.232h-.57V9.08h.615z"></path></svg></span></a></div></main><footer class="Footer_footer__22y9A"><div id="profile" class="Footer_profile__39Joc"><img src="https://res.cloudinary.com/narusejun/image/twitter_name/h_128/sekai67.jpg" alt="sekai"/><div><small>Author</small><strong>sekai<a rel="noopener noreferrer" target="_blank" href="https://github.com/kaz"><span title="GitHub" style="background-color:initial"><svg viewBox="0 0 24 24"><path fill="#181717" d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"></path></svg></span></a><a rel="noopener noreferrer" target="_blank" href="https://twitter.com/sekai67"><span title="Twitter" style="background-color:initial"><svg viewBox="0 0 24 24"><path fill="#1DA1F2" d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"></path></svg></span></a><a rel="noopener noreferrer" target="_blank" href="https://www.facebook.com/sawada.kazuki"><span title="Facebook" style="background-color:initial"><svg viewBox="0 0 24 24"><path fill="#1877F2" d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"></path></svg></span></a></strong><p>インフラとDXが好き</p></div></div><div class="Footer_copyright__3QtRW">© <!-- -->2016 sekai</div></footer></div></body></html>