{"pageProps":{"article":{"type":"article","slug":"14","body":"作りました\n\n[ConoHa Advent Calendar 2016](http://qiita.com/advent-calendar/2016/conoha) 24日目の記事です。\n\n[ConoHa Advent Calendar 2016](http://qiita.com/advent-calendar/2016/conoha)\n\n# ConoHaのDNS\n\n[ConoHa](https://www.conoha.jp/referral/?token=sp928CCbwhPZeu0SLEbeVyIhGOsIchLSzaun2yUbKWaR.q89860-OPA)には無料で使えるDNS機能が用意されています。\nなぜか[機能一覧](https://www.conoha.jp/function/)には乗ってません。見落としてるだけだろうか。GeoDNSは書いてある。\n[料金](https://www.conoha.jp/pricing/)ページには**「ドメインのレコードを登録して使うことができるDNS機能を無料提供。」**って書いてありますね。\n\n# 使ってみる\n\n登録がまだの人は急いで登録しましょう。\n[ココ](https://www.conoha.jp/referral/?token=sp928CCbwhPZeu0SLEbeVyIhGOsIchLSzaun2yUbKWaR.q89860-OPA)から登録するとクーポンもらえますよ。\n**電話認証**を選択するのを忘れずに。\n\nとりあえず、ConoHaにログインしたらまず右上のメールアドレスをクリックしてメニューを開き、「アカウント設定 > 表示設定 > モード設定」で**”このはモード”**を選択します。\n\n![](1.png)\nあぁ＾〜\n\n左のメニューから「DNS」を開けば、こんなカンジでDNSが使えます。\n\n![](2.png)\n\nもちろん、ドメインのレジストラの方でネームサーバをConoHaの`ns-a*.conoha.io`にしないとダメですよ。\n\nそれだけ。\n\n# DNS API\n\nコレだけだとまぁわざわざConoHaのDNSを使わなくてもレジストラ標準のDNSでいいじゃん！ってなるんですが、\nConoHaのDNSの強みは**APIから設定を操作できる**点にあります。\n\nCLIクライアントの[python-designateclient](http://docs.openstack.org/developer/python-designateclient/)があるのでそれを使いましょう。\n\n……だと終わってしまうので、自分が使いやすいように作った[conoha-dns](https://github.com/kaz/conoha-dns)を紹介します。\n\n# conoha-dns\n\nnodejsからDNS APIを叩くために書いたコードの副産物的に作りました。\n\nObjectStorageのCLIクライアント[conoha-ojs](https://github.com/hironobu-s/conoha-ojs)をリスペクトして\n- 認証情報をファイルに保存\n- シングルバイナリで動作\nするようになってます。\n\nAdC用に急ぎで作ったのでだいぶ作りが荒いです。\n問題が起きても責任は取れませんが、よかったら使ってください。\n\n[conoha-dns](https://github.com/kaz/conoha-dns)\n\n## 動作風景\n\nこういうかんじです。\n詳しい説明は[conoha-dns](https://github.com/kaz/conoha-dns)を見てね。\n\n```\n$ conoha-dns auth\nTenant ID: mytenantid\nAPI User: myusername\nPassword:\nOK\n\n$ conoha-dns add wataraijun.com\nid                                    name             ttl\n------------------------------------  ---------------  ----\nc8f8677e-742c-4ed6-9a53-de80d76571aa  wataraijun.com.  3600\n\n$ conoha-dns add www.wataraijun.com -t CNAME -d www.narusejun.com\nid                                    name                 type   ttl   data                priority\n------------------------------------  -------------------  -----  ----  ------------------  --------\nbb02410c-2761-4080-9b70-da7445fc714c  www.wataraijun.com.  CNAME  3600  www.narusejun.com.  null\n```\n\n## 感想\n\n- 見通しを立ててコード書くの難しい\n   - あとからいろいろ変えたらわけわからん設計になった\n- 同じコマンドで別のAPIを叩いてるのが気持ち悪いかもしれない\n   - python-swiftclientやconoha-ojsみたいに、`list`単体だとコンテナを一覧表示、`list hoge`だとコンテナの中身を一覧表示……みたいなイメージだったんだけど\n- Goはシングルバイナリで配布できる！とか持て囃されてるけどnodejsでもできるから！\n   - [nexe](https://github.com/nexe/nexe)というものを使います\n   - 一部動かないコードがあったり、nodeをまるごとコンパイルするのでクソ時間かかったりしますが……\n   - nodejs最高\n- ConoHaちゃんかわいい\n\n# 以上\n\nこのはちゃんが可愛すぎることを差し置いてもConoHaはめっちゃ良いサービスです。\nConoHa最高。\n\nサークルのブログにもConoHa関係の記事があります。\n[ConoHaでArchLinuxを動かすまで](https://trap.jp/post/39/)\n\n# 宣伝\n\n今年の冬コミ(C91)に技術系の合同誌を出します。\n\nトピックは\n- SQLインジェクション ([@N4RU5E](https://twitter.com/N4RU5E))\n- シェーダー(GLSL) ([@sobaya007](https://twitter.com/sobaya007))\n- 巡回セールスマン問題 ([@_n_ari](https://twitter.com/_n_ari))\n- LLVM ([@long_long_float](https://twitter.com/long_long_float))\n- ディープラーニング ([@to_huothu](https://twitter.com/to_huothu))\n\nの5つで200ページとなっております。\n角で殴られたら致命傷なカンジな厚さになってます。\n1000円です。\n\n**木曜日(1日目) 西地区“み”ブロック－18b**\n**「揚羽高校情報処理部」**\n\nでお待ちしています。よろしくお願いします！\n\n## 目次\n\n![](book1.png)\n![](book2.png)\n![](book3.png)\n","title":"ConoHaのDNS APIをCLIから叩くやつを作った","image":null,"tags":["ConoHa","DNS","アドベントカレンダー"],"date":"2016-12-24T00:00:00.000Z","updated":"2021-01-07T09:09:45.000Z"},"description":"作りました ConoHa Advent Calendar 2016 24日目の記事です。 ConoHa Advent Calendar 2016 ConoHaのDNS ConoHaには無料で使えるD…","content":"<p>作りました<p><a href=http://qiita.com/advent-calendar/2016/conoha rel=\"noopener noreferrer\"target=_blank>ConoHa Advent Calendar 2016</a> 24日目の記事です。<aside><a href=https://qiita.com/advent-calendar/2016/conoha rel=\"noopener noreferrer\"target=_blank style=background-image:url(https://cdn.qiita.com/assets/qiita-fb-41f9429f13a8c56f50dd0ab477c80d26.png)><div><strong>ConoHa Advent Calendar 2016 - Qiita</strong><cite>qiita.com</cite><q cite=https://qiita.com/advent-calendar/2016/conoha>めちゃ速オールSSDクラウドでお馴染み。 [ConoHa](https://www.conoha.jp/ “ConoHa”)のAdvent Calendar 2016です。 ノウハウやレビューをはじめ、便利な活用法や実装してみた話。他にもAPI、OpenStack、美雲このは先生に送るラブレターなどなど。 今年もNGワードは「おっさん」です。</q></div></a></aside><h1>ConoHaのDNS</h1><p><a href=\"https://www.conoha.jp/referral/?token=sp928CCbwhPZeu0SLEbeVyIhGOsIchLSzaun2yUbKWaR.q89860-OPA\"rel=\"noopener noreferrer\"target=_blank>ConoHa</a>には無料で使えるDNS機能が用意されています。 なぜか<a href=https://www.conoha.jp/function/ rel=\"noopener noreferrer\"target=_blank>機能一覧</a>には乗ってません。見落としてるだけだろうか。GeoDNSは書いてある。 <a href=https://www.conoha.jp/pricing/ rel=\"noopener noreferrer\"target=_blank>料金</a>ページには**「ドメインのレコードを登録して使うことができるDNS機能を無料提供。」**って書いてありますね。<h1>使ってみる</h1><p>登録がまだの人は急いで登録しましょう。 <a href=\"https://www.conoha.jp/referral/?token=sp928CCbwhPZeu0SLEbeVyIhGOsIchLSzaun2yUbKWaR.q89860-OPA\"rel=\"noopener noreferrer\"target=_blank>ココ</a>から登録するとクーポンもらえますよ。 <strong>電話認証</strong>を選択するのを忘れずに。<p>とりあえず、ConoHaにログインしたらまず右上のメールアドレスをクリックしてメニューを開き、「アカウント設定 > 表示設定 > モード設定」で**”このはモード”**を選択します。<p><img alt src=1.png> あぁ＾〜<p>左のメニューから「DNS」を開けば、こんなカンジでDNSが使えます。<p><img alt src=2.png><p>もちろん、ドメインのレジストラの方でネームサーバをConoHaの<code>ns-a*.conoha.io</code>にしないとダメですよ。<p>それだけ。<h1>DNS API</h1><p>コレだけだとまぁわざわざConoHaのDNSを使わなくてもレジストラ標準のDNSでいいじゃん！ってなるんですが、 ConoHaのDNSの強みは<strong>APIから設定を操作できる</strong>点にあります。<p>CLIクライアントの<a href=http://docs.openstack.org/developer/python-designateclient/ rel=\"noopener noreferrer\"target=_blank>python-designateclient</a>があるのでそれを使いましょう。<p>……だと終わってしまうので、自分が使いやすいように作った<a href=https://github.com/kaz/conoha-dns rel=\"noopener noreferrer\"target=_blank>conoha-dns</a>を紹介します。<h1>conoha-dns</h1><p>nodejsからDNS APIを叩くために書いたコードの副産物的に作りました。<p>ObjectStorageのCLIクライアント<a href=https://github.com/hironobu-s/conoha-ojs rel=\"noopener noreferrer\"target=_blank>conoha-ojs</a>をリスペクトして<ul><li>認証情報をファイルに保存<li>シングルバイナリで動作</ul><p>するようになってます。<p>AdC用に急ぎで作ったのでだいぶ作りが荒いです。 問題が起きても責任は取れませんが、よかったら使ってください。<aside><a href=https://github.com/kaz/conoha-dns rel=\"noopener noreferrer\"target=_blank style=background-image:url(https://opengraph.githubassets.com/28d43126e8c24b99d42025ce092a6cc1162d0b09632a9191a5a4b68514174754/kaz/conoha-dns)><div><strong>GitHub - kaz/conoha-dns: Unofficial CLI for ConoHa DNS API</strong><cite>github.com</cite><q cite=https://github.com/kaz/conoha-dns>Unofficial CLI for ConoHa DNS API. Contribute to kaz/conoha-dns development by creating an account on GitHub.</q></div></a></aside><h2>動作風景</h2><p>こういうかんじです。 詳しい説明は<a href=https://github.com/kaz/conoha-dns rel=\"noopener noreferrer\"target=_blank>conoha-dns</a>を見てね。<pre><code class=\"hljs language-apache\">$ <span class=hljs-attribute>conoha</span>-dns auth\n<span class=hljs-attribute>Tenant</span> ID: mytenantid\n<span class=hljs-attribute>API</span> User: myusername\n<span class=hljs-attribute>Password</span>:\n<span class=hljs-attribute>OK</span>\n\n$ <span class=hljs-attribute>conoha</span>-dns add wataraijun.com\n<span class=hljs-attribute>id</span>                                    name             ttl\n------------------------------------  ---------------  ----\n<span class=hljs-attribute>c8f8677e</span>-<span class=hljs-number>742</span>c-<span class=hljs-number>4</span>ed<span class=hljs-number>6</span>-<span class=hljs-number>9</span>a<span class=hljs-number>53</span>-de<span class=hljs-number>80</span>d<span class=hljs-number>76571</span>aa  wataraijun.com.  <span class=hljs-number>3600</span>\n\n$ <span class=hljs-attribute>conoha</span>-dns add www.wataraijun.com -t CNAME -d www.narusejun.com\n<span class=hljs-attribute>id</span>                                    name                 type   ttl   data                priority\n------------------------------------  -------------------  -----  ----  ------------------  --------\n<span class=hljs-attribute>bb02410c</span>-<span class=hljs-number>2761</span>-<span class=hljs-number>4080</span>-<span class=hljs-number>9</span>b<span class=hljs-number>70</span>-da<span class=hljs-number>7445</span>fc<span class=hljs-number>714</span>c  www.wataraijun.com.  CNAME  <span class=hljs-number>3600</span>  www.narusejun.com.  null\n</code></pre><h2>感想</h2><ul><li>見通しを立ててコード書くの難しい<ul><li>あとからいろいろ変えたらわけわからん設計になった</ul><li>同じコマンドで別のAPIを叩いてるのが気持ち悪いかもしれない<ul><li>python-swiftclientやconoha-ojsみたいに、<code>list</code>単体だとコンテナを一覧表示、<code>list hoge</code>だとコンテナの中身を一覧表示……みたいなイメージだったんだけど</ul><li>Goはシングルバイナリで配布できる！とか持て囃されてるけどnodejsでもできるから！<ul><li><a href=https://github.com/nexe/nexe rel=\"noopener noreferrer\"target=_blank>nexe</a>というものを使います<li>一部動かないコードがあったり、nodeをまるごとコンパイルするのでクソ時間かかったりしますが……<li>nodejs最高</ul><li>ConoHaちゃんかわいい</ul><h1>以上</h1><p>このはちゃんが可愛すぎることを差し置いてもConoHaはめっちゃ良いサービスです。 ConoHa最高。<p>サークルのブログにもConoHa関係の記事があります。 <a href=https://trap.jp/post/39/ rel=\"noopener noreferrer\"target=_blank>ConoHaでArchLinuxを動かすまで</a><h1>宣伝</h1><p>今年の冬コミ(C91)に技術系の合同誌を出します。<p>トピックは<ul><li>SQLインジェクション (<a href=https://twitter.com/N4RU5E rel=\"noopener noreferrer\"target=_blank>@N4RU5E</a>)<li>シェーダー(GLSL) (<a href=https://twitter.com/sobaya007 rel=\"noopener noreferrer\"target=_blank>@sobaya007</a>)<li>巡回セールスマン問題 (<a href=https://twitter.com/_n_ari rel=\"noopener noreferrer\"target=_blank>@_n_ari</a>)<li>LLVM (<a href=https://twitter.com/long_long_float rel=\"noopener noreferrer\"target=_blank>@long_long_float</a>)<li>ディープラーニング (<a href=https://twitter.com/to_huothu rel=\"noopener noreferrer\"target=_blank>@to_huothu</a>)</ul><p>の5つで200ページとなっております。 角で殴られたら致命傷なカンジな厚さになってます。 1000円です。<p><strong>木曜日(1日目) 西地区“み”ブロック－18b</strong> <strong>「揚羽高校情報処理部」</strong><p>でお待ちしています。よろしくお願いします！<h2>目次</h2><p><img alt src=book1.png> <img alt src=book2.png> <img alt src=book3.png>"},"__N_SSG":true}