{"pageProps":{"article":{"type":"article","slug":"5","body":"メルセンヌ・ツイスタについて。\n\nメルセンヌ・ツイスタ(MT)は擬似乱数列を作るアルゴリズムの一つで、\n他の手法と比べると欠点が少なくて高品質な擬似乱数列を高速に作れるんだって。スゴイ！\nプログラムをかじった人なら、多分聞いたことがあるんじゃないかと思います。\n\n日本初のアルゴリズムだし、日本語文献あるかな？って思ったんですけど、良い物が見つからなかった（かなしい）ので、\n元の[論文](http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/ARTICLES/mt.pdf)を読みながらRubyでMTを実装して理解を深めたいと思います。\n\nなんか強いアルゴリズムだ！って聞くとめっちゃ複雑なんじゃないかって思いがちですけど、MTはとっても<span style=\"font-size:1.5em\">**†単純†**</span>です。\n\n# MTの定義\n\n$w$ビットの整数からなる乱数列を生成する場合を考えます。\nこの時、整数を各ビットで分けて$w$次元行ベクトルとして考えることとします。\n\nすると、MTによって生成される乱数列は以下の線形漸化式によって表されます。\n\n$$\n\\begin{array}{c}\n\t\\mathbf{x}_{k+n} \\, = \\, \\mathbf{x}_{k+m} \\oplus ( \\mathbf{x}^u_k \\: | \\: \\mathbf{x}^l_{k+1} ) A \\\\\n\t(k = 0,1, \\cdots)\n\\end{array}\n$$\n\nこの式に登場する$n,m$は定数で、$1 \\le m \\le n$を満たします。\n\n$( \\mathbf{x}^u_k \\: | \\: \\mathbf{x}^l_{k+1} )$は、$\\mathbf{x}_k$の上位$w-r$ビットと$\\mathbf{x}_{k+1}$の下位$r$ビットを連結した行ベクトルを表しています。\nこの$r$も定数で、$0 \\le r \\le w-1$を満たします。\n\n$A$は以下のように定義された$w \\times w$正方行列です。\n\n$$\nA = \\left(\n\t\\begin{array}{ccccc}\n\t\t0 & 1 & 0 & 0 & 0 \\\\\n\t\t0 & 0 & 1 & 0 & 0 \\\\\n\t\t0 & 0 & 0 & \\ddots & 0 \\\\\n\t\t0 & 0 & 0 & 0 & 1 \\\\\n\t\ta_{w-1} & a_{w-2} & \\cdots & \\cdots & a_0\n\t\\end{array}\n\\right)\n$$\n\nこれによって、$\\mathbf{x} A$を以下のように高速に計算することができます。\n\n$$\n\\begin{array}{c}\n\t\\mathbf{x} A = \\begin{cases}\n\t\t(\\mathbf{x} \\gg 1) & (x_0 = 0) \\\\\n\t\t(\\mathbf{x} \\gg 1) \\oplus \\mathbf{a} & (x_0 = 1)\n\t\\end{cases} \\\\\n\t\\\\\n\t\\mathbf{x} = (x_{w-1}, x_{w-2}, \\cdots, x_0) \\\\\n\t\\mathbf{a} = (a_{w-1}, a_{w-2}, \\cdots, a_0)\n\\end{array}\n$$\n\nこうして、$w$ビットの整数、もとい$w$次元行ベクトルがたくさんできるわけですが、\nこれをそのまま乱数として出力するのはなんだかマズいらしくて、\n値を程よく分布させるため、出力する行ベクトルに$w \\times w$の適当な**正則行列**$T$を右から掛けます。\n\n$T$を右から掛ける事に相当する演算として、実際には以下の様な演算を行います。\n\n$$\n\\begin{array}{l}\n\t\\mathbf{y}_1 = \\mathbf{x} \\oplus (\\mathbf{x} \\gg u) \\\\\n\t\\mathbf{y}_2 = \\mathbf{y}_1 \\oplus ((\\mathbf{y}_1 \\ll s) \\: \\& \\: \\mathbf{b}) \\\\\n\t\\mathbf{y}_3 = \\mathbf{y}_2 \\oplus ((\\mathbf{y}_2 \\ll t) \\: \\& \\: \\mathbf{c}) \\\\\n\t\\mathbf{y}_4 = \\mathbf{y}_3 \\oplus (\\mathbf{y}_3 \\gg l)\n\\end{array}\n$$\n\n$u,s,t,l$は定数で、&はビットAND演算を表し、$\\mathbf{b}, \\mathbf{c}$は適当な行ベクトルです。\n\nこうして得られた$\\mathbf{y_4}$を出力します。\n（この操作を _Tempering_ と言うそうです。）\n\nで、途中にいろいろ定数やらなんやらが登場したんですが、これらを\n\n$$\n\\begin{array}{l}\n\tw = 32 \\\\\n\tn = 624 \\\\\n\tm = 397 \\\\\n\tr = 31 \\\\\n\tu = 11 \\\\\n\ts = 7 \\\\\n\tt = 15 \\\\\n\tl = 18 \\\\\n\t\\mathbf{a} = \\mathbf{0x9908B0DF} \\\\\n\t\\mathbf{b} = \\mathbf{0x9D2C5680} \\\\\n\t\\mathbf{c} = \\mathbf{0xEFC60000}\n\\end{array}\n$$\n\nとすると、周期が$2^{19937}-1$とめちゃくちゃ長い、かの有名なMT19937になります。\n\n# MTを実装する\n\nなんだか、 _は？_ ってカンジですね！\n\n整理すると、\n\n- 長さnの配列を用意して、適当な値で埋める（これがシード値になります）\n- i番目の乱数を得る\n  - Step.1 `z = x[i] & 0b111..1000..0 | x[(i+1)%n] & 0b000..0111..1` を計算する\n  - Step.2 `x[i] = x[(i+m)%n] ^ (z >> 1) ^ (z & 1 == 0 ? 0 : a)` を計算する\n  - Step.3 Temperingした値を返す\n\nこれだけです。シンプルだ！\n\nStep.1は$( \\mathbf{x}^u_k \\: | \\: \\mathbf{x}^l_{k+1} )$を求めることに相当します。\nStep.2は 最初の漸化式を適用することに相当し、XORで繋がれた後ろの2項は、行列$A$を掛けることに相当します。\n\n自分みたいなプログラマな人間は、たぶんソースコードを見れば一発で理解できるんじゃないかと思います。\nということで、書いてみたのが以下。\n\n```ruby\n# MT19937\nW = 32\nN = 624\nM = 397\nR = 31\nU = 11\nS = 7\nT = 15\nL = 18\nA = 0x9908B0DF\nB = 0x9D2C5680\nC = 0xEFC60000\n\n# ビットマスク用\nWHOLE_MASK = (\"1\" * W).to_i(2)\nUPPER_MASK = (\"1\" * (W - R) + \"0\" * R).to_i(2)\nLOWER_MASK = (\"0\" * (W - R) + \"1\" * R).to_i(2)\n\n# MT乱数列\nclass MT\n\t# seedを受け取って初期化\n\tdef initialize(seed)\n\t\t# MT内部状態\n\t\t@i = 0\n\t\t@x = [seed & WHOLE_MASK]\n\n\t\t# 初期化 (mt19937ar.cに準拠)\n\t\t1.upto(N-1) do |i|\n\t\t\t@x[i] = (1812433253 * (@x[i-1] ^ (@x[i-1] >> 30)) + i) & WHOLE_MASK\n\t\tend\n\tend\n\n\t# MTで乱数を生成\n\tdef next\n\t\t# Step.1\n\t\tz = @x[@i] & UPPER_MASK | @x[(@i + 1) % N] & LOWER_MASK\n\n\t\t# Step.2\n\t\t@x[@i] = @x[(@i + M) % N] ^ (z >> 1) ^ (z & 1 == 0 ? 0 : A)\n\n\t\t# Step.3\n\t\ty = @x[@i]\n\t\ty = y ^ (y >> U)\n\t\ty = y ^ ((y << S) & B)\n\t\ty = y ^ ((y << T) & C)\n\t\ty = y ^ (y >> L)\n\n\t\t# カウンタを変更して、生成した乱数を返す\n\t\t@i = (@i + 1) % N\n\t\treturn y\n\tend\nend\n\n########################################\n\n# 使ってみる\nmt = MT.new(20150919) # ← シード値\n2048.times do |i|\n\tprint i, \": \", mt.next, \"\\n\"\nend\n```\n\n（あんまり自信がないですが、MTの考案者が書いた[C++プログラム](http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/MT2002/CODES/mt19937ar.c)と出力が一致したので、多分大丈夫。）\n\nこうやってみると、本当に**単純**ですね！\nそれでいて性能がたいへんよろしいのですから、スゴイものです。\n\nちなみに↑はもともとPerlで書いてたんですが、諸事情によりRubyで書き直しました。以下はPerl版。\n\n[Perl版](https://gist.github.com/kaz/0bd9bcd72a964864e74fd55bcdfd3117)\n\n# 発展\n\nとりあえずMTがこういうものだって、わかった気になれたわけです。\n個人的には、 _Tempering_ のトコロが面白いと思っていて、ココをもうちょっと掘り下げてみたいと思います。\n\nTemperingは正則行列$T$を右から掛ける演算ですが、\nこの$T$が実際にはどんな行列なのかには、触れませんでした。\n\nでも、正則行列ってことは**逆行列**が存在して、Temperingの逆演算もできて……？\nみたいなお話です。（なんか楽しそうな気がしません？）\n\nということで、次回に続く！！！\n\n[メルセンヌ・ツイスタを倒す](/posts/6/)\n","title":"メルセンヌ・ツイスタをわかった気になる","image":null,"tags":["メルセンヌ・ツイスタ","乱数"],"date":"2016-06-26T00:00:00.000Z","updated":"2021-01-07T09:09:45.000Z"},"description":"メルセンヌ・ツイスタについて。 メルセンヌ・ツイスタ(MT)は擬似乱数列を作るアルゴリズムの一つで、 他の手法と比べると欠点が少なくて高品質な擬似乱数列を高速に作れるんだって。スゴイ！ プログラムを…","content":"<p>メルセンヌ・ツイスタについて。<p>メルセンヌ・ツイスタ(MT)は擬似乱数列を作るアルゴリズムの一つで、 他の手法と比べると欠点が少なくて高品質な擬似乱数列を高速に作れるんだって。スゴイ！ プログラムをかじった人なら、多分聞いたことがあるんじゃないかと思います。<p>日本初のアルゴリズムだし、日本語文献あるかな？って思ったんですけど、良い物が見つからなかった（かなしい）ので、 元の<a href=http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/ARTICLES/mt.pdf rel=\"noopener noreferrer\"target=_blank>論文</a>を読みながらRubyでMTを実装して理解を深めたいと思います。<p>なんか強いアルゴリズムだ！って聞くとめっちゃ複雑なんじゃないかって思いがちですけど、MTはとっても<span style=font-size:1.5em><strong>†単純†</strong></span>です。<h1>MTの定義</h1><p><span class=\"math math-inline\"><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>w</mi></mrow><annotation encoding=application/x-tex>w</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class=\"mord mathnormal\"style=margin-right:.02691em>w</span></span></span></span></span>ビットの整数からなる乱数列を生成する場合を考えます。 この時、整数を各ビットで分けて<span class=\"math math-inline\"><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>w</mi></mrow><annotation encoding=application/x-tex>w</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class=\"mord mathnormal\"style=margin-right:.02691em>w</span></span></span></span></span>次元行ベクトルとして考えることとします。<p>すると、MTによって生成される乱数列は以下の線形漸化式によって表されます。<div class=\"math math-display\"><span class=katex-display><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML display=block><semantics><mtable columnalign=center columnspacing=1em rowspacing=0.15999999999999992em><mtr><mtd><mstyle displaystyle=false scriptlevel=0><mrow><msub><mi mathvariant=bold>x</mi><mrow><mi>k</mi><mo>+</mo><mi>n</mi></mrow></msub><mtext> </mtext><mo>=</mo><mtext> </mtext><msub><mi mathvariant=bold>x</mi><mrow><mi>k</mi><mo>+</mo><mi>m</mi></mrow></msub><mo>⊕</mo><mo stretchy=false>(</mo><msubsup><mi mathvariant=bold>x</mi><mi>k</mi><mi>u</mi></msubsup><mtext> </mtext><mi mathvariant=normal>∣</mi><mtext> </mtext><msubsup><mi mathvariant=bold>x</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mi>l</mi></msubsup><mo stretchy=false>)</mo><mi>A</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=false scriptlevel=0><mrow><mo stretchy=false>(</mo><mi>k</mi><mo>=</mo><mn>0</mn><mo separator=true>,</mo><mn>1</mn><mo separator=true>,</mo><mo>⋯</mo><mtext> </mtext><mo stretchy=false>)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding=application/x-tex>\\begin{array}{c} \\mathbf{x}_{k+n} \\, = \\, \\mathbf{x}_{k+m} \\oplus ( \\mathbf{x}^u_k \\: | \\: \\mathbf{x}^l_{k+1} ) A \\\\ (k = 0,1, \\cdots) \\end{array}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:2.4091080000000007em;vertical-align:-.9545540000000006em></span><span class=mord><span class=mtable><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:1.4545540000000001em><span style=top:-3.605446em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class=mord><span class=\"mord mathbf\">x</span></span><span class=msupsub><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:.3361079999999999em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight\"><span class=\"mord mtight mathnormal\"style=margin-right:.03148em>k</span><span class=\"mtight mbin\">+</span><span class=\"mord mtight mathnormal\">n</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord><span class=mord><span class=\"mord mathbf\">x</span></span><span class=msupsub><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:.3361079999999999em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight\"><span class=\"mord mtight mathnormal\"style=margin-right:.03148em>k</span><span class=\"mtight mbin\">+</span><span class=\"mord mtight mathnormal\">m</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mopen>(</span><span class=mord><span class=mord><span class=\"mord mathbf\">x</span></span><span class=msupsub><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-2.4168920000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight mathnormal\"style=margin-right:.03148em>k</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight mathnormal\">u</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2831079999999999em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord>∣</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class=mord><span class=\"mord mathbf\">x</span></span><span class=msupsub><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:.849108em><span style=top:-2.4168920000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight\"><span class=\"mord mtight mathnormal\"style=margin-right:.03148em>k</span><span class=\"mtight mbin\">+</span><span class=\"mord mtight\">1</span></span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight mathnormal\"style=margin-right:.01968em>l</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.34143899999999994em><span></span></span></span></span></span></span><span class=mclose>)</span><span class=\"mord mathnormal\">A</span></span></span><span style=top:-2.405445999999999em><span class=pstrut style=height:3em></span><span class=mord><span class=mopen>(</span><span class=\"mord mathnormal\"style=margin-right:.03148em>k</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>0</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord>1</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>⋯</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mclose>)</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.9545540000000006em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span></span></span></span></span></span></span></div><p>この式に登場する<span class=\"math math-inline\"><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>n</mi><mo separator=true>,</mo><mi>m</mi></mrow><annotation encoding=application/x-tex>n,m</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.625em;vertical-align:-.19444em></span><span class=\"mord mathnormal\">n</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=\"mord mathnormal\">m</span></span></span></span></span>は定数で、<span class=\"math math-inline\"><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mn>1</mn><mo>≤</mo><mi>m</mi><mo>≤</mo><mi>n</mi></mrow><annotation encoding=application/x-tex>1 \\le m \\le n</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.78041em;vertical-align:-.13597em></span><span class=mord>1</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.7719400000000001em;vertical-align:-.13597em></span><span class=\"mord mathnormal\">m</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class=\"mord mathnormal\">n</span></span></span></span></span>を満たします。<p><span class=\"math math-inline\"><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mo stretchy=false>(</mo><msubsup><mi mathvariant=bold>x</mi><mi>k</mi><mi>u</mi></msubsup><mtext> </mtext><mi mathvariant=normal>∣</mi><mtext> </mtext><msubsup><mi mathvariant=bold>x</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mi>l</mi></msubsup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>( \\mathbf{x}^u_k \\: | \\: \\mathbf{x}^l_{k+1} )</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.190547em;vertical-align:-.34143899999999994em></span><span class=mopen>(</span><span class=mord><span class=mord><span class=\"mord mathbf\">x</span></span><span class=msupsub><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-2.4168920000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight mathnormal\"style=margin-right:.03148em>k</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight mathnormal\">u</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2831079999999999em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord>∣</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class=mord><span class=\"mord mathbf\">x</span></span><span class=msupsub><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:.849108em><span style=top:-2.4168920000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight\"><span class=\"mord mtight mathnormal\"style=margin-right:.03148em>k</span><span class=\"mtight mbin\">+</span><span class=\"mord mtight\">1</span></span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight mathnormal\"style=margin-right:.01968em>l</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.34143899999999994em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span></span>は、<span class=\"math math-inline\"><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi mathvariant=bold>x</mi><mi>k</mi></msub></mrow><annotation encoding=application/x-tex>\\mathbf{x}_k</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.59444em;vertical-align:-.15em></span><span class=mord><span class=mord><span class=\"mord mathbf\">x</span></span><span class=msupsub><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:.33610799999999996em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight mathnormal\"style=margin-right:.03148em>k</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span></span>の上位<span class=\"math math-inline\"><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>w</mi><mo>−</mo><mi>r</mi></mrow><annotation encoding=application/x-tex>w-r</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.66666em;vertical-align:-.08333em></span><span class=\"mord mathnormal\"style=margin-right:.02691em>w</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class=\"mord mathnormal\"style=margin-right:.02778em>r</span></span></span></span></span>ビットと<span class=\"math math-inline\"><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi mathvariant=bold>x</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding=application/x-tex>\\mathbf{x}_{k+1}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.652771em;vertical-align:-.208331em></span><span class=mord><span class=mord><span class=\"mord mathbf\">x</span></span><span class=msupsub><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:.3361079999999999em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight\"><span class=\"mord mtight mathnormal\"style=margin-right:.03148em>k</span><span class=\"mtight mbin\">+</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span></span></span></span></span>の下位<span class=\"math math-inline\"><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>r</mi></mrow><annotation encoding=application/x-tex>r</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class=\"mord mathnormal\"style=margin-right:.02778em>r</span></span></span></span></span>ビットを連結した行ベクトルを表しています。 この<span class=\"math math-inline\"><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>r</mi></mrow><annotation encoding=application/x-tex>r</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class=\"mord mathnormal\"style=margin-right:.02778em>r</span></span></span></span></span>も定数で、<span class=\"math math-inline\"><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mn>0</mn><mo>≤</mo><mi>r</mi><mo>≤</mo><mi>w</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>0 \\le r \\le w-1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.78041em;vertical-align:-.13597em></span><span class=mord>0</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.7719400000000001em;vertical-align:-.13597em></span><span class=\"mord mathnormal\"style=margin-right:.02778em>r</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≤</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:.66666em;vertical-align:-.08333em></span><span class=\"mord mathnormal\"style=margin-right:.02691em>w</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span></span>を満たします。<p><span class=\"math math-inline\"><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>A</mi></mrow><annotation encoding=application/x-tex>A</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=\"mord mathnormal\">A</span></span></span></span></span>は以下のように定義された<span class=\"math math-inline\"><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>w</mi><mo>×</mo><mi>w</mi></mrow><annotation encoding=application/x-tex>w \\times w</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.66666em;vertical-align:-.08333em></span><span class=\"mord mathnormal\"style=margin-right:.02691em>w</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>×</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class=\"mord mathnormal\"style=margin-right:.02691em>w</span></span></span></span></span>正方行列です。<div class=\"math math-display\"><span class=katex-display><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML display=block><semantics><mrow><mi>A</mi><mo>=</mo><mrow><mo fence=true>(</mo><mtable columnalign=\"center center center center center\"columnspacing=1em rowspacing=0.15999999999999992em><mtr><mtd><mstyle displaystyle=false scriptlevel=0><mn>0</mn></mstyle></mtd><mtd><mstyle displaystyle=false scriptlevel=0><mn>1</mn></mstyle></mtd><mtd><mstyle displaystyle=false scriptlevel=0><mn>0</mn></mstyle></mtd><mtd><mstyle displaystyle=false scriptlevel=0><mn>0</mn></mstyle></mtd><mtd><mstyle displaystyle=false scriptlevel=0><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=false scriptlevel=0><mn>0</mn></mstyle></mtd><mtd><mstyle displaystyle=false scriptlevel=0><mn>0</mn></mstyle></mtd><mtd><mstyle displaystyle=false scriptlevel=0><mn>1</mn></mstyle></mtd><mtd><mstyle displaystyle=false scriptlevel=0><mn>0</mn></mstyle></mtd><mtd><mstyle displaystyle=false scriptlevel=0><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=false scriptlevel=0><mn>0</mn></mstyle></mtd><mtd><mstyle displaystyle=false scriptlevel=0><mn>0</mn></mstyle></mtd><mtd><mstyle displaystyle=false scriptlevel=0><mn>0</mn></mstyle></mtd><mtd><mstyle displaystyle=false scriptlevel=0><mo lspace=0em rspace=0em>⋱</mo></mstyle></mtd><mtd><mstyle displaystyle=false scriptlevel=0><mn>0</mn></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=false scriptlevel=0><mn>0</mn></mstyle></mtd><mtd><mstyle displaystyle=false scriptlevel=0><mn>0</mn></mstyle></mtd><mtd><mstyle displaystyle=false scriptlevel=0><mn>0</mn></mstyle></mtd><mtd><mstyle displaystyle=false scriptlevel=0><mn>0</mn></mstyle></mtd><mtd><mstyle displaystyle=false scriptlevel=0><mn>1</mn></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=false scriptlevel=0><msub><mi>a</mi><mrow><mi>w</mi><mo>−</mo><mn>1</mn></mrow></msub></mstyle></mtd><mtd><mstyle displaystyle=false scriptlevel=0><msub><mi>a</mi><mrow><mi>w</mi><mo>−</mo><mn>2</mn></mrow></msub></mstyle></mtd><mtd><mstyle displaystyle=false scriptlevel=0><mo lspace=0em rspace=0em>⋯</mo></mstyle></mtd><mtd><mstyle displaystyle=false scriptlevel=0><mo lspace=0em rspace=0em>⋯</mo></mstyle></mtd><mtd><mstyle displaystyle=false scriptlevel=0><msub><mi>a</mi><mn>0</mn></msub></mstyle></mtd></mtr></mtable><mo fence=true>)</mo></mrow></mrow><annotation encoding=application/x-tex>A = \\left( \\begin{array}{ccccc} 0 &#38 1 &#38 0 &#38 0 &#38 0 \\\\ 0 &#38 0 &#38 1 &#38 0 &#38 0 \\\\ 0 &#38 0 &#38 0 &#38 \\ddots &#38 0 \\\\ 0 &#38 0 &#38 0 &#38 0 &#38 1 \\\\ a_{w-1} &#38 a_{w-2} &#38 \\cdots &#38 \\cdots &#38 a_0 \\end{array} \\right)</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=\"mord mathnormal\">A</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span></span><span class=base><span class=strut style=height:6.00008em;vertical-align:-2.75004em></span><span class=minner><span class=mopen><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:3.25004em><span style=top:-1.0499800000000006em><span class=pstrut style=height:3.1550000000000002em></span><span class=\"delim-size4 delimsizinginner\"><span>⎝</span></span></span><span style=top:-2.1999900000000006em><span class=pstrut style=height:3.1550000000000002em></span><span class=\"delim-size4 delimsizinginner\"><span>⎜</span></span></span><span style=top:-2.7950000000000004em><span class=pstrut style=height:3.1550000000000002em></span><span class=\"delim-size4 delimsizinginner\"><span>⎜</span></span></span><span style=top:-3.39001em><span class=pstrut style=height:3.1550000000000002em></span><span class=\"delim-size4 delimsizinginner\"><span>⎜</span></span></span><span style=top:-3.98502em><span class=pstrut style=height:3.1550000000000002em></span><span class=\"delim-size4 delimsizinginner\"><span>⎜</span></span></span><span style=top:-4.01002em><span class=pstrut style=height:3.1550000000000002em></span><span class=\"delim-size4 delimsizinginner\"><span>⎜</span></span></span><span style=top:-5.250039999999999em><span class=pstrut style=height:3.1550000000000002em></span><span class=\"delim-size4 delimsizinginner\"><span>⎛</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.75004em><span></span></span></span></span></span></span><span class=mord><span class=mtable><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:3.2500000000000004em><span style=top:-5.410000000000001em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>0</span></span></span><span style=top:-4.21em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>0</span></span></span><span style=top:-3.01em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>0</span></span></span><span style=top:-1.8099999999999998em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>0</span></span></span><span style=top:-.6099999999999997em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class=\"mord mathnormal\">a</span><span class=msupsub><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight\"><span class=\"mord mtight mathnormal\"style=margin-right:.02691em>w</span><span class=\"mtight mbin\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.7500000000000004em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:3.2500000000000004em><span style=top:-5.410000000000001em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>1</span></span></span><span style=top:-4.21em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>0</span></span></span><span style=top:-3.01em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>0</span></span></span><span style=top:-1.8099999999999998em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>0</span></span></span><span style=top:-.6099999999999997em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class=\"mord mathnormal\">a</span><span class=msupsub><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight\"><span class=\"mord mtight mathnormal\"style=margin-right:.02691em>w</span><span class=\"mtight mbin\">−</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.7500000000000004em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:3.2500000000000004em><span style=top:-5.410000000000001em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>0</span></span></span><span style=top:-4.21em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>1</span></span></span><span style=top:-3.01em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>0</span></span></span><span style=top:-1.8099999999999998em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>0</span></span></span><span style=top:-.6099999999999997em><span class=pstrut style=height:3em></span><span class=mord><span class=minner>⋯</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.7500000000000004em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:3.2500000000000004em><span style=top:-5.410000000000001em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>0</span></span></span><span style=top:-4.21em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>0</span></span></span><span style=top:-3.01em><span class=pstrut style=height:3em></span><span class=mord><span class=minner>⋱</span></span></span><span style=top:-1.8099999999999998em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>0</span></span></span><span style=top:-.6099999999999997em><span class=pstrut style=height:3em></span><span class=mord><span class=minner>⋯</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.7500000000000004em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:3.2500000000000004em><span style=top:-5.410000000000001em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>0</span></span></span><span style=top:-4.21em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>0</span></span></span><span style=top:-3.01em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>0</span></span></span><span style=top:-1.8099999999999998em><span class=pstrut style=height:3em></span><span class=mord><span class=mord>1</span></span></span><span style=top:-.6099999999999997em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class=\"mord mathnormal\">a</span><span class=msupsub><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight\">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.7500000000000004em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span></span></span><span class=mclose><span class=\"delimsizing mult\"><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:3.25004em><span style=top:-1.0499800000000006em><span class=pstrut style=height:3.1550000000000002em></span><span class=\"delim-size4 delimsizinginner\"><span>⎠</span></span></span><span style=top:-2.1999900000000006em><span class=pstrut style=height:3.1550000000000002em></span><span class=\"delim-size4 delimsizinginner\"><span>⎟</span></span></span><span style=top:-2.7950000000000004em><span class=pstrut style=height:3.1550000000000002em></span><span class=\"delim-size4 delimsizinginner\"><span>⎟</span></span></span><span style=top:-3.39001em><span class=pstrut style=height:3.1550000000000002em></span><span class=\"delim-size4 delimsizinginner\"><span>⎟</span></span></span><span style=top:-3.98502em><span class=pstrut style=height:3.1550000000000002em></span><span class=\"delim-size4 delimsizinginner\"><span>⎟</span></span></span><span style=top:-4.01002em><span class=pstrut style=height:3.1550000000000002em></span><span class=\"delim-size4 delimsizinginner\"><span>⎟</span></span></span><span style=top:-5.250039999999999em><span class=pstrut style=height:3.1550000000000002em></span><span class=\"delim-size4 delimsizinginner\"><span>⎞</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.75004em><span></span></span></span></span></span></span></span></span></span></span></span></div><p>これによって、<span class=\"math math-inline\"><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=bold>x</mi><mi>A</mi></mrow><annotation encoding=application/x-tex>\\mathbf{x} A</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=mord><span class=\"mord mathbf\">x</span></span><span class=\"mord mathnormal\">A</span></span></span></span></span>を以下のように高速に計算することができます。<div class=\"math math-display\"><span class=katex-display><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML display=block><semantics><mtable columnalign=center columnspacing=1em rowspacing=0.15999999999999992em><mtr><mtd><mstyle displaystyle=false scriptlevel=0><mrow><mi mathvariant=bold>x</mi><mi>A</mi><mo>=</mo><mrow><mo fence=true>{</mo><mtable columnalign=\"left left\"columnspacing=1em rowspacing=0.3599999999999999em><mtr><mtd><mstyle displaystyle=false scriptlevel=0><mrow><mo stretchy=false>(</mo><mi mathvariant=bold>x</mi><mo>≫</mo><mn>1</mn><mo stretchy=false>)</mo></mrow></mstyle></mtd><mtd><mstyle displaystyle=false scriptlevel=0><mrow><mo stretchy=false>(</mo><msub><mi>x</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn><mo stretchy=false>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=false scriptlevel=0><mrow><mo stretchy=false>(</mo><mi mathvariant=bold>x</mi><mo>≫</mo><mn>1</mn><mo stretchy=false>)</mo><mo>⊕</mo><mi mathvariant=bold>a</mi></mrow></mstyle></mtd><mtd><mstyle displaystyle=false scriptlevel=0><mrow><mo stretchy=false>(</mo><msub><mi>x</mi><mn>0</mn></msub><mo>=</mo><mn>1</mn><mo stretchy=false>)</mo></mrow></mstyle></mtd></mtr></mtable></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=false scriptlevel=0><mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=false scriptlevel=0><mrow><mi mathvariant=bold>x</mi><mo>=</mo><mo stretchy=false>(</mo><msub><mi>x</mi><mrow><mi>w</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator=true>,</mo><msub><mi>x</mi><mrow><mi>w</mi><mo>−</mo><mn>2</mn></mrow></msub><mo separator=true>,</mo><mo>⋯</mo><mtext> </mtext><mo separator=true>,</mo><msub><mi>x</mi><mn>0</mn></msub><mo stretchy=false>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=false scriptlevel=0><mrow><mi mathvariant=bold>a</mi><mo>=</mo><mo stretchy=false>(</mo><msub><mi>a</mi><mrow><mi>w</mi><mo>−</mo><mn>1</mn></mrow></msub><mo separator=true>,</mo><msub><mi>a</mi><mrow><mi>w</mi><mo>−</mo><mn>2</mn></mrow></msub><mo separator=true>,</mo><mo>⋯</mo><mtext> </mtext><mo separator=true>,</mo><msub><mi>a</mi><mn>0</mn></msub><mo stretchy=false>)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding=application/x-tex>\\begin{array}{c} \\mathbf{x} A = \\begin{cases} (\\mathbf{x} \\gg 1) &#38 (x_0 = 0) \\\\ (\\mathbf{x} \\gg 1) \\oplus \\mathbf{a} &#38 (x_0 = 1) \\end{cases} \\\\ \\\\ \\mathbf{x} = (x_{w-1}, x_{w-2}, \\cdots, x_0) \\\\ \\mathbf{a} = (a_{w-1}, a_{w-2}, \\cdots, a_0) \\end{array}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:6.60003em;vertical-align:-3.050015em></span><span class=mord><span class=mtable><span class=arraycolsep style=width:.5em></span><span class=col-align-c><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:3.550015em><span style=top:-5.550015em><span class=pstrut style=height:3.75em></span><span class=mord><span class=mord><span class=\"mord mathbf\">x</span></span><span class=\"mord mathnormal\">A</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=minner><span class=\"mopen delimcenter\"style=top:0><span class=\"delimsizing size4\">{</span></span><span class=mord><span class=mtable><span class=col-align-l><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:1.69em><span style=top:-3.69em><span class=pstrut style=height:3.008em></span><span class=mord><span class=mopen>(</span><span class=mord><span class=\"mord mathbf\">x</span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≫</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>1</span><span class=mclose>)</span></span></span><span style=top:-2.25em><span class=pstrut style=height:3.008em></span><span class=mord><span class=mopen>(</span><span class=mord><span class=\"mord mathbf\">x</span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≫</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>1</span><span class=mclose>)</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class=\"mord mathbf\">a</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.19em><span></span></span></span></span></span><span class=arraycolsep style=width:1em></span><span class=col-align-l><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:1.69em><span style=top:-3.69em><span class=pstrut style=height:3.008em></span><span class=mord><span class=mopen>(</span><span class=mord><span class=\"mord mathnormal\">x</span><span class=msupsub><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight\">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>0</span><span class=mclose>)</span></span></span><span style=top:-2.25em><span class=pstrut style=height:3.008em></span><span class=mord><span class=mopen>(</span><span class=mord><span class=\"mord mathnormal\">x</span><span class=msupsub><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight\">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>1</span><span class=mclose>)</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:1.19em><span></span></span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span><span style=top:-3.459985em><span class=pstrut style=height:3.75em></span><span class=mord></span></span><span style=top:-2.259985em><span class=pstrut style=height:3.75em></span><span class=mord><span class=mord><span class=\"mord mathbf\">x</span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mopen>(</span><span class=mord><span class=\"mord mathnormal\">x</span><span class=msupsub><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight\"><span class=\"mord mtight mathnormal\"style=margin-right:.02691em>w</span><span class=\"mtight mbin\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class=\"mord mathnormal\">x</span><span class=msupsub><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight\"><span class=\"mord mtight mathnormal\"style=margin-right:.02691em>w</span><span class=\"mtight mbin\">−</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>⋯</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class=\"mord mathnormal\">x</span><span class=msupsub><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight\">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span><span style=top:-1.059985em><span class=pstrut style=height:3.75em></span><span class=mord><span class=mord><span class=\"mord mathbf\">a</span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mopen>(</span><span class=mord><span class=\"mord mathnormal\">a</span><span class=msupsub><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight\"><span class=\"mord mtight mathnormal\"style=margin-right:.02691em>w</span><span class=\"mtight mbin\">−</span><span class=\"mord mtight\">1</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class=\"mord mathnormal\">a</span><span class=msupsub><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:.301108em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight\"><span class=\"mord mtight mathnormal\"style=margin-right:.02691em>w</span><span class=\"mtight mbin\">−</span><span class=\"mord mtight\">2</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.208331em><span></span></span></span></span></span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=minner>⋯</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class=\"mord mathnormal\">a</span><span class=msupsub><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:0;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight\">0</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:3.050015em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span></span></span></span></span></span></span></div><p>こうして、<span class=\"math math-inline\"><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>w</mi></mrow><annotation encoding=application/x-tex>w</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class=\"mord mathnormal\"style=margin-right:.02691em>w</span></span></span></span></span>ビットの整数、もとい<span class=\"math math-inline\"><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>w</mi></mrow><annotation encoding=application/x-tex>w</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class=\"mord mathnormal\"style=margin-right:.02691em>w</span></span></span></span></span>次元行ベクトルがたくさんできるわけですが、 これをそのまま乱数として出力するのはなんだかマズいらしくて、 値を程よく分布させるため、出力する行ベクトルに<span class=\"math math-inline\"><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>w</mi><mo>×</mo><mi>w</mi></mrow><annotation encoding=application/x-tex>w \\times w</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.66666em;vertical-align:-.08333em></span><span class=\"mord mathnormal\"style=margin-right:.02691em>w</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>×</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.43056em;vertical-align:0></span><span class=\"mord mathnormal\"style=margin-right:.02691em>w</span></span></span></span></span>の適当な<strong>正則行列</strong><span class=\"math math-inline\"><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>T</mi></mrow><annotation encoding=application/x-tex>T</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=\"mord mathnormal\"style=margin-right:.13889em>T</span></span></span></span></span>を右から掛けます。<p><span class=\"math math-inline\"><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>T</mi></mrow><annotation encoding=application/x-tex>T</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=\"mord mathnormal\"style=margin-right:.13889em>T</span></span></span></span></span>を右から掛ける事に相当する演算として、実際には以下の様な演算を行います。<div class=\"math math-display\"><span class=katex-display><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML display=block><semantics><mtable columnalign=left columnspacing=1em rowspacing=0.15999999999999992em><mtr><mtd><mstyle displaystyle=false scriptlevel=0><mrow><msub><mi mathvariant=bold>y</mi><mn>1</mn></msub><mo>=</mo><mi mathvariant=bold>x</mi><mo>⊕</mo><mo stretchy=false>(</mo><mi mathvariant=bold>x</mi><mo>≫</mo><mi>u</mi><mo stretchy=false>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=false scriptlevel=0><mrow><msub><mi mathvariant=bold>y</mi><mn>2</mn></msub><mo>=</mo><msub><mi mathvariant=bold>y</mi><mn>1</mn></msub><mo>⊕</mo><mo stretchy=false>(</mo><mo stretchy=false>(</mo><msub><mi mathvariant=bold>y</mi><mn>1</mn></msub><mo>≪</mo><mi>s</mi><mo stretchy=false>)</mo><mtext> </mtext><mi mathvariant=normal>&amp</mi><mtext> </mtext><mi mathvariant=bold>b</mi><mo stretchy=false>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=false scriptlevel=0><mrow><msub><mi mathvariant=bold>y</mi><mn>3</mn></msub><mo>=</mo><msub><mi mathvariant=bold>y</mi><mn>2</mn></msub><mo>⊕</mo><mo stretchy=false>(</mo><mo stretchy=false>(</mo><msub><mi mathvariant=bold>y</mi><mn>2</mn></msub><mo>≪</mo><mi>t</mi><mo stretchy=false>)</mo><mtext> </mtext><mi mathvariant=normal>&amp</mi><mtext> </mtext><mi mathvariant=bold>c</mi><mo stretchy=false>)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=false scriptlevel=0><mrow><msub><mi mathvariant=bold>y</mi><mn>4</mn></msub><mo>=</mo><msub><mi mathvariant=bold>y</mi><mn>3</mn></msub><mo>⊕</mo><mo stretchy=false>(</mo><msub><mi mathvariant=bold>y</mi><mn>3</mn></msub><mo>≫</mo><mi>l</mi><mo stretchy=false>)</mo></mrow></mstyle></mtd></mtr></mtable><annotation encoding=application/x-tex>\\begin{array}{l} \\mathbf{y}_1 = \\mathbf{x} \\oplus (\\mathbf{x} \\gg u) \\\\ \\mathbf{y}_2 = \\mathbf{y}_1 \\oplus ((\\mathbf{y}_1 \\ll s) \\: \\&#38 \\: \\mathbf{b}) \\\\ \\mathbf{y}_3 = \\mathbf{y}_2 \\oplus ((\\mathbf{y}_2 \\ll t) \\: \\&#38 \\: \\mathbf{c}) \\\\ \\mathbf{y}_4 = \\mathbf{y}_3 \\oplus (\\mathbf{y}_3 \\gg l) \\end{array}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:4.800000000000001em;vertical-align:-2.1500000000000004em></span><span class=mord><span class=mtable><span class=arraycolsep style=width:.5em></span><span class=col-align-l><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:2.6500000000000004em><span style=top:-4.8100000000000005em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class=mord><span class=\"mord mathbf\"style=margin-right:.01597em>y</span></span><span class=msupsub><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight\">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord><span class=\"mord mathbf\">x</span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mopen>(</span><span class=mord><span class=\"mord mathbf\">x</span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≫</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=\"mord mathnormal\">u</span><span class=mclose>)</span></span></span><span style=top:-3.61em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class=mord><span class=\"mord mathbf\"style=margin-right:.01597em>y</span></span><span class=msupsub><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight\">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord><span class=mord><span class=\"mord mathbf\"style=margin-right:.01597em>y</span></span><span class=msupsub><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight\">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mopen>(</span><span class=mopen>(</span><span class=mord><span class=mord><span class=\"mord mathbf\"style=margin-right:.01597em>y</span></span><span class=msupsub><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight\">1</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≪</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=\"mord mathnormal\">s</span><span class=mclose>)</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord>&amp</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class=\"mord mathbf\">b</span></span><span class=mclose>)</span></span></span><span style=top:-2.4099999999999997em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class=mord><span class=\"mord mathbf\"style=margin-right:.01597em>y</span></span><span class=msupsub><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight\">3</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord><span class=mord><span class=\"mord mathbf\"style=margin-right:.01597em>y</span></span><span class=msupsub><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight\">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mopen>(</span><span class=mopen>(</span><span class=mord><span class=mord><span class=\"mord mathbf\"style=margin-right:.01597em>y</span></span><span class=msupsub><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight\">2</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≪</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=\"mord mathnormal\">t</span><span class=mclose>)</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord>&amp</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class=\"mord mathbf\">c</span></span><span class=mclose>)</span></span></span><span style=top:-1.2099999999999997em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class=mord><span class=\"mord mathbf\"style=margin-right:.01597em>y</span></span><span class=msupsub><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight\">4</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord><span class=mord><span class=\"mord mathbf\"style=margin-right:.01597em>y</span></span><span class=msupsub><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight\">3</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>⊕</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mopen>(</span><span class=mord><span class=mord><span class=\"mord mathbf\"style=margin-right:.01597em>y</span></span><span class=msupsub><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight\">3</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>≫</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=\"mord mathnormal\"style=margin-right:.01968em>l</span><span class=mclose>)</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:2.1500000000000004em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span></span></span></span></span></span></span></div><p><span class=\"math math-inline\"><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>u</mi><mo separator=true>,</mo><mi>s</mi><mo separator=true>,</mo><mi>t</mi><mo separator=true>,</mo><mi>l</mi></mrow><annotation encoding=application/x-tex>u,s,t,l</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=\"mord mathnormal\">u</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=\"mord mathnormal\">s</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=\"mord mathnormal\">t</span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=\"mord mathnormal\"style=margin-right:.01968em>l</span></span></span></span></span>は定数で、&#38はビットAND演算を表し、<span class=\"math math-inline\"><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi mathvariant=bold>b</mi><mo separator=true>,</mo><mi mathvariant=bold>c</mi></mrow><annotation encoding=application/x-tex>\\mathbf{b}, \\mathbf{c}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.8888799999999999em;vertical-align:-.19444em></span><span class=mord><span class=\"mord mathbf\">b</span></span><span class=mpunct>,</span><span class=mspace style=margin-right:.16666666666666666em></span><span class=mord><span class=\"mord mathbf\">c</span></span></span></span></span></span>は適当な行ベクトルです。<p>こうして得られた<span class=\"math math-inline\"><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msub><mi mathvariant=bold>y</mi><mn mathvariant=bold>4</mn></msub></mrow><annotation encoding=application/x-tex>\\mathbf{y_4}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.63888em;vertical-align:-.19444em></span><span class=mord><span class=mord><span class=\"mord mathbf\"style=margin-right:.01597em>y</span><span class=msupsub><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:.30110799999999993em><span style=top:-2.5500000000000003em;margin-left:-.01597em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight mathbf\">4</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.15em><span></span></span></span></span></span></span></span></span></span></span></span>を出力します。 （この操作を <em>Tempering</em> と言うそうです。）<p>で、途中にいろいろ定数やらなんやらが登場したんですが、これらを<div class=\"math math-display\"><span class=katex-display><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML display=block><semantics><mtable columnalign=left columnspacing=1em rowspacing=0.15999999999999992em><mtr><mtd><mstyle displaystyle=false scriptlevel=0><mrow><mi>w</mi><mo>=</mo><mn>32</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=false scriptlevel=0><mrow><mi>n</mi><mo>=</mo><mn>624</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=false scriptlevel=0><mrow><mi>m</mi><mo>=</mo><mn>397</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=false scriptlevel=0><mrow><mi>r</mi><mo>=</mo><mn>31</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=false scriptlevel=0><mrow><mi>u</mi><mo>=</mo><mn>11</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=false scriptlevel=0><mrow><mi>s</mi><mo>=</mo><mn>7</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=false scriptlevel=0><mrow><mi>t</mi><mo>=</mo><mn>15</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=false scriptlevel=0><mrow><mi>l</mi><mo>=</mo><mn>18</mn></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=false scriptlevel=0><mrow><mi mathvariant=bold>a</mi><mo>=</mo><mrow><mn mathvariant=bold>0</mn><mi mathvariant=bold>x</mi><mn mathvariant=bold>9908</mn><mi mathvariant=bold>B</mi><mn mathvariant=bold>0</mn><mi mathvariant=bold>D</mi><mi mathvariant=bold>F</mi></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=false scriptlevel=0><mrow><mi mathvariant=bold>b</mi><mo>=</mo><mrow><mn mathvariant=bold>0</mn><mi mathvariant=bold>x</mi><mn mathvariant=bold>9</mn><mi mathvariant=bold>D</mi><mn mathvariant=bold>2</mn><mi mathvariant=bold>C</mi><mn mathvariant=bold>5680</mn></mrow></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle displaystyle=false scriptlevel=0><mrow><mi mathvariant=bold>c</mi><mo>=</mo><mrow><mn mathvariant=bold>0</mn><mi mathvariant=bold>x</mi><mi mathvariant=bold>E</mi><mi mathvariant=bold>F</mi><mi mathvariant=bold>C</mi><mn mathvariant=bold>60000</mn></mrow></mrow></mstyle></mtd></mtr></mtable><annotation encoding=application/x-tex>\\begin{array}{l} w = 32 \\\\ n = 624 \\\\ m = 397 \\\\ r = 31 \\\\ u = 11 \\\\ s = 7 \\\\ t = 15 \\\\ l = 18 \\\\ \\mathbf{a} = \\mathbf{0x9908B0DF} \\\\ \\mathbf{b} = \\mathbf{0x9D2C5680} \\\\ \\mathbf{c} = \\mathbf{0xEFC60000} \\end{array}</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:13.2em;vertical-align:-6.35em></span><span class=mord><span class=mtable><span class=arraycolsep style=width:.5em></span><span class=col-align-l><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:6.849999999999999em><span style=top:-9.009999999999998em><span class=pstrut style=height:3em></span><span class=mord><span class=\"mord mathnormal\"style=margin-right:.02691em>w</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>3</span><span class=mord>2</span></span></span><span style=top:-7.809999999999999em><span class=pstrut style=height:3em></span><span class=mord><span class=\"mord mathnormal\">n</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>6</span><span class=mord>2</span><span class=mord>4</span></span></span><span style=top:-6.6099999999999985em><span class=pstrut style=height:3em></span><span class=mord><span class=\"mord mathnormal\">m</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>3</span><span class=mord>9</span><span class=mord>7</span></span></span><span style=top:-5.409999999999998em><span class=pstrut style=height:3em></span><span class=mord><span class=\"mord mathnormal\"style=margin-right:.02778em>r</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>3</span><span class=mord>1</span></span></span><span style=top:-4.209999999999998em><span class=pstrut style=height:3em></span><span class=mord><span class=\"mord mathnormal\">u</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>1</span><span class=mord>1</span></span></span><span style=top:-3.0099999999999976em><span class=pstrut style=height:3em></span><span class=mord><span class=\"mord mathnormal\">s</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>7</span></span></span><span style=top:-1.8099999999999976em><span class=pstrut style=height:3em></span><span class=mord><span class=\"mord mathnormal\">t</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>1</span><span class=mord>5</span></span></span><span style=top:-.6099999999999983em><span class=pstrut style=height:3em></span><span class=mord><span class=\"mord mathnormal\"style=margin-right:.01968em>l</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord>1</span><span class=mord>8</span></span></span><span style=top:.590000000000001em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class=\"mord mathbf\">a</span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord><span class=\"mord mathbf\">0</span><span class=\"mord mathbf\">x</span><span class=\"mord mathbf\">9</span><span class=\"mord mathbf\">9</span><span class=\"mord mathbf\">0</span><span class=\"mord mathbf\">8</span><span class=\"mord mathbf\">B</span><span class=\"mord mathbf\">0</span><span class=\"mord mathbf\">D</span><span class=\"mord mathbf\">F</span></span></span></span><span style=top:1.7900000000000003em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class=\"mord mathbf\">b</span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord><span class=\"mord mathbf\">0</span><span class=\"mord mathbf\">x</span><span class=\"mord mathbf\">9</span><span class=\"mord mathbf\">D</span><span class=\"mord mathbf\">2</span><span class=\"mord mathbf\">C</span><span class=\"mord mathbf\">5</span><span class=\"mord mathbf\">6</span><span class=\"mord mathbf\">8</span><span class=\"mord mathbf\">0</span></span></span></span><span style=top:2.9899999999999998em><span class=pstrut style=height:3em></span><span class=mord><span class=mord><span class=\"mord mathbf\">c</span></span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mrel>=</span><span class=mspace style=margin-right:.2777777777777778em></span><span class=mord><span class=\"mord mathbf\">0</span><span class=\"mord mathbf\">x</span><span class=\"mord mathbf\">E</span><span class=\"mord mathbf\">F</span><span class=\"mord mathbf\">C</span><span class=\"mord mathbf\">6</span><span class=\"mord mathbf\">0</span><span class=\"mord mathbf\">0</span><span class=\"mord mathbf\">0</span><span class=\"mord mathbf\">0</span></span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:6.35em><span></span></span></span></span></span><span class=arraycolsep style=width:.5em></span></span></span></span></span></span></span></div><p>とすると、周期が<span class=\"math math-inline\"><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><msup><mn>2</mn><mn>19937</mn></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding=application/x-tex>2^{19937}-1</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.897438em;vertical-align:-.08333em></span><span class=mord><span class=mord>2</span><span class=msupsub><span class=vlist-t><span class=vlist-r><span class=vlist style=height:.8141079999999999em><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight\"><span class=\"mord mtight\">1</span><span class=\"mord mtight\">9</span><span class=\"mord mtight\">9</span><span class=\"mord mtight\">3</span><span class=\"mord mtight\">7</span></span></span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mbin>−</span><span class=mspace style=margin-right:.2222222222222222em></span></span><span class=base><span class=strut style=height:.64444em;vertical-align:0></span><span class=mord>1</span></span></span></span></span>とめちゃくちゃ長い、かの有名なMT19937になります。<h1>MTを実装する</h1><p>なんだか、 <em>は？</em> ってカンジですね！<p>整理すると、<ul><li>長さnの配列を用意して、適当な値で埋める（これがシード値になります）<li>i番目の乱数を得る<ul><li>Step.1 <code>z = x[i] &#38 0b111..1000..0 | x[(i+1)%n] &#38 0b000..0111..1</code> を計算する<li>Step.2 <code>x[i] = x[(i+m)%n] ^ (z >> 1) ^ (z &#38 1 == 0 ? 0 : a)</code> を計算する<li>Step.3 Temperingした値を返す</ul></ul><p>これだけです。シンプルだ！<p>Step.1は<span class=\"math math-inline\"><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mo stretchy=false>(</mo><msubsup><mi mathvariant=bold>x</mi><mi>k</mi><mi>u</mi></msubsup><mtext> </mtext><mi mathvariant=normal>∣</mi><mtext> </mtext><msubsup><mi mathvariant=bold>x</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mi>l</mi></msubsup><mo stretchy=false>)</mo></mrow><annotation encoding=application/x-tex>( \\mathbf{x}^u_k \\: | \\: \\mathbf{x}^l_{k+1} )</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:1.190547em;vertical-align:-.34143899999999994em></span><span class=mopen>(</span><span class=mord><span class=mord><span class=\"mord mathbf\">x</span></span><span class=msupsub><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:.664392em><span style=top:-2.4168920000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight mathnormal\"style=margin-right:.03148em>k</span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight mathnormal\">u</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.2831079999999999em><span></span></span></span></span></span></span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord>∣</span><span class=mspace style=margin-right:.2222222222222222em></span><span class=mord><span class=mord><span class=\"mord mathbf\">x</span></span><span class=msupsub><span class=\"vlist-t vlist-t2\"><span class=vlist-r><span class=vlist style=height:.849108em><span style=top:-2.4168920000000003em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight\"><span class=\"mord mtight mathnormal\"style=margin-right:.03148em>k</span><span class=\"mtight mbin\">+</span><span class=\"mord mtight\">1</span></span></span></span><span style=top:-3.063em;margin-right:.05em><span class=pstrut style=height:2.7em></span><span class=\"mtight reset-size6 size3 sizing\"><span class=\"mord mtight mathnormal\"style=margin-right:.01968em>l</span></span></span></span><span class=vlist-s>​</span></span><span class=vlist-r><span class=vlist style=height:.34143899999999994em><span></span></span></span></span></span></span><span class=mclose>)</span></span></span></span></span>を求めることに相当します。 Step.2は 最初の漸化式を適用することに相当し、XORで繋がれた後ろの2項は、行列<span class=\"math math-inline\"><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>A</mi></mrow><annotation encoding=application/x-tex>A</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=\"mord mathnormal\">A</span></span></span></span></span>を掛けることに相当します。<p>自分みたいなプログラマな人間は、たぶんソースコードを見れば一発で理解できるんじゃないかと思います。 ということで、書いてみたのが以下。<pre><code class=\"hljs language-ruby\"><span class=hljs-comment># MT19937</span>\nW = <span class=hljs-number>32</span>\nN = <span class=hljs-number>624</span>\nM = <span class=hljs-number>397</span>\nR = <span class=hljs-number>31</span>\nU = <span class=hljs-number>11</span>\nS = <span class=hljs-number>7</span>\nT = <span class=hljs-number>15</span>\nL = <span class=hljs-number>18</span>\nA = <span class=hljs-number>0x9908B0DF</span>\nB = <span class=hljs-number>0x9D2C5680</span>\nC = <span class=hljs-number>0xEFC60000</span>\n\n<span class=hljs-comment># ビットマスク用</span>\nWHOLE_MASK = (<span class=hljs-string>\"1\"</span> * W).to_i(<span class=hljs-number>2</span>)\nUPPER_MASK = (<span class=hljs-string>\"1\"</span> * (W - R) + <span class=hljs-string>\"0\"</span> * R).to_i(<span class=hljs-number>2</span>)\nLOWER_MASK = (<span class=hljs-string>\"0\"</span> * (W - R) + <span class=hljs-string>\"1\"</span> * R).to_i(<span class=hljs-number>2</span>)\n\n<span class=hljs-comment># MT乱数列</span>\n<span class=hljs-class><span class=hljs-keyword>class</span> <span class=hljs-title>MT</span></span>\n\t<span class=hljs-comment># seedを受け取って初期化</span>\n\t<span class=hljs-function><span class=hljs-keyword>def</span> <span class=hljs-title>initialize</span><span class=hljs-params>(seed)</span></span>\n\t\t<span class=hljs-comment># MT内部状態</span>\n\t\t<span class=hljs-variable>@i</span> = <span class=hljs-number>0</span>\n\t\t<span class=hljs-variable>@x</span> = [seed &#38 WHOLE_MASK]\n\n\t\t<span class=hljs-comment># 初期化 (mt19937ar.cに準拠)</span>\n\t\t<span class=hljs-number>1</span>.upto(N-<span class=hljs-number>1</span>) <span class=hljs-keyword>do</span> <span class=hljs-params>|i|</span>\n\t\t\t<span class=hljs-variable>@x</span>[i] = (<span class=hljs-number>1812433253</span> * (<span class=hljs-variable>@x</span>[i-<span class=hljs-number>1</span>] ^ (<span class=hljs-variable>@x</span>[i-<span class=hljs-number>1</span>] >> <span class=hljs-number>30</span>)) + i) &#38 WHOLE_MASK\n\t\t<span class=hljs-keyword>end</span>\n\t<span class=hljs-keyword>end</span>\n\n\t<span class=hljs-comment># MTで乱数を生成</span>\n\t<span class=hljs-function><span class=hljs-keyword>def</span> <span class=hljs-title>next</span></span>\n\t\t<span class=hljs-comment># Step.1</span>\n\t\tz = <span class=hljs-variable>@x</span>[<span class=hljs-variable>@i</span>] &#38 UPPER_MASK <span class=hljs-params>| @x[(@i + 1) % N] &#38 LOWER_MASK\n\n\t\t# Step.2\n\t\t@x[@i] = @x[(@i + M) % N] ^ (z >> 1) ^ (z &#38 1 == 0 ? 0 : A)\n\n\t\t# Step.3\n\t\ty = @x[@i]\n\t\ty = y ^ (y >> U)\n\t\ty = y ^ ((y &#60&#60 S) &#38 B)\n\t\ty = y ^ ((y &#60&#60 T) &#38 C)\n\t\ty = y ^ (y >> L)\n\n\t\t# カウンタを変更して、生成した乱数を返す\n\t\t@i = (@i + 1) % N\n\t\t<span class=hljs-keyword>return</span> y\n\t<span class=hljs-keyword>end</span>\n<span class=hljs-keyword>end</span>\n\n########################################\n\n# 使ってみる\nmt = MT.new(20150919) # ← シード値\n2048.times <span class=hljs-keyword>do</span> |</span>i<span class=hljs-params>|\n\tprint i, \": \", mt.<span class=hljs-keyword>next</span>, \"\\n\"\n<span class=hljs-keyword>end</span>\n</span></code></pre><p>（あんまり自信がないですが、MTの考案者が書いた<a href=http://www.math.sci.hiroshima-u.ac.jp/~m-mat/MT/MT2002/CODES/mt19937ar.c rel=\"noopener noreferrer\"target=_blank>C++プログラム</a>と出力が一致したので、多分大丈夫。）<p>こうやってみると、本当に<strong>単純</strong>ですね！ それでいて性能がたいへんよろしいのですから、スゴイものです。<p>ちなみに↑はもともとPerlで書いてたんですが、諸事情によりRubyで書き直しました。以下はPerl版。<aside><a href=https://gist.github.com/kaz/0bd9bcd72a964864e74fd55bcdfd3117 rel=\"noopener noreferrer\"target=_blank style=background-image:url(https://github.githubassets.com/images/modules/gists/gist-og-image.png)><div><strong>MersenneTwister</strong><cite>gist.github.com</cite><q cite=https://gist.github.com/kaz/0bd9bcd72a964864e74fd55bcdfd3117>MersenneTwister. GitHub Gist: instantly share code, notes, and snippets.</q></div></a></aside><h1>発展</h1><p>とりあえずMTがこういうものだって、わかった気になれたわけです。 個人的には、 <em>Tempering</em> のトコロが面白いと思っていて、ココをもうちょっと掘り下げてみたいと思います。<p>Temperingは正則行列<span class=\"math math-inline\"><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>T</mi></mrow><annotation encoding=application/x-tex>T</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=\"mord mathnormal\"style=margin-right:.13889em>T</span></span></span></span></span>を右から掛ける演算ですが、 この<span class=\"math math-inline\"><span class=katex><span class=katex-mathml><math xmlns=http://www.w3.org/1998/Math/MathML><semantics><mrow><mi>T</mi></mrow><annotation encoding=application/x-tex>T</annotation></semantics></math></span><span class=katex-html aria-hidden=true><span class=base><span class=strut style=height:.68333em;vertical-align:0></span><span class=\"mord mathnormal\"style=margin-right:.13889em>T</span></span></span></span></span>が実際にはどんな行列なのかには、触れませんでした。<p>でも、正則行列ってことは<strong>逆行列</strong>が存在して、Temperingの逆演算もできて……？ みたいなお話です。（なんか楽しそうな気がしません？）<p>ということで、次回に続く！！！<aside><a href=/posts/6/ style=background-image:url(https://res.cloudinary.com/narusejun/image/twitter_name/h_128/sekai67.jpg)><div><strong>メルセンヌ・ツイスタを倒す</strong><cite>6715.jp</cite><q cite=https://6715.jp/posts/6/>メルセンヌ・ツイスタの性質を理解したい。 この記事は前回の続きです。 メルセンヌ・ツイスタをわかった気になる 今日のテーマ 今日のテーマは、メルセンヌ・ツイスタ(MT)の性質についてです。 MTの生…</q></div></a></aside>"},"__N_SSG":true}