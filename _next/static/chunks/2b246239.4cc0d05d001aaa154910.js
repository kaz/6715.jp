(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[9],{BoS1:function(e,n,t){"use strict";function i(e,n){if(!(this instanceof i))return new i(e,n);TreeTransformer.call(this,this.before,this.after),this.options=defaults(e,{arguments:!n,arrows:!n,assignments:!n,booleans:!n,collapse_vars:!n,comparisons:!n,conditionals:!n,dead_code:!n,default_values:!n,directives:!n,drop_console:!1,drop_debugger:!n,evaluate:!n,expression:!1,functions:!n,global_defs:!1,hoist_funs:!1,hoist_props:!n,hoist_vars:!1,ie8:!1,if_return:!n,inline:!n,join_vars:!n,keep_fargs:n,keep_fnames:!1,keep_infinity:!1,loops:!n,merge_vars:!n,negate_iife:!n,objects:!n,passes:1,properties:!n,pure_getters:!n&&"strict",pure_funcs:null,reduce_funcs:!n,reduce_vars:!n,sequences:!n,side_effects:!n,spread:!n,strings:!n,switches:!n,top_retain:null,toplevel:!(!e||!e.top_retain),typeofs:!n,unsafe:!1,unsafe_comps:!1,unsafe_Function:!1,unsafe_math:!1,unsafe_proto:!1,unsafe_regexp:!1,unsafe_undefined:!1,unused:!n,varify:!n},!0);var t=this.options.evaluate;this.eval_threshold=/eager/.test(t)?1/0:+t;var r=this.options.global_defs;if("object"==typeof r)for(var o in r)/^@/.test(o)&&HOP(r,o)&&(r[o.slice(1)]=parse(r[o],{expression:!0}));!0===this.options.inline&&(this.options.inline=3),this.drop_fargs=this.options.keep_fargs?return_false:function(e,n){if(e.length_read)return!1;var t=e.name;if(!t)return n&&"Call"==n.TYPE&&n.expression===e;if(t.fixed_value()!==e)return!1;var i=t.definition();if(i.direct_access)return!1;var r=i.escaped;return r&&1!=r.depth};var a=this.options.pure_funcs;"function"==typeof a?this.pure_funcs=a:"string"==typeof a?this.pure_funcs=function(e){return a!==e.expression.print_to_string()}:Array.isArray(a)?this.pure_funcs=function(e){return!member(e.expression.print_to_string(),a)}:this.pure_funcs=return_true;var s=this.options.sequences;this.sequences_limit=1==s?800:0|s;var f=this.options.top_retain;f instanceof RegExp?this.top_retain=function(e){return f.test(e.name)}:"function"==typeof f?this.top_retain=f:f&&("string"==typeof f&&(f=f.split(/,/)),this.top_retain=function(e){return member(e.name,f)});var c=this.options.toplevel;this.toplevel="string"==typeof c?{funcs:/funcs/.test(c),vars:/vars/.test(c)}:{funcs:c,vars:c}}i.prototype=new TreeTransformer,merge(i.prototype,{option:function(e){return this.options[e]},exposed:function(e){if(e.undeclared)return!0;if(!(e.global||e.scope.resolve()instanceof AST_Toplevel))return!1;var n=this.toplevel;return!all(e.orig,(function(e){return n[e instanceof AST_SymbolDefun?"funcs":"vars"]}))},compress:function(e){e=e.resolve_defines(this),this.option("expression")&&e.process_expression(!0);for(var n=+this.options.passes||1,t=1/0,i=!1,r={ie8:this.option("ie8")},o=0;o<n;o++)if(e.figure_out_scope(r),(o>0||this.option("reduce_vars"))&&e.reset_opt_flags(this),e=e.transform(this),n>1){var a=0;if(e.walk(new TreeWalker((function(){a++}))),AST_Node.info("pass {pass}: last_count: {min_count}, count: {count}",{pass:o,min_count:t,count:a}),a<t)t=a,i=!1;else{if(i)break;i=!0}}return this.option("expression")&&e.process_expression(!1),e},before:function(e,n,t){if(e._squeezed)return e;var i=e instanceof AST_Scope;i&&(e.hoist_properties(this),e.hoist_declarations(this),e.process_boolean_returns(this)),n(e,this),n(e,this);var r=e.optimize(this);return!i||r!==e||this.has_directive("use asm")||r.pinned()||(r.merge_variables(this),r.drop_unused(this),n(r,this)),r===e&&(r._squeezed=!0),r}}),function(e){function n(e,n){var t=n.getProperty();if(!(t instanceof AST_Node)){var i;if(e instanceof AST_Array){var r=e.elements;if("length"==t)return T(r.length,e);"number"==typeof t&&t in r&&(i=r[t])}else if(e instanceof AST_Lambda){if("length"==t)return e.length_read=!0,T(e.argnames.length,e)}else if(e instanceof AST_Object){t=""+t;for(var o=e.properties,a=o.length;--a>=0;){if(!(o[a]instanceof AST_ObjectKeyVal))return;i||o[a].key!==t||(i=o[a].value)}}return i instanceof AST_SymbolRef&&i.fixed_value()||i}}function t(e,i,r,o,a,s,f){var c=i.parent(a);if(!(e.option("unsafe")&&c instanceof AST_Dot&&function(e,n){return e instanceof AST_Boolean?Y.Boolean[n]:e instanceof AST_Number?Y.Number[n]:e instanceof AST_String?Y.String[n]:"valueOf"!=n&&(e instanceof AST_Array?Y.Array[n]:e instanceof AST_Lambda?Y.Function[n]:e instanceof AST_Object?Y.Object[n]:e instanceof AST_RegExp?Y.RegExp[n]&&!e.value.global:void 0)}(o,c.property))){var u=z(r,c);if(u)return u;if(c instanceof AST_Array)return t(e,i,c,c,a+1);if(c instanceof AST_Call)return!s&&c.expression===r&&!c.is_expr_pure(e)&&(!is_function(o)||!(c instanceof AST_New)&&o.contains_this());if(c instanceof AST_ForIn)return c.init===r;if(c instanceof AST_ObjectKeyVal){if(c.value!==r)return;var l=i.parent(a+1);return t(e,i,l,l,a+2)}if(c instanceof AST_PropAccess){if(c.expression!==r)return;var _=n(o,c);return(!s||f)&&t(e,i,c,_,a+1)}}}function r(e){return"arguments"==e.name&&e.scope.uses_arguments}function o(e){return e.orig[0]instanceof AST_SymbolFunarg||e.orig[1]instanceof AST_SymbolFunarg}function a(e,n){do{if(e===n)return!1;if(n instanceof AST_Scope)return!0}while(n=n.parent_scope)}function s(e,n){var t=e.definition();return(!e.in_arg||!o(t))&&all(t.orig,(function(e){return!(e instanceof AST_SymbolConst||e instanceof AST_SymbolLet||n&&e instanceof AST_SymbolLambda)}))}function f(e){e._squeezed=!1,e._optimized=!1,delete e.fixed,e instanceof AST_Scope&&delete e._var_names}function c(e,n){var t=p(e,this,this);return n(t,this),t}function u(e,n){var t=new TreeWalker((function(i){return i instanceof AST_DefaultValue?(i.value.walk(n),i.name.walk(t),!0):i instanceof AST_DestructuredKeyVal?(i.key instanceof AST_Node&&i.key.walk(n),i.value.walk(t),!0):e(i)}));this.walk(t)}function l(e){return e(this)}function _(e){for(var n,t=0;n=e.parent(t++);)if(n.variables)return n}function S(e,n){if(e instanceof AST_This)return!0;if(e instanceof AST_SymbolRef){var t=e.definition();return t.lambda||n.exposed(t)&&N[t.name]}if(e instanceof AST_PropAccess){if((e=e.expression)instanceof AST_SymbolRef){if(e.is_immutable())return!1;e=e.fixed_value()}return!e||(!!e.is_constant()||S(e,n))}return!1}function p(e,n,t){return t||(t={}),n&&(t.start||(t.start=n.start),t.end||(t.end=n.end)),new e(t)}function d(e,n){return 1==n.length?n[0]:p(AST_Sequence,e,{expressions:n.reduce(v,[])})}function T(e,n){switch(typeof e){case"string":return p(AST_String,n,{value:e});case"number":return isNaN(e)?p(AST_NaN,n):isFinite(e)?1/e<0?p(AST_UnaryPrefix,n,{operator:"-",expression:p(AST_Number,n,{value:-e})}):p(AST_Number,n,{value:e}):e<0?p(AST_UnaryPrefix,n,{operator:"-",expression:p(AST_Infinity,n)}):p(AST_Infinity,n);case"boolean":return p(e?AST_True:AST_False,n);case"undefined":return p(AST_Undefined,n);default:if(null===e)return p(AST_Null,n,{value:null});if(e instanceof RegExp)return p(AST_RegExp,n,{value:e});throw new Error(string_template("Can't handle constant of type: {type}",{type:typeof e}))}}function A(e,n){return n instanceof AST_PropAccess||w(n)&&"eval"==n.name}function h(e,n,t,i){var r=!1;return"Call"==n.TYPE?r=n.expression===t&&A(0,i):n instanceof AST_UnaryPrefix&&(r="delete"==n.operator||"typeof"==n.operator&&w(i)),r?d(t,[p(AST_Number,t,{value:0}),i]):i}function v(e,n){return n instanceof AST_Sequence?e.push.apply(e,n.expressions):e.push(n),e}function m(e){if(null===e)return[];if(e instanceof AST_BlockStatement)return all(e.body,(function(e){return!(e instanceof AST_Const||e instanceof AST_Let)}))?e.body:[e];if(e instanceof AST_EmptyStatement)return[];if(e instanceof AST_Statement)return[e];throw new Error("Can't convert thing to statement array")}function g(e){return null===e||(e instanceof AST_EmptyStatement||e instanceof AST_BlockStatement&&0==e.body.length)}function y(e){return all(e.body,(function(e){return g(e)||e instanceof AST_Defun||e instanceof AST_Var&&all(e.definitions,(function(e){return!e.value}))}))}function b(e){return e instanceof AST_IterationStatement&&e.body instanceof AST_BlockStatement?e.body:e}function x(e){for(;e instanceof AST_PropAccess;)e=e.expression;return e}function k(e){if("Call"!=e.TYPE)return!1;var n=e.expression;return n instanceof AST_AsyncFunction||n instanceof AST_Function||k(n)}function w(e){return e instanceof AST_SymbolRef&&e.definition().undeclared}function D(e){return e[e instanceof AST_Assign?"right":"value"]}e(AST_Node,(function(e,n){return e})),AST_Node.DEFMETHOD("equivalent_to",(function(e){return this.TYPE==e.TYPE&&this.print_to_string()==e.print_to_string()})),AST_Scope.DEFMETHOD("process_expression",(function(e,n){var t=this,i=new TreeTransformer((function(r){if(e&&r instanceof AST_SimpleStatement)return p(AST_Return,r,{value:r.body});if(!e&&r instanceof AST_Return)return n?n(r):p(AST_SimpleStatement,r,{body:r.value||p(AST_UnaryPrefix,r,{operator:"void",expression:p(AST_Number,r,{value:0})})});if(r instanceof AST_Lambda&&r!==t)return r;if(r instanceof AST_Block){var o=r.body.length-1;o>=0&&(r.body[o]=r.body[o].transform(i))}else r instanceof AST_If?(r.body=r.body.transform(i),r.alternative&&(r.alternative=r.alternative.transform(i))):r instanceof AST_With&&(r.body=r.body.transform(i));return r}));t.transform(i)})),function(e){function i(e,n,t){t.assignments=0,t.bool_fn=0,t.cross_loop=!1,t.direct_access=!1,t.escaped=[],t.fixed=!t.const_redefs&&!t.scope.pinned()&&!n.exposed(t)&&!(is_function(t.init)&&t.init!==t.scope)&&t.init,is_defun(t.fixed)&&!all(t.references,(function(e){var n=e.scope.resolve();do{if(t.scope===n)return!0}while(is_function(n)&&(n=n.parent_scope.resolve()))}))&&(e.defun_ids[t.id]=!1),t.recursive_refs=0,t.references=[],t.should_replace=void 0,t.single_use=void 0}function c(e,n,t){t.variables.each((function(t){i(e,n,t),null===t.fixed?(t.safe_ids=e.safe_ids,A(e,t)):t.fixed&&(e.loop_ids[t.id]=e.in_loop,A(e,t))})),t.may_call_this=function(){t.may_call_this=noop,t.contains_this()&&t.functions.each((function(n){is_defun(n.init)&&!(n.id in e.defun_ids)&&(e.defun_ids[n.id]=!1)}))},t.uses_arguments&&t.each_argname((function(e){e.definition().last_ref=!1})),n.option("ie8")&&t.variables.each((function(e){var n=e.orig[0].definition();n!==e&&(n.fixed=!1)}))}function u(e,n){if(n.id in e.defun_ids){var t=e.defun_ids[n.id];if(!t)return;var i=e.defun_visited[n.id];if(t===e.safe_ids){if(!i)return n.fixed}else i?n.init.enclosed.forEach((function(t){n.init.variables.get(t.name)!==t&&(v(e,t)||(t.fixed=!1))})):e.defun_ids[n.id]=!1}else{if(!e.in_loop)return e.defun_ids[n.id]=e.safe_ids,n.fixed;e.defun_ids[n.id]=!1}}function l(e,n){n.functions.each((function(n){is_defun(n.init)&&!e.defun_visited[n.id]&&(e.defun_ids[n.id]=e.safe_ids,n.init.walk(e))}))}function _(e){e.safe_ids=Object.create(e.safe_ids)}function S(e){e.safe_ids=Object.getPrototypeOf(e.safe_ids)}function A(e,n){e.safe_ids[n.id]={}}function h(e,n){e.references.push(n),!1!==e.last_ref&&(e.last_ref=n)}function v(e,n){if("m"==n.single_use)return!1;var t=e.safe_ids[n.id];return t?(HOP(e.safe_ids,n.id)||(t.read=!(!t.read||t.read===e.safe_ids)||e.safe_ids),null==n.fixed?!r(n)&&((!n.global||"arguments"!=n.name)&&(e.loop_ids[n.id]=null,n.fixed=p(AST_Undefined,n.orig[0]),!0)):!t.assign||t.assign===e.safe_ids):is_defun(n.fixed)}function m(e,n,t){if(!t&&!all(n.orig,(function(e){return!(e instanceof AST_SymbolConst)})))return!1;if(void 0===n.fixed)return t||all(n.orig,(function(e){return!(e instanceof AST_SymbolLet)}));if(null===n.fixed&&n.safe_ids)return n.safe_ids[n.id]=!1,delete n.safe_ids,!0;if(!1===n.fixed)return!1;var i=e.safe_ids[n.id];if(!HOP(e.safe_ids,n.id)){if(!i)return!1;if(i.read&&n.scope!==e.find_parent(AST_Scope))return!1;i.assign=!(!i.assign||i.assign===e.safe_ids)||e.safe_ids}if(null!=n.fixed&&i.read){if(i.read!==e.safe_ids)return!1;if(e.loop_ids[n.id]!==e.in_loop)return!1}return v(e,n)&&all(n.orig,(function(e){return!(e instanceof AST_SymbolLambda)}))}function g(e,n){var t=p(AST_SymbolRef,e,e);return t.fixed=n||p(AST_Undefined,e),t}function y(e,t,i,r,o,a,s){var f=e.parent(a);if(!o||!o.is_constant()){if(function(e,n,t){return t instanceof AST_Assign?"="==t.operator&&t.right===n:t instanceof AST_Call?t.expression!==n||t instanceof AST_New:t instanceof AST_Exit?t.value===n&&n.scope!==e.scope:t instanceof AST_VarDef?t.value===n:void 0}(t,r,f))return t.escaped.push(f),!(s>1)||o&&o.is_constant_expression(i)||(s=1),void((!t.escaped.depth||t.escaped.depth>s)&&(t.escaped.depth=s));if(function(e,n){return n instanceof AST_Array||(n instanceof AST_Binary?U[n.operator]:n instanceof AST_Conditional?n.condition!==e:n instanceof AST_Sequence?n.tail_node()===e:void 0)}(r,f))y(e,t,i,f,f,a+1,s);else if(f instanceof AST_ObjectKeyVal&&f.value===r){var c=e.parent(a+1);y(e,t,i,c,c,a+2,s)}else if(f instanceof AST_PropAccess&&f.expression===r&&(y(e,t,i,f,o=n(o,f),a+1,s+1),o))return;a>0||f instanceof AST_Call&&f.expression===r||f instanceof AST_Sequence&&f.tail_node()!==r||f instanceof AST_SimpleStatement||f instanceof AST_Unary&&!unary_side_effects[f.operator]||(t.direct_access=!0)}}function b(e){if(e instanceof AST_Sub){var n=e.expression;if(n instanceof AST_SymbolRef){var t=n.definition();if(r(t)){var i=e.property;i.is_constant()&&(i=i.value),(i instanceof AST_Node||/^[1-9]*[0-9]$/.test(i))&&(t.reassigned=!0,(i instanceof AST_Node?t.scope.argnames:[t.scope.argnames[i]]).forEach((function(e){e instanceof AST_SymbolFunarg&&(e.definition().fixed=!1)})))}}}}function x(e,n,t,i){var r=new TreeWalker((function(n){if(n instanceof AST_DefaultValue){f(n),_(e),n.value.walk(e),S(e);var o=t;return t=function(){var e=o();return F(e)?d(n,[e,n.value]):n.name},n.name.walk(r),t=o,!0}if(n instanceof AST_DestructuredArray){f(n);o=t;return n.elements.forEach((function(e,n){if(e instanceof AST_Hole)return f(e);t=function(){return p(AST_Sub,e,{expression:o(),property:p(AST_Number,e,{value:n})})},e.walk(r)})),t=o,!0}if(n instanceof AST_DestructuredObject){f(n);o=t;return n.properties.forEach((function(n){f(n),n.key instanceof AST_Node&&(_(e),n.key.walk(e),S(e)),t=function(){var e=n.key,t=AST_Sub;return"string"==typeof e&&(is_identifier_string(e)?t=AST_Dot:e=T(e,n)),p(t,n,{expression:o(),property:e})},n.value.walk(r)})),t=o,!0}return i(n,t,(function(){for(var t=e.stack.length,i=0,o=r.stack.length-1;i<o;i++)e.stack.push(r.stack[i]);n.walk(e),e.stack.length=t})),!0}));n.walk(r)}function k(e,n,t){var i=this.name.definition().id;return e.defun_visited[i]||e.defun_ids[i]!==e.safe_ids||(e.defun_visited[i]=!0,this.inlined=!1,_(e),c(e,t,this),n(),S(e),l(e,this)),!0}function w(e,n,t){var i=this;i.inlined=!1;var r=e.parent(),o=i instanceof AST_AsyncFunction,a=!1;i.walk(new TreeWalker((function(e){return o?a=!0:e instanceof AST_Return?o=!0:e instanceof AST_Scope&&e!==i||void 0}))),a&&_(e),c(e,t,i);var s=!i.uses_arguments||e.has_directive("use strict");i.argnames.forEach((function(n,t){var o=r.args[t];x(e,n,(function(){var e=i.argnames.indexOf(n);return(e<0?o:r.args[e])||p(AST_Undefined,r)}),(function(i,o){var a=i.definition();if(s&&void 0===a.fixed){A(e,a),e.loop_ids[a.id]=e.in_loop;r.args[t];a.fixed=o,a.fixed.assigns=[n]}else a.fixed=!1}))})),i instanceof AST_Arrow&&i.value?i.value.walk(e):walk_body(i,e);var f=e.safe_ids;return S(e),l(e,i),a||(e.safe_ids=f),!0}e(AST_Node,noop),e(AST_Assign,(function(e,n,i){var r=this,o=r.left;if("="==r.operator&&o.equivalent_to(r.right)&&!o.has_side_effects(i))r.right.walk(e),function n(t){if(t instanceof AST_Dot)n(t.expression);else if(t instanceof AST_Sub)n(t.expression),t.property.walk(e);else if(t instanceof AST_SymbolRef){var i=t.definition();h(i,t),t.fixed=i.fixed}else t.walk(e)}(o),r.__drop=!0;else{if(!(o instanceof AST_Destructured||o instanceof AST_SymbolRef))return void b(o);if("="==r.operator)r.right.walk(e),x(e,o,(function(){return r.right}),(function(n,a,s){if(!(n instanceof AST_SymbolRef))return b(n),void s();var f=n.definition();f.assignments++,!t(i,e,r,r.right,0)&&m(e,f)?(h(f,n),A(e,f),f.single_use&&o instanceof AST_Destructured&&(f.single_use=!1),e.loop_ids[f.id]=e.in_loop,y(e,f,n.scope,r,r.right,0,1),n.fixed=f.fixed=a,n.fixed.assigns=[r]):(s(),f.fixed=!1)}));else{var a=o.definition();a.assignments++;var s=a.fixed;if(t(i,e,r,r,0))return void(a.fixed=!1);var f=v(e,a);r.right.walk(e),f&&m(e,a)?(h(a,o),A(e,a),a.single_use&&(a.single_use=!1),o.fixed=a.fixed=function(){return p(AST_Binary,r,{operator:r.operator.slice(0,-1),left:g(o,s),right:r.right})},o.fixed.assigns=s&&s.assigns?s.assigns.slice():[],o.fixed.assigns.push(r)):(o.walk(e),a.fixed=!1)}}return!0})),e(AST_AsyncDefun,k),e(AST_Binary,(function(e){if(U[this.operator])return this.left.walk(e),_(e),this.right.walk(e),S(e),!0})),e(AST_BlockScope,(function(e,n,t){this.variables.each((function(n){i(e,t,n)}))})),e(AST_Call,(function(e,n){e.find_parent(AST_Scope).may_call_this();var t=this.expression;if(is_function(t)){var i=!t.name;return this.args.forEach((function(n){n.walk(e),n instanceof AST_Spread&&(i=!1)})),i&&(t.reduce_vars=w),t.walk(e),i&&delete t.reduce_vars,!0}if(t instanceof AST_SymbolRef){var r=t.definition();if("Call"==this.TYPE&&e.in_boolean_context()&&r.bool_fn++,!is_defun(r.fixed))return;var o=u(e,r);if(!o)return;return n(),o.walk(e),!0}"Call"==this.TYPE&&t instanceof AST_Assign&&"="==t.operator&&t.left instanceof AST_SymbolRef&&e.in_boolean_context()&&t.left.definition().bool_fn++})),e(AST_Conditional,(function(e){return this.condition.walk(e),_(e),this.consequent.walk(e),S(e),_(e),this.alternative.walk(e),S(e),!0})),e(AST_DefaultValue,(function(e){return this.name.walk(e),_(e),this.value.walk(e),S(e),!0})),e(AST_Defun,k),e(AST_Do,(function(e){var n=e.in_loop;return e.in_loop=this,_(e),this.body.walk(e),ie(this,e.parent())&&(S(e),_(e)),this.condition.walk(e),S(e),e.in_loop=n,!0})),e(AST_For,(function(e,n,t){this.variables.each((function(n){i(e,t,n)})),this.init&&this.init.walk(e);var r=e.in_loop;return e.in_loop=this,_(e),this.condition&&this.condition.walk(e),this.body.walk(e),this.step&&(ie(this,e.parent())&&(S(e),_(e)),this.step.walk(e)),S(e),e.in_loop=r,!0})),e(AST_ForIn,(function(e,n,t){this.variables.each((function(n){i(e,t,n)})),this.object.walk(e);var r=e.in_loop;e.in_loop=this,_(e);var o=this.init;return o instanceof AST_Definitions?o.definitions[0].name.mark_symbol((function(e){if(e instanceof AST_SymbolDeclaration){var n=e.definition();n.assignments++,n.fixed=!1}}),e):o instanceof AST_Destructured||o instanceof AST_SymbolRef?o.mark_symbol((function(e){if(e instanceof AST_SymbolRef){var n=e.definition();h(n,e),n.assignments++,e.is_immutable()||(n.fixed=!1)}}),e):o.walk(e),this.body.walk(e),S(e),e.in_loop=r,!0})),e(AST_If,(function(e){return this.condition.walk(e),_(e),this.body.walk(e),S(e),this.alternative&&(_(e),this.alternative.walk(e),S(e)),!0})),e(AST_LabeledStatement,(function(e){return _(e),this.body.walk(e),S(e),!0})),e(AST_Lambda,(function(e,n,t){var i=this;return i.inlined=!1,_(e),c(e,t,i),n(),S(e),i.name&&y(e,i.name.definition(),i,i.name,i,0,1),l(e,i),!0})),e(AST_Switch,(function(e,n,t){this.variables.each((function(n){i(e,t,n)})),this.expression.walk(e);var r=!0;return this.body.forEach((function(n){n instanceof AST_Default||(n.expression.walk(e),r&&(r=!1,_(e)))})),r||S(e),walk_body(this,e),!0})),e(AST_SwitchBranch,(function(e){return _(e),walk_body(this,e),S(e),!0})),e(AST_SymbolCatch,(function(){this.definition().fixed=!1})),e(AST_SymbolRef,(function(e,n,i){var r,s=this.definition();if(h(s,this),1==s.references.length&&!s.fixed&&s.orig[0]instanceof AST_SymbolDefun&&(e.loop_ids[s.id]=e.in_loop),!1===s.fixed){var f=s.redefined();f&&a(s.scope,this.scope)&&(f.single_use=!1)}else if(void 0!==s.fixed&&v(e,s)){if(s.fixed){this.in_arg&&s.orig[0]instanceof AST_SymbolLambda&&(this.fixed=s.scope);var c=this.fixed_value(),l=me(e,s);l?s.recursive_refs++:c&&function(e,n){return e.option("unused")&&!n.scope.pinned()&&!1!==n.single_use&&n.references.length-n.recursive_refs==1&&!(o(n)&&n.scope.uses_arguments)}(i,s)?(s.in_loop=e.loop_ids[s.id]!==e.in_loop,s.single_use=c instanceof AST_Lambda&&!c.pinned()&&(!s.in_loop||e.parent()instanceof AST_Call)||!s.in_loop&&s.scope===this.scope.resolve()&&c.is_constant_expression()):s.single_use=!1,t(i,e,this,c,0,function(e){return!!e&&(e.is_constant()||e instanceof AST_Lambda||e instanceof AST_This)}(c),l)&&(s.single_use?s.single_use="m":s.fixed=!1),s.fixed&&e.loop_ids[s.id]!==e.in_loop&&(s.cross_loop=!0),y(e,s,this.scope,this,c,0,1)}}else s.fixed=!1;if(this.fixed||(this.fixed=s.fixed),is_defun(s.fixed)&&!((r=e.parent())instanceof AST_Call&&r.expression===this)){var _=u(e,s);_&&_.walk(e)}})),e(AST_Toplevel,(function(e,n,t){return this.globals.each((function(n){i(e,t,n)})),_(e),c(e,t,this),n(),S(e),l(e,this),!0})),e(AST_Try,(function(e,n,t){return this.variables.each((function(n){i(e,t,n)})),_(e),walk_body(this,e),S(e),this.bcatch&&(_(e),this.bcatch.walk(e),S(e)),this.bfinally&&this.bfinally.walk(e),!0})),e(AST_Unary,(function(e,n){var t=this;if(UNARY_POSTFIX[t.operator]){var i=t.expression;if(i instanceof AST_SymbolRef){var r=i.definition();r.assignments++;var o=r.fixed;return v(e,r)&&m(e,r)?(h(r,i),A(e,r),r.single_use&&(r.single_use=!1),r.fixed=function(){return p(AST_Binary,t,{operator:t.operator.slice(0,-1),left:p(AST_UnaryPrefix,t,{operator:"+",expression:g(i,o)}),right:p(AST_Number,t,{value:1})})},r.fixed.assigns=o&&o.assigns?o.assigns.slice():[],r.fixed.assigns.push(t),t instanceof AST_UnaryPrefix?i.fixed=r.fixed:(i.fixed=function(){return p(AST_UnaryPrefix,t,{operator:"+",expression:g(i,o)})},i.fixed.assigns=o&&o.assigns)):(i.walk(e),r.fixed=!1),!0}b(i)}})),e(AST_VarDef,(function(e){var n=this;if(n.value)return n.value.walk(e),x(e,n.name,(function(){return n.value}),(function(t,i){var r=t.definition();m(e,r,!0)?(A(e,r),e.loop_ids[r.id]=e.in_loop,r.fixed=i,r.fixed.assigns=[n],(t instanceof AST_SymbolConst&&r.redefined()||!s(t)&&!se(r))&&(r.single_use=!1)):r.fixed=!1})),!0})),e(AST_While,(function(e,n){var t=e.in_loop;return e.in_loop=this,_(e),n(),S(e),e.in_loop=t,!0}))}((function(e,n){e.DEFMETHOD("reduce_vars",n)})),AST_Toplevel.DEFMETHOD("reset_opt_flags",(function(e){var n=new TreeWalker(e.option("reduce_vars")?function(t,i){return f(t),t.reduce_vars(n,i,e)}:f);n.defun_ids=Object.create(null),n.defun_visited=Object.create(null),n.in_loop=null,n.loop_ids=Object.create(null),n.safe_ids=Object.create(null),this.walk(n)})),AST_Symbol.DEFMETHOD("fixed_value",(function(){var e=this.definition().fixed;return e?(this.fixed&&(e=this.fixed),e instanceof AST_Node?e:e()):e})),AST_SymbolRef.DEFMETHOD("is_immutable",(function(){var e=this.definition();if(1!=e.orig.length)return!1;var n=e.orig[0];return n instanceof AST_SymbolLambda&&e.scope.name===n})),AST_Node.DEFMETHOD("convert_symbol",noop),AST_Destructured.DEFMETHOD("convert_symbol",(function(e,n){return this.transform(new TreeTransformer((function(t,i){return t instanceof AST_DefaultValue?((t=t.clone()).name=t.name.transform(this),t):t instanceof AST_Destructured?(i(t=t.clone(),this),t):t instanceof AST_DestructuredKeyVal?((t=t.clone()).value=t.value.transform(this),t):t.convert_symbol(e,n)})))})),AST_SymbolDeclaration.DEFMETHOD("convert_symbol",c),AST_SymbolRef.DEFMETHOD("convert_symbol",c),AST_DefaultValue.DEFMETHOD("mark_symbol",u),AST_Destructured.DEFMETHOD("mark_symbol",u),AST_SymbolDeclaration.DEFMETHOD("mark_symbol",l),AST_SymbolRef.DEFMETHOD("mark_symbol",l),AST_Node.DEFMETHOD("match_symbol",(function(e){return e(this)})),AST_Destructured.DEFMETHOD("match_symbol",(function(e,n){var t=!1,i=new TreeWalker((function(r){return!!t||(r instanceof AST_DefaultValue?n?(r.name.walk(i),!0):t=!0:r instanceof AST_DestructuredKeyVal?!n&&r.key instanceof AST_Node?t=!0:(r.value.walk(i),!0):e(r)?t=!0:void 0)}));return this.walk(i),t}));var E=makePredicate("Array Boolean clearInterval clearTimeout console Date decodeURI decodeURIComponent encodeURI encodeURIComponent Error escape eval EvalError Function isFinite isNaN JSON Math Number parseFloat parseInt RangeError ReferenceError RegExp Object setInterval setTimeout String SyntaxError TypeError unescape URIError");AST_SymbolRef.DEFMETHOD("is_declared",(function(e){return this.defined||!this.definition().undeclared||e.option("unsafe")&&E[this.name]}));var R,N=makePredicate("Infinity NaN undefined");function C(e){return all(e.definitions,(function(e){return!e.value}))}function P(e){return e instanceof AST_Defun||e instanceof AST_Var&&C(e)}function O(e,n){var i,o,a;!function(){var e=n.self(),t=0;do{if(e instanceof AST_Catch)n.parent(t).bfinally||t++;else if(e instanceof AST_Finally)t++;else if(e instanceof AST_IterationStatement)i=!0;else{if(e instanceof AST_Scope){a=e;break}e instanceof AST_Try&&(o||(o=e))}}while(e=n.parent(t++))}();var f,c=10;do{f=!1,l(e),n.option("dead_code")&&T(e,n),n.option("if_return")&&_(e,n),n.sequences_limit>0&&(A(e,n),y(e,n)),n.option("join_vars")&&N(e),n.option("collapse_vars")&&u(e,n)}while(f&&c-- >0);return e;function u(e,n){if(a.pinned())return e;for(var c,u,l=Object.create(null),_=[],d=Object.create(null),T=e.length,A=new TreeTransformer((function(e,t){if(M)return e;if(!H)return e!==m[g]?e:++g<m.length?Z(e,A):(H=!0,(k=(b?ae:oe)(e,0))===e&&(M=!0),e);var i,a=A.parent();if(function(e,t){if(e===L)return!0;if(t instanceof AST_For)return e!==t.init;if(e instanceof AST_Assign)return"="!=e.operator&&E.equivalent_to(e.left);if(e instanceof AST_Call)return E instanceof AST_PropAccess&&(!!E.equivalent_to(e.expression)&&!(L instanceof AST_Function&&!L.contains_this()));if(e instanceof AST_Debugger)return!0;if(e instanceof AST_Defun)return P&&E.name===e.name.name;if(e instanceof AST_Destructured)return(o||!V)&&t instanceof AST_Assign;if(e instanceof AST_DestructuredKeyVal)return e.key instanceof AST_Node;if(e instanceof AST_DWLoop)return!0;if(e instanceof AST_LoopControl)return!0;if(e instanceof AST_SymbolRef){if(e.is_declared(n)){if(e.fixed_value())return!1;if(s(e))return!(t instanceof AST_PropAccess&&t.expression===e)&&r(e.definition())}else if(ee(e,t))return!1;return!I||(C=!1,!1)}return e instanceof AST_Try||e instanceof AST_With}(e,a))return M=!0,e;if(!w&&ne(e,a)&&(w=a),e.single_use&&a instanceof AST_VarDef&&a.value===e)return e;if(!(e instanceof AST_SymbolDeclaration)&&(N&&E.equivalent_to(e)||C&&(i=C(e,this)))){if(!K||w&&(i||!V||!I))return i||b||(M=!0),e;if(z(e,a))return b&&!i&&(W=!0,Y++),e;if(b)return i||Y++,e;if(Y++,f=M=!0,AST_Node.info("Collapsing {node} [{file}:{line},{col}]",{node:e,file:e.start.file,line:e.start.line,col:e.start.col}),y instanceof AST_UnaryPostfix)return E instanceof AST_SymbolRef&&(E.definition().fixed=!1),p(AST_UnaryPrefix,y,y);if(y instanceof AST_VarDef){var c=y.name.definition();return c.references.length-c.replaced!=1||n.exposed(c)?p(AST_Assign,y,{operator:"=",left:p(AST_SymbolRef,y.name,y.name),right:y.value}):(c.replaced++,h(0,a,e,y.value))}return y.write_only=!1,y}if((te(e,a)||O(e))&&(k=e,e instanceof AST_Scope&&(M=!0)),e instanceof AST_Accessor){var u=K;return K=!1,t(e,A),K=u,Q(e)}if(e instanceof AST_Destructured){u=K;return K=!1,t(e,A),K=u,Q(e)}if(e instanceof AST_DefaultValue){e.name=e.name.transform(A);u=K;return K=!1,e.value=e.value.transform(A),K=u,Q(e)}return Z(e,A)}),Q),v=new TreeTransformer((function(e){if(M)return e;if(!H){if(e!==m[g])return e;switch(g++,m.length-g){case 0:if(H=!0,W)return e;if(e instanceof AST_VarDef)return e;J.replaced++;var n=v.parent();return n instanceof AST_Sequence&&n.tail_node()!==e?(b.replaced++,List.skip):L;case 1:if(!W&&e.body===y)return H=!0,J.replaced++,b.replaced++,null;default:return}}if(e instanceof AST_SymbolRef&&e.name==J.name){if(--Y||(M=!0),z(e,v.parent()))return e;J.replaced++;var t=L.clone();return b.references.push(t),t}return e instanceof AST_Default||e instanceof AST_Scope?e:void 0}),Te);--T>=0;){0==T&&n.option("unused")&&ie();var m=[];for(re(e[T]);_.length>0;){m=_.pop();var g=0,y=m[m.length-1],b=null,k=null,w=null,E=ce(y),R=E&&E.has_side_effects(n),N=E&&!R&&!S(E,n),C=le(y);if(N||C){var P=y.name instanceof AST_SymbolFunarg,O=return_false;if(y.may_throw(n)){if(P&&a instanceof AST_AsyncFunction)continue;O=o?function(e){return e.has_side_effects(n)}:xe}var B=!1,j=!1,q=pe(y),V=Ae(E),L=D(y);R||(R=ve());var I=ge(y),H=P,M=!1,Y=0,W=!1,K=!c||!H;if(!K){for(var $=y.arg_index+1;!M&&$<c.length;$++)c[$]&&c[$].transform(A);K=!0}for(var G=T;!M&&G<e.length;G++)e[G].transform(A);if(b){var J=E.definition(),X=J.references.length-J.replaced;if(y instanceof AST_Assign&&X--,!Y||X!=Y){_.push(m),u=!0;continue}if(M=!1,Y){g=0,H=P;for(G=T;!M&&G<e.length;G++)e[G].transform(v)||e.splice(G--,1);y instanceof AST_VarDef&&(Y=!n.exposed(J)&&J.references.length==J.replaced),b.single_use=!1}}Y&&!de(y)&&e.splice(T,1)}}}function Q(e){return M||(k===e&&(M=!0),w===e&&(w=null)),e}function Z(e,n){if(e instanceof AST_BlockScope){if(e instanceof AST_Scope)return e;if(!e.variables||!e.variables.all((function(e){return!q.has(e.name)})))return M=!0,e;if(e instanceof AST_ForIn)return e.object=e.object.transform(n),M=!0,e;if(e instanceof AST_Switch){e.expression=e.expression.transform(n);for(var t=0;!M&&t<e.body.length;t++){var i=e.body[t];if(i instanceof AST_Case){if(!H){if(i!==m[g])continue;g++}if(i.expression=i.expression.transform(n),!I)break;C=!1}}return M=!0,e}}}function ee(e,n){return n instanceof AST_Assign?"="==n.operator&&n.left===e:n instanceof AST_DefaultValue?n.name===e:n instanceof AST_DestructuredArray||(n instanceof AST_DestructuredKeyVal?n.value===e:void 0)}function ne(e,n){return n instanceof AST_Binary?U[n.operator]&&n.left!==e:n instanceof AST_Case?n.expression!==e:(n instanceof AST_Conditional||n instanceof AST_If)&&n.condition!==e}function te(e,t){if(e instanceof AST_Await)return!0;if("Binary"==e.TYPE)return"in"==e.operator&&!he(e.right);if(e instanceof AST_Call){var i=e.expression;if(i instanceof AST_SymbolRef&&(p=i.definition(),i=i.fixed_value()),!(i instanceof AST_Lambda))return!0;if(p&&me(n,p))return!0;if(i.collapse_scanning)return!1;i.collapse_scanning=!0;var f=K;K=!1;var c=k,u=w;if(all(i.argnames,(function(e){if(e instanceof AST_DefaultValue){if(e.value.transform(A),M)return!1;e=e.name}return!(e instanceof AST_Destructured)})))if(i instanceof AST_Arrow&&i.value)i.value.transform(A);else for(var l=0;!M&&l<i.body.length;l++){var _=i.body[l];if(_ instanceof AST_Return){_.value&&_.value.transform(A);break}_.transform(A)}else M=!0;return w=u,k=c,K=f,delete i.collapse_scanning,M?(M=!1,!0):!1}if(e instanceof AST_Exit){if(o){if(o.bfinally)return!0;if(o.bcatch&&e instanceof AST_Throw)return!0}return R||E instanceof AST_PropAccess||be(E)}if(e instanceof AST_Function)return n.option("ie8")&&e.name&&q.has(e.name.name);if(e instanceof AST_PropAccess){var S=e.expression;return R||!b&&S.may_throw_on_access(n)||S instanceof AST_SymbolRef&&r(S.definition())}if(e instanceof AST_Spread)return!0;if(e instanceof AST_SymbolRef){if(ye(e,t))return!ee(e,t);if(R&&be(e))return!0;var p=e.definition();return(o||p.scope.resolve()!==a)&&!s(e)}if(e instanceof AST_This)return ye(e,t);if(e instanceof AST_VarDef)return!(!o&&V||!(e.name instanceof AST_Destructured))||(e.value||t instanceof AST_Let)&&e.name.match_symbol((function(e){return e instanceof AST_SymbolDeclaration&&(q.has(e.name)||R&&be(e))}),!0);var d=z(e.left,e);return!!d&&(d instanceof AST_PropAccess||(!(!o&&V||!(d instanceof AST_Destructured))||d.match_symbol((function(e){return e instanceof AST_SymbolRef&&(q.has(e.name)||B&&n.exposed(e.definition()))}),!0)))}function ie(){var e,t=n.self();if(is_function(t)&&!t.name&&!t.uses_arguments&&!t.pinned()&&(e=n.parent())instanceof AST_Call&&e.expression===t&&all(e.args,(function(e){return!(e instanceof AST_Spread)}))){var i=n.has_directive("use strict");i&&!member(i,t.body)&&(i=!1);var r=t instanceof AST_AsyncFunction?function(e){return e instanceof AST_Symbol&&"await"==e.name}:function(e){return e instanceof AST_Await&&!o.find_parent(AST_Scope)},o=new TreeWalker((function(e){if(!S)return!0;if(r(e))return S=null,!0;if(e instanceof AST_SymbolRef&&t.variables.has(e.name)){var n=e.definition().scope;if(n!==a)for(;n=n.parent_scope;)if(n===a)return!0;S=null}return e instanceof AST_This&&(i||!o.find_parent(AST_Scope))?(S=null,!0):void 0}));c=e.args.slice();for(var s=Object.create(null),f=t.argnames.length;--f>=0;){var u,l=t.argnames[f],S=e.args[f];if(l instanceof AST_DefaultValue&&(u=l.value,l=l.name,c[e.args.length+f]=u),l instanceof AST_Destructured){if(!l.match_symbol(return_false))continue;_.length=0;break}if(!(l.name in s)&&(s[l.name]=!0,u&&(S=!S||F(S)?u:null),S||u?S instanceof AST_Lambda&&S.pinned()?S=null:S&&S.walk(o):S=p(AST_Undefined,l).transform(n),S)){var d=p(AST_VarDef,l,{name:l,value:S});d.name_index=f,d.arg_index=u?e.args.length+f:f,_.unshift([d])}}}}function re(e){if(m.push(e),e instanceof AST_Array)e.elements.forEach(re);else if(e instanceof AST_Assign)e.left instanceof AST_Destructured||_.push(m.slice()),re(e.left),re(e.right),e.left instanceof AST_SymbolRef&&(l[e.left.name]=(l[e.left.name]||0)+1);else if(e instanceof AST_Await)re(e.expression);else if(e instanceof AST_Binary)re(e.left),re(e.right);else if(e instanceof AST_Call)re(e.expression),e.args.forEach(re);else if(e instanceof AST_Case)re(e.expression);else if(e instanceof AST_Conditional)re(e.condition),re(e.consequent),re(e.alternative);else if(e instanceof AST_Definitions)e.definitions.forEach(re);else if(e instanceof AST_Dot)re(e.expression);else if(e instanceof AST_DWLoop)re(e.condition),e.body instanceof AST_Block||re(e.body);else if(e instanceof AST_Exit)e.value&&re(e.value);else if(e instanceof AST_For)e.init&&re(e.init),e.condition&&re(e.condition),e.step&&re(e.step),e.body instanceof AST_Block||re(e.body);else if(e instanceof AST_ForIn)re(e.object),e.body instanceof AST_Block||re(e.body);else if(e instanceof AST_If)re(e.condition),e.body instanceof AST_Block||re(e.body),!e.alternative||e.alternative instanceof AST_Block||re(e.alternative);else if(e instanceof AST_Object)e.properties.forEach((function(e){m.push(e),e.key instanceof AST_Node&&re(e.key),e instanceof AST_ObjectKeyVal&&re(e.value),m.pop()}));else if(e instanceof AST_Sequence)e.expressions.forEach(re);else if(e instanceof AST_SimpleStatement)re(e.body);else if(e instanceof AST_Spread)re(e.expression);else if(e instanceof AST_Sub)re(e.expression),re(e.property);else if(e instanceof AST_Switch)re(e.expression),e.body.forEach(re);else if(e instanceof AST_Unary)UNARY_POSTFIX[e.operator]?_.push(m.slice()):re(e.expression);else if(e instanceof AST_VarDef){if(e.name instanceof AST_SymbolVar)if(e.value){var n=e.name.definition();n.references.length>n.replaced&&_.push(m.slice())}else d[e.name.name]=(d[e.name.name]||0)+1;e.value&&re(e.value)}m.pop()}function oe(e,n){var t=A.parent(n);return t instanceof AST_Array||t instanceof AST_Assign||t instanceof AST_Await||t instanceof AST_Binary||t instanceof AST_Call||t instanceof AST_Case||t instanceof AST_Conditional?e:t instanceof AST_Definitions?se(t,n+1):t instanceof AST_Exit||t instanceof AST_If||t instanceof AST_IterationStatement||t instanceof AST_ObjectProperty||t instanceof AST_PropAccess?e:t instanceof AST_Sequence?(t.tail_node()===e?oe:se)(t,n+1):t instanceof AST_SimpleStatement?se(t,n+1):t instanceof AST_Spread||t instanceof AST_Switch||t instanceof AST_Unary||t instanceof AST_VarDef?e:null}function ae(e,n){var t=A.parent(n);if(t instanceof AST_Array)return ae(t,n+1);if(t instanceof AST_Assign)return O(t)||t.left.match_symbol((function(e){return e instanceof AST_SymbolRef&&(E.name==e.name||b.name==e.name)}))?e:ae(t,n+1);if(t instanceof AST_Binary){if(U[t.operator]&&t.left!==e){do{e=t,t=A.parent(++n)}while(t instanceof AST_Binary&&t.operator==e.operator);return e}return ae(t,n+1)}if(t instanceof AST_Call)return t;if(t instanceof AST_Case)return t.expression!==e?e:ae(t,n+1);if(t instanceof AST_Conditional)return t.condition!==e?e:ae(t,n+1);if(t instanceof AST_Definitions)return se(t,n+1);if(t instanceof AST_Do)return e;if(t instanceof AST_Exit)return se(t,n+1);if(t instanceof AST_For)return t.init!==e&&t.condition!==e?e:ae(t,n+1);if(t instanceof AST_ForIn)return t.init!==e?e:ae(t,n+1);if(t instanceof AST_If)return t.condition!==e?e:ae(t,n+1);if(t instanceof AST_ObjectProperty){var i=A.parent(n+1);return all(i.properties,(function(e){return e instanceof AST_ObjectKeyVal}))?ae(i,n+2):i}return t instanceof AST_PropAccess?ae(t,n+1):t instanceof AST_Sequence?(t.tail_node()===e?ae:se)(t,n+1):t instanceof AST_SimpleStatement?se(t,n+1):t instanceof AST_Spread?ae(t,n+1):t instanceof AST_Switch?t.expression!==e?e:ae(t,n+1):t instanceof AST_Unary?"delete"==t.operator?e:ae(t,n+1):t instanceof AST_VarDef?t.name.match_symbol((function(e){return e instanceof AST_SymbolDeclaration&&(E.name==e.name||b.name==e.name)}))?e:ae(t,n+1):t instanceof AST_While?t.condition!==e?e:ae(t,n+1):null}function se(e,n){var t=A.parent(n);if(te(e,t))return e;if(ne(e,t))return e;if(t instanceof AST_Array)return se(t,n+1);if(t instanceof AST_Assign)return s(t.left);if(t instanceof AST_Await)return e;if(t instanceof AST_Binary)return se(t,n+1);if(t instanceof AST_Call)return se(t,n+1);if(t instanceof AST_Case)return se(t,n+1);if(t instanceof AST_Conditional)return se(t,n+1);if(t instanceof AST_Definitions)return se(t,n+1);if(t instanceof AST_Exit)return se(t,n+1);if(t instanceof AST_If)return se(t,n+1);if(t instanceof AST_IterationStatement)return e;if(t instanceof AST_ObjectProperty){var i=A.parent(n+1);return all(i.properties,(function(e){return e instanceof AST_ObjectKeyVal}))?se(i,n+2):i}if(t instanceof AST_PropAccess){var r=t.expression;if(r===e)return se(t,n+1);var o=x(r);if(!(o instanceof AST_SymbolRef))return se(t,n+1);var a=q.get(o.name);return!a||all(a,(function(e){return!(e instanceof AST_PropAccess)}))?se(t,n+1):e}return t instanceof AST_Sequence||t instanceof AST_SimpleStatement?se(t,n+1):t instanceof AST_Spread?e:t instanceof AST_Switch||t instanceof AST_Unary?se(t,n+1):t instanceof AST_VarDef?s(t.name):null;function s(i){if(O(t))return e;if(i!==e&&i instanceof AST_Destructured){var r=K;K=!1;var o=k,a=w;if(i.transform(A),w=a,k=o,K=r,M)return M=!1,e}return se(t,n+1)}}function fe(e){if(u)u=!1;else if(e instanceof AST_SymbolRef){var n=e.definition();if(!n.undeclared&&!r(n))return b=n}}function ce(e){if(!(e instanceof AST_VarDef)){if(e instanceof AST_Assign){var t=e.left;if("="==e.operator&&t instanceof AST_SymbolRef&&(i=t.definition()).references[0]===t&&!n.exposed(i))(o=i.references.length-i.replaced)>1&&fe(e.right);return t}return e.expression}var i;if(!(i=e.name.definition()).const_redefs&&member(e.name,i.orig)){var r=i.orig.length-i.eliminated-(d[i.name]||0),o=i.references.length-i.replaced-(l[i.name]||0);return r>1&&!(e.name instanceof AST_SymbolFunarg)?(fe(e.value),p(AST_SymbolRef,e.name,e.name)):fe(e.value)||1==o&&!n.exposed(i)?p(AST_SymbolRef,e.name,e.name):void 0}}function ue(e){return!(e instanceof AST_Array)&&(e instanceof AST_Binary&&U[e.operator]?ue(e.left)&&ue(e.right):!(e instanceof AST_Call)&&(e instanceof AST_Conditional?ue(e.consequent)&&ue(e.alternative):!(e instanceof AST_Object)&&!e.has_side_effects(n)))}function le(e){if(!(e instanceof AST_Assign&&e.right.single_use)){for(var t,i=Object.create(null),r=new TreeWalker((function(e){e instanceof AST_SymbolRef&&(i[e.definition().id]=!0)}));e instanceof AST_Assign&&"="==e.operator;)e.left.walk(r),e=e.right;if(e instanceof AST_SymbolRef){var o=e.evaluate(n);return o===e?a:_e(o,a)}return e instanceof AST_This?a:e.is_truthy()?_e(!0,return_false):e.is_constant()?_e(e.evaluate(n),a):E instanceof AST_SymbolRef&&(!!ue(e)&&(e.walk(new TreeWalker((function(e){if(t)return!0;e instanceof AST_SymbolRef&&i[e.definition().id]&&(t=!0)}))),!t&&a))}function a(n){return e.equivalent_to(n)}}function _e(e,t){return function(i,r){if(r.in_boolean_context()){if(e&&i.is_truthy()&&!i.has_side_effects(n))return!0;if(i.is_constant())return!i.evaluate(n)==!e}return t(i)}}function Se(e){return e instanceof AST_SymbolRef&&!(e=e.fixed_value())||(e instanceof AST_Assign?"="==e.operator&&Se(e.right):e instanceof AST_PropAccess||e instanceof AST_This)}function pe(e){var i=new Dictionary;e instanceof AST_VarDef&&i.add(e.name.name,E);var r=a.uses_arguments&&!n.has_directive("use strict"),o=a instanceof AST_Toplevel,s=new TreeWalker((function(f){var c;if(f instanceof AST_SymbolRef?c=f.fixed_value()||f:f instanceof AST_This&&(c=f),c&&i.add(f.name,t(n,s,f,c,0)),r&&f instanceof AST_Sub&&(a.each_argname((function(e){n.option("reduce_vars")&&!e.definition().assignments||i.add(e.name,!0)})),r=!1),o)if("Call"==f.TYPE){if(j)return;var u=f.expression;if(u instanceof AST_PropAccess)return;if(u instanceof AST_Function&&!u.contains_this())return;j=!0}else f instanceof AST_PropAccess&&Se(f.expression)&&(f!==E||e instanceof AST_Unary?B=!0:j=!0)}));return e.walk(s),i}function de(t){var i=t.name_index;if(i>=0){var r=a.argnames[i];if(r instanceof AST_DefaultValue)r.value=p(AST_Number,r,{value:0}),r.name.definition().fixed=!1;else{var o=n.parent().args;o[i]&&(o[i]=p(AST_Number,o[i],{value:0}),r.definition().fixed=!1)}return!0}var s=m.length-1;m[s-1].body===m[s]&&s--;var f=new TreeTransformer((function(e,n,t){return H||e!==m[g]?e:++g<=s?Z(e,f):(H=!0,e instanceof AST_VarDef?(e.value=null,d[e.name.name]=(d[e.name.name]||0)+1,b&&b.replaced++,e):t?List.skip:null)}),Te);return M=!1,H=!1,g=0,e[T].transform(f)}function Te(e){if(e instanceof AST_Sequence)switch(e.expressions.length){case 0:return null;case 1:return e.expressions[0]}}function Ae(e){var n=x(e);return n instanceof AST_SymbolRef&&n.definition().scope===a&&!(i&&(q.has(n.name)&&q.get(n.name)[0]!==e||y instanceof AST_Unary||y instanceof AST_Assign&&"="!=y.operator))}function ve(){return!(y instanceof AST_Unary)&&L.has_side_effects(n)}function ge(e){if(e instanceof AST_Unary)return!1;if(R)return!1;if(b)return!0;if(!(E instanceof AST_SymbolRef))return!1;var n;if(e instanceof AST_VarDef)n=1;else{if("="!=e.operator)return!1;n=2}var t=E.definition();return t.references.length-t.replaced==n}function ye(e,n){var t=q.get(e.name);if(t&&!all(t,(function(e){return!e})))return t[0]!==E||void(C=!1)}function be(e){var t=e.definition();return!(1==t.orig.length&&t.orig[0]instanceof AST_SymbolDefun)&&(t.scope!==a||(!(!j||!n.exposed(t))||!all(t.references,(function(e){return e.scope.resolve()===a}))))}function xe(e,n){if(e instanceof AST_Assign)return xe(e.left,!0);if(e instanceof AST_Unary)return xe(e.expression,!0);if(e instanceof AST_VarDef)return e.value&&xe(e.value);if(n){if(e instanceof AST_Dot)return xe(e.expression,!0);if(e instanceof AST_Sub)return xe(e.expression,!0);if(e instanceof AST_SymbolRef)return e.definition().scope!==a}return!1}}function l(e){for(var n=[],t=0;t<e.length;){var i=e[t];if(i instanceof AST_BlockStatement&&all(i.body,(function(e){return!(e instanceof AST_Const||e instanceof AST_Let)})))f=!0,l(i.body),[].splice.apply(e,[t,1].concat(i.body)),t+=i.body.length;else{if(i instanceof AST_Directive){if(member(i.value,n)){f=!0,e.splice(t,1);continue}n.push(i.value)}i instanceof AST_EmptyStatement?(f=!0,e.splice(t,1)):t++}}}function _(e,n){for(var t=n.self(),i=n.parent(),r=y((function(e){return e instanceof AST_Lambda})),o=r&&i&&"Call"==i.TYPE,a=function(e){for(var n=0,t=e.length;--t>=0;){var i=e[t];if(i instanceof AST_If&&i.body instanceof AST_Return&&++n>1)return!0}return!1}(e),s=e.length;--s>=0;){var c=e[s],u=E(s),l=e[u];if(r&&!l&&c instanceof AST_Return){if(!c.value){f=!0,e.splice(s,1);continue}if(c.value instanceof AST_UnaryPrefix&&"void"==c.value.operator){f=!0,e[s]=p(AST_SimpleStatement,c,{body:c.value.expression});continue}}if(c instanceof AST_If){var _=G(c.body);if(k(_)){_.label&&remove(_.label.thedef.references,_),f=!0,(c=c.clone()).condition=c.condition.negate(n);var S=D(c.body,_);c.body=p(AST_BlockStatement,c,{body:m(c.alternative).concat(w())}),c.alternative=p(AST_BlockStatement,c,{body:S}),e[s]=c,e[s]=c.transform(n);continue}if(_&&!c.alternative&&c.body instanceof AST_BlockStatement&&l instanceof AST_Jump){var d=c.condition.negate(n);if(d.print_to_string().length<=c.condition.print_to_string().length){f=!0,(c=c.clone()).condition=d,e[u]=c.body,c.body=l,e[s]=c,e[s]=c.transform(n);continue}}var T=G(c.alternative);if(k(T)){T.label&&remove(T.label.thedef.references,T),f=!0,(c=c.clone()).body=p(AST_BlockStatement,c.body,{body:m(c.body).concat(w())});S=D(c.alternative,T);c.alternative=p(AST_BlockStatement,c.alternative,{body:S}),e[s]=c,e[s]=c.transform(n);continue}n.option("typeofs")&&(_&&!T&&oe(c.condition,null,p(AST_BlockStatement,t,{body:e.slice(s+1)})),!_&&T&&oe(c.condition,p(AST_BlockStatement,t,{body:e.slice(s+1)})))}if(c instanceof AST_If&&c.body instanceof AST_Return){var A=c.body.value,h=c.body.in_bool||l instanceof AST_Return&&l.in_bool;if(!A&&!c.alternative&&(r&&!l||l instanceof AST_Return&&!l.value)){f=!0,e[s]=p(AST_SimpleStatement,c.condition,{body:c.condition});continue}if(!c.alternative&&l instanceof AST_Return){f=!0,(c=c.clone()).alternative=l,e.splice(s,1,c.transform(n)),e.splice(u,1);continue}if(!c.alternative&&!l&&r&&(h||A&&a)){f=!0,(c=c.clone()).alternative=p(AST_Return,c,{value:null}),e.splice(s,1,c.transform(n));continue}var v=e[R(s)];if(n.option("sequences")&&r&&!c.alternative&&(!v&&o||v instanceof AST_If&&v.body instanceof AST_Return)&&E(u)==e.length&&l instanceof AST_SimpleStatement){f=!0,(c=c.clone()).alternative=p(AST_BlockStatement,l,{body:[l,p(AST_Return,l,{value:null})]}),e.splice(s,1,c.transform(n)),e.splice(u,1);continue}}}function g(e,n){var t=e.lastIndexOf(n);if(t<0)return!1;for(;++t<e.length;)if(!P(e[t]))return!1;return!0}function y(e){var i,r=t,o=0;do{do{if(e(r))return!0;r=n.parent(o++)}while(r instanceof AST_If&&(i=r))}while((r instanceof AST_BlockStatement||r instanceof AST_Scope)&&g(r.body,i))}function x(e){return y((function(n){return n===e}))}function k(e){if(e instanceof AST_Return)return r&&function(e){return!e||e instanceof AST_UnaryPrefix&&"void"==e.operator}(e.value);if(!(e instanceof AST_LoopControl))return!1;var t=n.loopcontrol_target(e);return e instanceof AST_Continue?x(b(t)):!(t instanceof AST_IterationStatement)&&x(t)}function w(){var n=e.slice(s+1);return e.length=s+1,n.filter((function(n){return!(n instanceof AST_Defun)||(e.push(n),!1)}))}function D(e,n){for(var t,i=m(e),r=i;(t=r[r.length-1])!==n;)r=t.body;return r.pop(),n.value&&r.push(p(AST_SimpleStatement,n.value,{body:n.value.expression})),i}function E(n){for(var t=n+1;t<e.length&&P(e[t]);t++);return t}function R(n){for(var t=n;--t>=0&&P(e[t]););return t}}function T(e,n){for(var t,i=n.self(),r=0,o=0,a=e.length;r<a;r++){var s=e[r];if(s instanceof AST_LoopControl){var c=n.loopcontrol_target(s);s instanceof AST_Break&&!(c instanceof AST_IterationStatement)&&b(c)===i||s instanceof AST_Continue&&b(c)===i?s.label&&remove(s.label.thedef.references,s):e[o++]=s}else e[o++]=s;if(G(s)){t=e.slice(r+1);break}}e.length=o,f=o!=a,t&&t.forEach((function(t){B(n,t,e)}))}function A(e,n){if(!(e.length<2)){for(var t=[],i=0,r=0,o=e.length;r<o;r++){var a=e[r];if(a instanceof AST_SimpleStatement){t.length>=n.sequences_limit&&c();var s=a.body;t.length>0&&(s=s.drop_side_effect_free(n)),s&&v(t,s)}else P(a)||c(),e[i++]=a}c(),e.length=i,i!=o&&(f=!0)}function c(){if(t.length){var n=d(t[0],t);e[i++]=p(AST_SimpleStatement,n,{body:n}),t=[]}}}function g(e,n){if(!(e instanceof AST_BlockStatement))return e;for(var t=null,i=0;i<e.body.length;i++){var r=e.body[i];if(r instanceof AST_Var&&C(r))n.push(r);else{if(t||r instanceof AST_Const||r instanceof AST_Let)return!1;t=r}}return t}function y(e,n){function t(e){r--,f=!0;var n=i.body;return d(n,[n,e])}for(var i,r=0,o=0;o<e.length;o++){var a=e[o];if(i)if(a instanceof AST_Exit)a.value=t(a.value||p(AST_Undefined,a)).transform(n);else if(a instanceof AST_For){if(!(a.init instanceof AST_Definitions)){var s=!1;i.body.walk(new TreeWalker((function(e){return!!(s||e instanceof AST_Scope)||(e instanceof AST_Binary&&"in"==e.operator?(s=!0,!0):void 0)}))),s||(a.init?a.init=t(a.init):(a.init=i.body,r--,f=!0))}}else a instanceof AST_ForIn?a.object=t(a.object):a instanceof AST_If?a.condition=t(a.condition):(a instanceof AST_Switch||a instanceof AST_With)&&(a.expression=t(a.expression));if(n.option("conditionals")&&a instanceof AST_If){var c=[],u=g(a.body,c),l=g(a.alternative,c);if(!1!==u&&!1!==l&&c.length>0){var _=c.length;c.push(p(AST_If,a,{condition:a.condition,body:u||p(AST_EmptyStatement,a.body),alternative:l})),c.unshift(r,1),[].splice.apply(e,c),o+=_,r+=_+1,i=null,f=!0;continue}}e[r++]=a,i=a instanceof AST_SimpleStatement?a:null}e.length=r}function k(e,n,t){var i;if(n instanceof AST_Assign?i=[n]:n instanceof AST_Sequence&&(i=n.expressions.slice()),i){for(var r=!1,o=i.length-1;--o>=0;){var s=i[o];if(s instanceof AST_Assign&&("="==s.operator&&s.left instanceof AST_SymbolRef)){var f=i.slice(o+1);R(s.left,s.right,f)&&(r=!0,i=i.slice(0,o+1).concat(f))}}if(e instanceof AST_Definitions){t=t||0;for(o=e.definitions.length;--o>=0;){var c=e.definitions[o];if(c.value){R(c.name,c.value,i)&&(r=!0),E(c,i,t)&&(r=!0);break}}e instanceof AST_Var&&function(e,n,t){var i=!1;for(;n.length>t;){var r=n[0];if(!(r instanceof AST_Assign))break;if("="!=r.operator)break;var o=r.left;if(!(o instanceof AST_SymbolRef))break;if(w(o))break;if(o.scope.resolve()!==a)break;var s=o.definition();if(s.scope!==a)break;if(s.orig.length>s.eliminated+1)break;if("SymbolVar"!=s.orig[0].TYPE)break;var f=p(AST_SymbolVar,o,o);e.push(p(AST_VarDef,r,{name:f,value:r.right})),s.orig.push(f),s.replaced++,n.shift(),i=!0}return i}(e.definitions,i,t)&&(r=!0)}return r&&i}}function E(e,t,i){if(n.option("conditionals")&&!(e.name instanceof AST_Destructured)){for(var r=!1,o=e.name.definition();t.length>i;){var a=Se(n,o,e.value,t[0]);if(!a)break;e.value=a,t.shift(),r=!0}return r}}function R(e,t,i){if(t instanceof AST_Object){var r=!1;do{var o=i[0];if(!(o instanceof AST_Assign))break;if("="!=o.operator)break;if(!(o.left instanceof AST_PropAccess))break;var s=o.left.expression;if(!(s instanceof AST_SymbolRef))break;if(e.name!=s.name)break;if(!o.right.is_constant_expression(a))break;var f=o.left.property;if(f instanceof AST_Node&&(f=f.evaluate(n)),f instanceof AST_Node)break;var c="__proto__"==(f=""+f)||n.has_directive("use strict")?function(e){return"string"==typeof e.key&&e.key!=f}:function(e){return!(e instanceof AST_ObjectGetter||e instanceof AST_ObjectSetter)||"string"==typeof e.key&&e.key!=f};if(!all(t.properties,c))break;t.properties.push(p(AST_ObjectKeyVal,o,{key:f,value:o.right})),i.shift(),r=!0}while(i.length);return r}}function N(e){for(var n,t=0,i=-1;t<e.length;t++){var r=e[t],o=e[i];if(r instanceof AST_Definitions)o&&o.TYPE==r.TYPE?(o.definitions=o.definitions.concat(r.definitions),f=!0):n&&n.TYPE==r.TYPE&&C(r)?(n.definitions=n.definitions.concat(r.definitions),f=!0):(e[++i]=r,r instanceof AST_Var&&(n=r));else{if(r instanceof AST_Exit)r.value=c(r.value);else if(r instanceof AST_For){if(s=k(o,r.init))f=!0,r.init=s.length?d(r.init,s):null;else{if(o instanceof AST_Var&&(!r.init||r.init.TYPE==o.TYPE)){r.init&&(o.definitions=o.definitions.concat(r.init.definitions)),n=r.init=o,e[i]=u(r),f=!0;continue}n&&r.init&&n.TYPE==r.init.TYPE&&C(r.init)?(n.definitions=n.definitions.concat(r.init.definitions),r.init=null,f=!0):r.init instanceof AST_Var&&(n=r.init)}}else if(r instanceof AST_ForIn){if(n&&n.TYPE==r.init.TYPE){var a=n.definitions.slice();r.init=r.init.definitions[0].name.convert_symbol(AST_SymbolRef,(function(e,n){a.push(p(AST_VarDef,n,{name:n,value:null})),n.definition().references.push(e)})),n.definitions=a,f=!0}r.object=c(r.object)}else if(r instanceof AST_If)r.condition=c(r.condition);else if(r instanceof AST_SimpleStatement){var s;if(s=k(o,r.body)){if(f=!0,!s.length)continue;r.body=d(r.body,s)}}else(r instanceof AST_Switch||r instanceof AST_With)&&(r.expression=c(r.expression));e[++i]=n?u(r):r}}function c(e){var n=k(o,e,1);if(!n)return e;f=!0;var t=e.tail_node();return n[n.length-1]!==t&&n.push(t.left),d(e,n)}function u(e){return e.transform(new TreeTransformer((function(e,t,i){if(e instanceof AST_Definitions){if(n===e)return e;if(n.TYPE!=e.TYPE)return e;var r=this.parent();return r instanceof AST_ForIn&&r.init===e?e:C(e)?(n.definitions=n.definitions.concat(e.definitions),f=!0,r instanceof AST_For&&r.init===e?null:i?List.skip:p(AST_EmptyStatement,e)):e}return e instanceof AST_Scope?e:e instanceof AST_Statement?void 0:e})))}e.length=i+1}}function B(e,n,t){var i;function r(e){i?(i.push(e),(e instanceof AST_Const||e instanceof AST_Let)&&(i.required=!0)):t.push(e)}n instanceof AST_Definitions||is_defun(n)||AST_Node.warn("Dropping unreachable code [{file}:{line},{col}]",n.start),n.walk(new TreeWalker((function(o,a){if(o instanceof AST_Definitions){var s=[];return o.remove_initializers(e,s)&&AST_Node.warn("Dropping initialization in unreachable code [{file}:{line},{col}]",o.start),s.length>0&&(o.definitions=s,r(o)),!0}if(is_defun(o))return r(o),!0;if(o instanceof AST_Scope)return!0;if(o instanceof AST_BlockScope){var f=i;return i=[],a(),i.required?t.push(p(AST_BlockStatement,n,{body:i})):i.length&&[].push.apply(t,i),i=f,!0}})))}function F(e,n){return e.is_undefined||e instanceof AST_Undefined||e instanceof AST_UnaryPrefix&&"void"==e.operator&&!(n&&e.expression.has_side_effects(n))}(R=function(e,n){e.DEFMETHOD("is_truthy",n)})(AST_Node,return_false),R(AST_Array,return_true),R(AST_Assign,(function(){return"="==this.operator&&this.right.is_truthy()})),R(AST_Lambda,return_true),R(AST_Object,return_true),R(AST_RegExp,return_true),R(AST_Sequence,(function(){return this.tail_node().is_truthy()})),R(AST_SymbolRef,(function(){var e=this.fixed_value();if(!e)return!1;this.is_truthy=return_false;var n=e.is_truthy();return delete this.is_truthy,n})),function(e){function n(e,n,t){switch(e){case"-":return n.is_negative_zero()&&(!(t instanceof AST_Constant)||0==t.value);case"&&":case"||":return n.is_negative_zero()||t.is_negative_zero();case"*":case"/":case"%":return!0;default:return!1}}e(AST_Node,return_true),e(AST_Array,return_false),e(AST_Assign,(function(){var e=this.operator;return"="==e?this.right.is_negative_zero():n(e.slice(0,-1),this.left,this.right)})),e(AST_Binary,(function(){return n(this.operator,this.left,this.right)})),e(AST_Constant,(function(){return 0==this.value&&1/this.value<0})),e(AST_Lambda,return_false),e(AST_Object,return_false),e(AST_RegExp,return_false),e(AST_Sequence,(function(){return this.tail_node().is_negative_zero()})),e(AST_SymbolRef,(function(){var e=this.fixed_value();if(!e)return!0;this.is_negative_zero=return_true;var n=e.is_negative_zero();return delete this.is_negative_zero,n})),e(AST_UnaryPrefix,(function(){return"+"==this.operator&&this.expression.is_negative_zero()||"-"==this.operator}))}((function(e,n){e.DEFMETHOD("is_negative_zero",n)})),function(e){function n(e){return/strict/.test(e.option("pure_getters"))}AST_Node.DEFMETHOD("may_throw_on_access",(function(e){return!e.option("pure_getters")||this._dot_throw(e)})),e(AST_Node,n),e(AST_Array,return_false),e(AST_Assign,(function(e){if("="!=this.operator)return!1;var n=this.right;if(!n._dot_throw(e))return!1;var t=this.left;return!(t instanceof AST_SymbolRef)||(!(n instanceof AST_Binary&&"||"==n.operator&&t.name==n.left.name)||n.right._dot_throw(e))})),e(AST_Binary,(function(e){switch(this.operator){case"&&":return this.left._dot_throw(e)||this.right._dot_throw(e);case"||":return this.right._dot_throw(e);default:return!1}})),e(AST_Conditional,(function(e){return this.consequent._dot_throw(e)||this.alternative._dot_throw(e)})),e(AST_Constant,return_false),e(AST_Dot,(function(e){if(!n(e))return!1;var t=this.expression;return t instanceof AST_SymbolRef&&(t=t.fixed_value()),!(t instanceof AST_Lambda&&"prototype"==this.property)})),e(AST_Lambda,return_false),e(AST_Null,return_true),e(AST_Object,(function(e){return n(e)&&!all(this.properties,(function(e){return e instanceof AST_ObjectKeyVal}))})),e(AST_Sequence,(function(e){return this.tail_node()._dot_throw(e)})),e(AST_SymbolRef,(function(e){if(this.is_undefined)return!0;if(!n(e))return!1;if(w(this)&&this.is_declared(e))return!1;if(this.is_immutable())return!1;var t=this.definition();if(r(t)&&all(t.scope.argnames,(function(e){return e instanceof AST_SymbolFunarg})))return t.scope.uses_arguments>2;var i=this.fixed_value();return!i||(this._dot_throw=return_true,i._dot_throw(e)?(delete this._dot_throw,!0):(this._dot_throw=return_false,!1))})),e(AST_This,(function(e){return n(e)&&!this.scope.new})),e(AST_UnaryPrefix,(function(){return"void"==this.operator})),e(AST_UnaryPostfix,return_false),e(AST_Undefined,return_true)}((function(e,n){e.DEFMETHOD("_dot_throw",n)})),function(e){e(AST_Node,return_false),e(AST_Array,return_true),e(AST_Assign,(function(e){return"="!=this.operator||this.right.is_defined(e)})),e(AST_Binary,(function(e){switch(this.operator){case"&&":return this.left.is_defined(e)&&this.right.is_defined(e);case"||":return this.left.is_truthy()||this.right.is_defined(e);default:return!0}})),e(AST_Conditional,(function(e){return this.consequent.is_defined(e)&&this.alternative.is_defined(e)})),e(AST_Constant,return_true),e(AST_Hole,return_false),e(AST_Lambda,return_true),e(AST_Object,return_true),e(AST_Sequence,(function(e){return this.tail_node().is_defined(e)})),e(AST_SymbolRef,(function(e){if(this.is_undefined)return!1;if(w(this)&&this.is_declared(e))return!0;if(this.is_immutable())return!0;var n=this.fixed_value();if(!n)return!1;this.is_defined=return_false;var t=n.is_defined(e);return delete this.is_defined,t})),e(AST_UnaryPrefix,(function(){return"void"!=this.operator})),e(AST_UnaryPostfix,return_true),e(AST_Undefined,return_false)}((function(e,n){e.DEFMETHOD("is_defined",n)})),function(e){e(AST_Node,return_false),e(AST_Assign,(function(e){return"="==this.operator&&this.right.is_boolean(e)}));var n=makePredicate("in instanceof == != === !== < <= >= >");e(AST_Binary,(function(e){return n[this.operator]||U[this.operator]&&this.left.is_boolean(e)&&this.right.is_boolean(e)})),e(AST_Boolean,return_true);var t=makePredicate("every hasOwnProperty isPrototypeOf propertyIsEnumerable some");e(AST_Call,(function(e){if(!e.option("unsafe"))return!1;var n=this.expression;return n instanceof AST_Dot&&(t[n.property]||"test"==n.property&&n.expression instanceof AST_RegExp)})),e(AST_Conditional,(function(e){return this.consequent.is_boolean(e)&&this.alternative.is_boolean(e)})),e(AST_New,return_false),e(AST_Sequence,(function(e){return this.tail_node().is_boolean(e)})),e(AST_SymbolRef,(function(e){var n=this.fixed_value();if(!n)return!1;this.is_boolean=return_false;var t=n.is_boolean(e);return delete this.is_boolean,t}));var i=makePredicate("! delete");e(AST_UnaryPrefix,(function(){return i[this.operator]}))}((function(e,n){e.DEFMETHOD("is_boolean",n)})),function(e){e(AST_Node,return_false);var n=makePredicate("- * / % & | ^ << >> >>>");e(AST_Assign,(function(e){return n[this.operator.slice(0,-1)]||"="==this.operator&&this.right.is_number(e)})),e(AST_Binary,(function(e){return!!n[this.operator]||"+"==this.operator&&((this.left.is_boolean(e)||this.left.is_number(e))&&(this.right.is_boolean(e)||this.right.is_number(e)))}));var t=makePredicate(["charCodeAt","getDate","getDay","getFullYear","getHours","getMilliseconds","getMinutes","getMonth","getSeconds","getTime","getTimezoneOffset","getUTCDate","getUTCDay","getUTCFullYear","getUTCHours","getUTCMilliseconds","getUTCMinutes","getUTCMonth","getUTCSeconds","getYear","indexOf","lastIndexOf","localeCompare","push","search","setDate","setFullYear","setHours","setMilliseconds","setMinutes","setMonth","setSeconds","setTime","setUTCDate","setUTCFullYear","setUTCHours","setUTCMilliseconds","setUTCMinutes","setUTCMonth","setUTCSeconds","setYear","toExponential","toFixed","toPrecision"]);e(AST_Call,(function(e){if(!e.option("unsafe"))return!1;var n=this.expression;return n instanceof AST_Dot&&(t[n.property]||w(n.expression)&&"Math"==n.expression.name)})),e(AST_Conditional,(function(e){return this.consequent.is_number(e)&&this.alternative.is_number(e)})),e(AST_New,return_false),e(AST_Number,return_true),e(AST_Sequence,(function(e){return this.tail_node().is_number(e)})),e(AST_SymbolRef,(function(e){var n=this.fixed_value();if(!n)return!1;this.is_number=return_false;var t=n.is_number(e);return delete this.is_number,t}));var i=makePredicate("+ - ~ ++ --");e(AST_Unary,(function(){return i[this.operator]}))}((function(e,n){e.DEFMETHOD("is_number",n)})),function(e){e(AST_Node,return_false),e(AST_Assign,(function(e){switch(this.operator){case"+=":if(this.left.is_string(e))return!0;case"=":return this.right.is_string(e)}})),e(AST_Binary,(function(e){return"+"==this.operator&&(this.left.is_string(e)||this.right.is_string(e))}));var n=makePredicate(["charAt","substr","substring","toLowerCase","toString","toUpperCase","trim"]);e(AST_Call,(function(e){if(!e.option("unsafe"))return!1;var t=this.expression;return t instanceof AST_Dot&&n[t.property]})),e(AST_Conditional,(function(e){return this.consequent.is_string(e)&&this.alternative.is_string(e)})),e(AST_Sequence,(function(e){return this.tail_node().is_string(e)})),e(AST_String,return_true),e(AST_SymbolRef,(function(e){var n=this.fixed_value();if(!n)return!1;this.is_string=return_false;var t=n.is_string(e);return delete this.is_string,t})),e(AST_UnaryPrefix,(function(){return"typeof"==this.operator}))}((function(e,n){e.DEFMETHOD("is_string",n)}));var U=makePredicate("&& ||");function z(e,n){return n instanceof AST_Assign?n.left===e&&e:n instanceof AST_DefaultValue?n.name===e&&e:n instanceof AST_Destructured||n instanceof AST_DestructuredKeyVal?e:n instanceof AST_Unary?unary_side_effects[n.operator]&&n.expression:void 0}function j(e,n,t){return n.print_to_string().length-e.print_to_string().length<(t||0)?n:e}function q(e,n,t){return j(p(AST_SimpleStatement,e,{body:e}),p(AST_SimpleStatement,n,{body:n}),t).body}function V(e,n,t,i){return(first_in_statement(e)?q:j)(n,t,i)}function L(e){var n=Object.create(null);return Object.keys(e).forEach((function(t){n[t]=makePredicate(e[t])})),n}function I(e){for(var n=0;n<e.length;n++){var t=e[n];if(!(t instanceof AST_Directive))return t}}function H(e,n){var t=n.evaluate(e);return t===n?n:V(e,n,t=T(t,n).optimize(e),e.eval_threshold)}!function(e){function n(e,t){if(e instanceof AST_Node)return e.clone(!0);if(Array.isArray(e))return p(AST_Array,t,{elements:e.map((function(e){return n(e,t)}))});if(e&&"object"==typeof e){var i=[];for(var r in e)HOP(e,r)&&i.push(p(AST_ObjectKeyVal,t,{key:r,value:n(e[r],t)}));return p(AST_Object,t,{properties:i})}return T(e,t)}function t(e){AST_Node.warn("global_defs {node} redefined [{file}:{line},{col}]",{node:e,file:e.start.file,line:e.start.line,col:e.start.col})}AST_Toplevel.DEFMETHOD("resolve_defines",(function(e){return e.option("global_defs")?(this.figure_out_scope({ie8:e.option("ie8")}),this.transform(new TreeTransformer((function(n){var i=n._find_defs(e,"");if(i){for(var r,o=0,a=n;(r=this.parent(o++))&&r instanceof AST_PropAccess&&r.expression===a;)a=r;if(!z(a,r))return i;t(n)}})))):this})),e(AST_Node,noop),e(AST_Dot,(function(e,n){return this.expression._find_defs(e,"."+this.property+n)})),e(AST_SymbolDeclaration,(function(e){this.definition().global&&HOP(e.option("global_defs"),this.name)&&t(this)})),e(AST_SymbolRef,(function(e,t){if(this.definition().global){var i=e.option("global_defs"),r=this.name+t;return HOP(i,r)?n(i[r],this):void 0}}))}((function(e,n){e.DEFMETHOD("_find_defs",n)})),AST_Arrow.DEFMETHOD("first_statement",(function(){return this.value?p(AST_Return,this.value,{value:this.value}):I(this.body)})),AST_Lambda.DEFMETHOD("first_statement",(function(){return I(this.body)}));var M=["constructor","toString","valueOf"],Y=L({Array:["indexOf","join","lastIndexOf","slice"].concat(M),Boolean:M,Function:M,Number:["toExponential","toFixed","toPrecision"].concat(M),Object:M,RegExp:["exec","test"].concat(M),String:["charAt","charCodeAt","concat","indexOf","italics","lastIndexOf","match","replace","search","slice","split","substr","substring","toLowerCase","toUpperCase","trim"].concat(M)}),W=L({Array:["isArray"],Math:["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","atan2","pow","max","min"],Number:["isFinite","isNaN"],Object:["create","getOwnPropertyDescriptor","getOwnPropertyNames","getPrototypeOf","isExtensible","isFrozen","isSealed","keys"],String:["fromCharCode"]});!function(e){e(AST_Node,return_false),e(AST_Constant,return_true),e(AST_RegExp,return_false);var n=makePredicate("! ~ - + void");e(AST_UnaryPrefix,(function(){return n[this.operator]&&this.expression instanceof AST_Constant}))}((function(e,n){e.DEFMETHOD("is_constant",n)})),function(e){AST_Node.DEFMETHOD("evaluate",(function(e,n){if(!e.option("evaluate"))return this;var t=[],i=this._eval(e,n,t,1);return t.forEach((function(e){delete e._eval})),n||!i||i instanceof RegExp?i:"function"==typeof i||"object"==typeof i?this:i}));var n=new TreeWalker((function(e){e instanceof AST_Assign&&t(e.left),e instanceof AST_Unary&&UNARY_POSTFIX[e.operator]&&t(e.expression)}));function t(e){e instanceof AST_PropAccess?t(e.expression):e instanceof AST_SymbolRef&&e.definition().references.forEach((function(e){delete e._eval}))}e(AST_Statement,(function(){throw new Error(string_template("Cannot evaluate a statement [{file}:{line},{col}]",this.start))})),e(AST_Accessor,return_this),e(AST_Node,return_this),e(AST_Constant,(function(){return this.value})),e(AST_Assign,(function(e,i,r,o){var a=this.left;if(!i){if(!(a instanceof AST_SymbolRef))return this;if(!HOP(a,"_eval")){if(!a.fixed)return this;var s=a.definition();if(!s.fixed)return this;if(s.undeclared)return this;if(s.last_ref!==a)return this;if("m"==s.single_use)return this}}var f,c=this.operator;!HOP(a,"_eval")&&a instanceof AST_SymbolRef&&a.fixed&&a.definition().fixed?f=a:"="==c?(a.walk(n),f=this.right):f=p(AST_Binary,this,{operator:c.slice(0,-1),left:a,right:this.right});var u=f._eval(e,i,r,o);return"object"==typeof u?this:(t(a),u)})),e(AST_Sequence,(function(e,t,i,r){if(!t)return this;for(var o=this.expressions,a=0,s=o.length-1;a<s;a++)o[a].walk(n);var f=o[s],c=f._eval(e,t,i,r);return c===f?this:c})),e(AST_Lambda,(function(e){if(e.option("unsafe")){var n=function(){};return n.node=this,n.toString=function(){return"function(){}"},n}return this})),e(AST_Array,(function(e,n,t,i){if(e.option("unsafe")){for(var r=[],o=0;o<this.elements.length;o++){var a=this.elements[o];if(a instanceof AST_Hole)return this;var s=a._eval(e,n,t,i);if(a===s)return this;r.push(s)}return r}return this})),e(AST_Object,(function(e,n,t,i){if(e.option("unsafe")){for(var r={},o=0;o<this.properties.length;o++){var a=this.properties[o];if(!(a instanceof AST_ObjectKeyVal))return this;var s=a.key;if(s instanceof AST_Node&&(s=s._eval(e,n,t,i))===a.key)return this;if(a.value instanceof AST_Function&&"function"==typeof Object.prototype[s])return this;if(r[s]=a.value._eval(e,n,t,i),r[s]===a.value)return this}return r}return this}));var i=makePredicate("! typeof void");e(AST_UnaryPrefix,(function(e,n,r,o){var a=this.expression,s=this.operator;if(e.option("typeofs")&&"typeof"==s&&(a instanceof AST_Lambda||a instanceof AST_SymbolRef&&a.fixed_value()instanceof AST_Lambda))return"function";var f=a instanceof AST_SymbolRef&&a.definition();i[s]||f&&f.fixed||o++;var c=a._eval(e,n,r,o);if(c===a){if(n&&"void"==s)return;return this}switch(s){case"!":return!c;case"typeof":return c instanceof RegExp?this:typeof c;case"void":return;case"~":return~c;case"-":return-c;case"+":return+c;case"++":case"--":if(!f)return this;if(!n){if(f.undeclared)return this;if(f.last_ref!==a)return this}return HOP(a,"_eval")&&(c=+(s[0]+1)+ +c),t(a),c}return this})),e(AST_UnaryPostfix,(function(e,n,i,r){var o=this.expression;if(o instanceof AST_SymbolRef){if(!HOP(o,"_eval")){if(!o.fixed)return this;if(!n){var a=o.definition();if(!a.fixed)return this;if(a.undeclared)return this;if(a.last_ref!==o)return this}}}else if(!n)return this;o instanceof AST_SymbolRef&&o.definition().fixed||r++;var s=o._eval(e,n,i,r);return s===o?this:(t(o),+s)}));var r=makePredicate("&& || === !==");e(AST_Binary,(function(e,n,t,i){r[this.operator]||i++;var o=this.left._eval(e,n,t,i);if(o===this.left)return this;if(this.operator==(o?"||":"&&"))return o;var a,s=n&&!(o&&"object"==typeof o),f=this.right._eval(e,s,t,i);if(f===this.right)return this;switch(this.operator){case"&&":a=o&&f;break;case"||":a=o||f;break;case"|":a=o|f;break;case"&":a=o&f;break;case"^":a=o^f;break;case"+":a=o+f;break;case"-":a=o-f;break;case"*":a=o*f;break;case"/":a=o/f;break;case"%":a=o%f;break;case"<<":a=o<<f;break;case">>":a=o>>f;break;case">>>":a=o>>>f;break;case"==":a=o==f;break;case"===":a=o===f;break;case"!=":a=o!=f;break;case"!==":a=o!==f;break;case"<":a=o<f;break;case"<=":a=o<=f;break;case">":a=o>f;break;case">=":a=o>=f;break;case"in":if(f&&"object"==typeof f&&HOP(f,o)){a=!0;break}default:return this}if(isNaN(a))return e.find_parent(AST_With)?this:a;if(e.option("unsafe_math")&&!n&&a&&"number"==typeof a&&("+"==this.operator||"-"==this.operator)){var c=Math.max(0,u(o),u(f));if(c<16)return+a.toFixed(c)}return a;function u(e){var n=/(\.[0-9]*)?(e.+)?$/.exec(+e);return(n[1]||".").length-1-(n[2]||"").slice(1)}})),e(AST_Conditional,(function(e,n,t,i){var r=this.condition._eval(e,n,t,i);if(r===this.condition)return this;var o=r?this.consequent:this.alternative,a=o._eval(e,n,t,i);return a===o?this:a})),e(AST_SymbolRef,(function(e,n,t,i){var r,o=this.fixed_value();if(!o)return this;if(HOP(o,"_eval"))r=o._eval();else{if(this._eval=return_this,r=o._eval(e,n,t,i),delete this._eval,r===o)return this;o._eval=function(){return r},t.push(o)}return r&&"object"==typeof r&&!function(e,n){var t=e.definition().escaped;switch(t.length){case 0:return!0;case 1:var i=!1;return t[0].walk(new TreeWalker((function(n){return!!i||(n===e?i=!0:n instanceof AST_Scope||void 0)}))),i;default:return n<=t.depth}}(this,i)?this:r}));var o={Array:Array,Math:Math,Number:Number,Object:Object,String:String},a=L({Math:["E","LN10","LN2","LOG2E","LOG10E","PI","SQRT1_2","SQRT2"],Number:["MAX_VALUE","MIN_VALUE","NaN","NEGATIVE_INFINITY","POSITIVE_INFINITY"]}),s=makePredicate("global ignoreCase multiline source");e(AST_PropAccess,(function(e,n,t,i){if(e.option("unsafe")){var r,f=this.expression;if(!w(f)&&(null==(r=f._eval(e,n,t,i+1))||r===f))return this;var c=this.property;if(c instanceof AST_Node&&(c=c._eval(e,n,t,i))===this.property)return this;if(void 0===r){var u=a[f.name];if(!u||!u[c])return this;r=o[f.name]}else if(r instanceof RegExp){if(!s[c])return this}else if("object"==typeof r){if(!HOP(r,c))return this}else if("function"==typeof r)switch(c){case"name":return r.node.name?r.node.name.name:"";case"length":return r.node.argnames.length;default:return this}return r[c]}return this})),e(AST_Call,(function(e,n,t,i){var r=this.expression,a=r instanceof AST_SymbolRef?r.fixed_value():r;if(a instanceof AST_Defun||a instanceof AST_Function){if(a.evaluating)return this;if(a.name&&a.name.definition().recursive_refs>0)return this;if(this.is_expr_pure(e))return this;var s=T(this.args);if(!all(a.argnames,(function(r,o){if(r instanceof AST_DefaultValue){if(!s)return!1;if(void 0!==s[o])return!1;var a=r.value._eval(e,n,t,i);if(a===r.value)return!1;s[o]=a,r=r.name}return!(r instanceof AST_Destructured)})))return this;if(!s&&!n)return this;var f=a.first_statement();if(!(f instanceof AST_Return)){if(n){var c=!1;if(a.walk(new TreeWalker((function(n){return!!c||(n instanceof AST_Return?(n.value&&void 0!==n.value._eval(e,!0,t,i)&&(c=!0),!0):n instanceof AST_Scope&&n!==a||void 0)}))),!c)return}return this}if(!(l=f.value))return;var u=[];return(!s||all(a.argnames,(function(e,n){e instanceof AST_DefaultValue&&(e=e.name);var t=e.definition();if(t.orig[t.orig.length-1]!==e)return!1;var i=s[n];return t.references.forEach((function(e){e._eval=function(){return i},u.push(e)})),!0}))||n)&&(a.evaluating=!0,l=l._eval(e,n,t,i),delete a.evaluating),u.forEach((function(e){delete e._eval})),l===f.value?this:l}if(e.option("unsafe")&&r instanceof AST_PropAccess){var l,_=r.property;if(_ instanceof AST_Node&&(_=_._eval(e,n,t,i))===r.property)return this;var S=r.expression;if(w(S)){var p=W[S.name];if(!p||!p[_])return this;l=o[S.name]}else{if(null==(l=S._eval(e,n,t,i+1))||l===S)return this;var d=Y[l.constructor.name];if(!d||!d[_])return this;if(l instanceof RegExp&&l.global&&!(S instanceof AST_RegExp))return this}if(!(s=T(this.args)))return this;if("replace"==_&&"function"==typeof s[1])return this;try{return l[_].apply(l,s)}catch(A){AST_Node.warn("Error evaluating {code} [{file}:{line},{col}]",{code:this,file:this.start.file,line:this.start.line,col:this.start.col})}finally{l instanceof RegExp&&(l.lastIndex=0)}}return this;function T(r){for(var o=[],a=0;a<r.length;a++){var s=r[a],f=s._eval(e,n,t,i);if(s===f)return;o.push(f)}return o}})),e(AST_New,return_this)}((function(e,n){e.DEFMETHOD("_eval",n)})),function(e){function n(e){return p(AST_UnaryPrefix,e,{operator:"!",expression:e})}function t(e,t,i){var r=n(e);if(i){var o=p(AST_SimpleStatement,t,{body:t});return j(r,o)===o?t:r}return j(r,t)}e(AST_Node,(function(){return n(this)})),e(AST_Statement,(function(){throw new Error("Cannot negate a statement")})),e(AST_Arrow,(function(){return n(this)})),e(AST_AsyncFunction,(function(){return n(this)})),e(AST_Function,(function(){return n(this)})),e(AST_UnaryPrefix,(function(){return"!"==this.operator?this.expression:n(this)})),e(AST_Sequence,(function(e){var n=this.expressions.slice();return n.push(n.pop().negate(e)),d(this,n)})),e(AST_Conditional,(function(e,n){var i=this.clone();return i.consequent=i.consequent.negate(e),i.alternative=i.alternative.negate(e),t(this,i,n)})),e(AST_Binary,(function(e,i){var r=this.clone(),o=this.operator;if(e.option("unsafe_comps"))switch(o){case"<=":return r.operator=">",r;case"<":return r.operator=">=",r;case">=":return r.operator="<",r;case">":return r.operator="<=",r}switch(o){case"==":return r.operator="!=",r;case"!=":return r.operator="==",r;case"===":return r.operator="!==",r;case"!==":return r.operator="===",r;case"&&":return r.operator="||",r.left=r.left.negate(e,i),r.right=r.right.negate(e),t(this,r,i);case"||":return r.operator="&&",r.left=r.left.negate(e,i),r.right=r.right.negate(e),t(this,r,i)}return n(this)}))}((function(e,n){e.DEFMETHOD("negate",(function(e,t){return n.call(this,e,t)}))}));var K=makePredicate("Boolean decodeURI decodeURIComponent Date encodeURI encodeURIComponent Error escape EvalError isFinite isNaN Number Object parseFloat parseInt RangeError ReferenceError String SyntaxError TypeError unescape URIError");function $(e){for(;(e=e.tail_node())instanceof AST_SymbolRef;)if(!(e=e.fixed_value()))return!0;return!(e instanceof AST_Array||"Binary"==e.TYPE&&!U[e.operator]||e instanceof AST_Constant||e instanceof AST_Lambda||e instanceof AST_Object&&all(e.properties,(function(e){return!(e instanceof AST_ObjectGetter||e instanceof AST_Spread)}))||e instanceof AST_This||e instanceof AST_Unary)}function G(e){return e&&e.aborts()}AST_Call.DEFMETHOD("is_expr_pure",(function(e){if(e.option("unsafe")){var n=this.expression;if(w(n)&&K[n.name])return!0;if(n instanceof AST_Dot&&w(n.expression)){var t=W[n.expression.name];return t&&(t[n.property]||"Math"==n.expression.name&&"random"==n.property)}}return this.pure||!e.pure_funcs(this)})),AST_Node.DEFMETHOD("is_call_pure",return_false),AST_Call.DEFMETHOD("is_call_pure",(function(e){if(!e.option("unsafe"))return!1;var n=this.expression;if(!(n instanceof AST_Dot))return!1;var t,i=n.expression,r=n.property;if(i instanceof AST_Array)t=Y.Array;else if(i.is_boolean(e))t=Y.Boolean;else if(i.is_number(e))t=Y.Number;else if(i instanceof AST_RegExp)t=Y.RegExp;else if(i.is_string(e)){if(t=Y.String,"replace"==r){var o=this.args[1];if(o&&!o.is_string(e))return!1}}else n.may_throw_on_access(e)||(t=Y.Object);return t&&t[r]})),function(e){function n(e,n,t){return!all(e,t?function(e){return e instanceof AST_Spread?!t(e,n):!e.has_side_effects(n)}:function(e){return!e.has_side_effects(n)})}function t(e,n){return!e.expression.is_string(n)||e.expression.has_side_effects(n)}e(AST_Node,return_true),e(AST_Array,(function(e){return n(this.elements,e,t)})),e(AST_Assign,(function(e){var n=this.left;if(!(n instanceof AST_PropAccess))return!0;var t=n.expression;return!(t instanceof AST_This)||!t.scope.new||n instanceof AST_Sub&&n.property.has_side_effects(e)||this.right.has_side_effects(e)})),e(AST_Binary,(function(e){return this.left.has_side_effects(e)||this.right.has_side_effects(e)||"in"==this.operator&&!he(this.right)})),e(AST_Block,(function(e){return n(this.body,e)})),e(AST_Call,(function(e){return!(this.is_expr_pure(e)||this.is_call_pure(e)&&!this.expression.has_side_effects(e))||n(this.args,e,t)})),e(AST_Case,(function(e){return this.expression.has_side_effects(e)||n(this.body,e)})),e(AST_Conditional,(function(e){return this.condition.has_side_effects(e)||this.consequent.has_side_effects(e)||this.alternative.has_side_effects(e)})),e(AST_Constant,return_false),e(AST_Definitions,(function(e){return n(this.definitions,e)})),e(AST_DestructuredArray,(function(e){return n(this.elements,e)})),e(AST_DestructuredKeyVal,(function(e){return this.key instanceof AST_Node&&this.key.has_side_effects(e)||this.value.has_side_effects(e)})),e(AST_DestructuredObject,(function(e){return n(this.properties,e)})),e(AST_Dot,(function(e){return this.expression.may_throw_on_access(e)||this.expression.has_side_effects(e)})),e(AST_EmptyStatement,return_false),e(AST_If,(function(e){return this.condition.has_side_effects(e)||this.body&&this.body.has_side_effects(e)||this.alternative&&this.alternative.has_side_effects(e)})),e(AST_LabeledStatement,(function(e){return this.body.has_side_effects(e)})),e(AST_Lambda,return_false),e(AST_Object,(function(e){return n(this.properties,e,(function(e,n){var t=e.expression;return $(t)||t.has_side_effects(n)}))})),e(AST_ObjectProperty,(function(e){return this.key instanceof AST_Node&&this.key.has_side_effects(e)||this.value.has_side_effects(e)})),e(AST_Sequence,(function(e){return n(this.expressions,e)})),e(AST_SimpleStatement,(function(e){return this.body.has_side_effects(e)})),e(AST_Sub,(function(e){return this.expression.may_throw_on_access(e)||this.expression.has_side_effects(e)||this.property.has_side_effects(e)})),e(AST_Switch,(function(e){return this.expression.has_side_effects(e)||n(this.body,e)})),e(AST_SymbolDeclaration,return_false),e(AST_SymbolRef,(function(e){return!this.is_declared(e)||!s(this)})),e(AST_This,return_false),e(AST_Try,(function(e){return n(this.body,e)||this.bcatch&&this.bcatch.has_side_effects(e)||this.bfinally&&this.bfinally.has_side_effects(e)})),e(AST_Unary,(function(e){return unary_side_effects[this.operator]||this.expression.has_side_effects(e)})),e(AST_VarDef,(function(e){return this.value}))}((function(e,n){e.DEFMETHOD("has_side_effects",n)})),function(e){function n(e,n){for(var t=e.length;--t>=0;)if(e[t].may_throw(n))return!0;return!1}e(AST_Node,return_true),e(AST_Constant,return_false),e(AST_EmptyStatement,return_false),e(AST_Lambda,return_false),e(AST_SymbolDeclaration,return_false),e(AST_This,return_false),e(AST_Array,(function(e){return n(this.elements,e)})),e(AST_Assign,(function(e){return!!this.right.may_throw(e)||!(!e.has_directive("use strict")&&"="==this.operator&&this.left instanceof AST_SymbolRef)&&this.left.may_throw(e)})),e(AST_Binary,(function(e){return this.left.may_throw(e)||this.right.may_throw(e)||"in"==this.operator&&!he(this.right)})),e(AST_Block,(function(e){return n(this.body,e)})),e(AST_Call,(function(e){return!!n(this.args,e)||!this.is_expr_pure(e)&&(!!this.expression.may_throw(e)||(!(this.expression instanceof AST_Lambda)||n(this.expression.body,e)))})),e(AST_Case,(function(e){return this.expression.may_throw(e)||n(this.body,e)})),e(AST_Conditional,(function(e){return this.condition.may_throw(e)||this.consequent.may_throw(e)||this.alternative.may_throw(e)})),e(AST_Definitions,(function(e){return n(this.definitions,e)})),e(AST_Dot,(function(e){return this.expression.may_throw_on_access(e)||this.expression.may_throw(e)})),e(AST_If,(function(e){return this.condition.may_throw(e)||this.body&&this.body.may_throw(e)||this.alternative&&this.alternative.may_throw(e)})),e(AST_LabeledStatement,(function(e){return this.body.may_throw(e)})),e(AST_Object,(function(e){return n(this.properties,e)})),e(AST_ObjectProperty,(function(e){return this.key instanceof AST_Node&&this.key.may_throw(e)||this.value.may_throw(e)})),e(AST_Return,(function(e){return this.value&&this.value.may_throw(e)})),e(AST_Sequence,(function(e){return n(this.expressions,e)})),e(AST_SimpleStatement,(function(e){return this.body.may_throw(e)})),e(AST_Sub,(function(e){return this.expression.may_throw_on_access(e)||this.expression.may_throw(e)||this.property.may_throw(e)})),e(AST_Switch,(function(e){return this.expression.may_throw(e)||n(this.body,e)})),e(AST_SymbolRef,(function(e){return!this.is_declared(e)})),e(AST_Try,(function(e){return(this.bcatch?this.bcatch.may_throw(e):n(this.body,e))||this.bfinally&&this.bfinally.may_throw(e)})),e(AST_Unary,(function(e){return!("typeof"==this.operator&&this.expression instanceof AST_SymbolRef)&&this.expression.may_throw(e)})),e(AST_VarDef,(function(e){return!!this.value&&this.value.may_throw(e)}))}((function(e,n){e.DEFMETHOD("may_throw",n)})),function(e){function n(e){for(var n=e.length;--n>=0;)if(!e[n].is_constant_expression())return!1;return!0}e(AST_Node,return_false),e(AST_Array,(function(){return n(this.elements)})),e(AST_Binary,(function(){return this.left.is_constant_expression()&&this.right.is_constant_expression()&&("in"!=this.operator||he(this.right))})),e(AST_Constant,return_true),e(AST_Lambda,(function(e){var n=this,t=!0,i=[];return n.walk(new TreeWalker((function(r,o){if(!t)return!0;if(r instanceof AST_BlockScope){if(r===n)return;return i.push(r),o(),i.pop(),!0}if(r instanceof AST_SymbolRef){if(n.inlined||r.redef)return t=!1,!0;if(n.variables.has(r.name))return!0;var a=r.definition();if(member(a.scope,i))return!0;if(e&&!a.redefined()){var s=e.find_variable(r.name);if(a.undeclared?!s:s===a)return t="f",!0}return t=!1,!0}return r instanceof AST_This?(0==i.length&&n instanceof AST_Arrow&&(t=!1),!0):void 0}))),t})),e(AST_Object,(function(){return n(this.properties)})),e(AST_ObjectProperty,(function(){return"string"==typeof this.key&&this.value.is_constant_expression()})),e(AST_Unary,(function(){return this.expression.is_constant_expression()}))}((function(e,n){e.DEFMETHOD("is_constant_expression",n)})),function(e){function n(){var e=this.body.length;return e>0&&G(this.body[e-1])}e(AST_Statement,return_null),e(AST_Jump,return_this),e(AST_BlockStatement,n),e(AST_SwitchBranch,n),e(AST_If,(function(){return this.alternative&&G(this.body)&&G(this.alternative)&&this}))}((function(e,n){e.DEFMETHOD("aborts",n)}));var J=makePredicate(["use asm","use strict"]);function X(e){switch(e.body.length){case 0:return p(AST_EmptyStatement,e);case 1:var n=e.body[0];if(!(n instanceof AST_Const||n instanceof AST_Let))return n}return e}function Q(e,n){e.walk(new TreeWalker((function(t){return t instanceof AST_Return?(n(t),!0):t instanceof AST_Scope&&t!==e||void 0})))}function Z(e){var n=Object.create(null);return Q(e,(function(e){var t=e.value;if(t&&(t=t.tail_node()),t instanceof AST_SymbolRef){var i=t.definition().id;n[i]=(n[i]||0)+1}})),n}function ee(e,n,t){return e.bool_fn+(n[e.id]||0)===e.references.length-e.replaced&&!t.exposed(e)}function ne(e,n){Q(e,(function(e){e.in_bool=!0;var t=e.value;if(t){var i=t.is_truthy()||t.evaluate(n,!0);i?!i||i instanceof AST_Node||(t=t.drop_side_effect_free(n),e.value=t?d(e.value,[t,p(AST_Number,e.value,{value:1})]):p(AST_Number,e.value,{value:1})):(t=t.drop_side_effect_free(n),e.value=t?d(e.value,[t,p(AST_Number,e.value,{value:0})]):null)}}))}function te(e,n){if(!e.name||!n.option("ie8"))return!0;var t=e.name.definition();return!n.exposed(t)&&all(t.references,(function(e){return!(e instanceof AST_SymbolRef)}))}function ie(e,n,t){t||(t=AST_LoopControl);var i=!1,r=new TreeWalker((function(n){return!!(i||n instanceof AST_Scope)||(n instanceof t&&r.loopcontrol_target(n)===e?i=!0:void 0)}));return n instanceof AST_LabeledStatement&&r.push(n),r.push(e),e.body.walk(r),i}function re(e,n){var t=a(e.body);if(n.option("dead_code")&&(t instanceof AST_Break||t instanceof AST_Continue&&s(t)||t instanceof AST_Exit)){var i=[];e.init instanceof AST_Statement?i.push(e.init):e.init&&i.push(p(AST_SimpleStatement,e.init,{body:e.init}));var r=s(t)||t instanceof AST_Exit;return e.condition&&r?i.push(p(AST_If,e,{condition:e.condition,body:t,alternative:null})):e.condition?i.push(p(AST_SimpleStatement,e.condition,{body:e.condition})):r&&i.push(t),B(n,e.body,i),p(AST_BlockStatement,e,{body:i})}if(t instanceof AST_If){var o=a(t.body);if(o instanceof AST_Break&&!s(o)){e.condition?e.condition=p(AST_Binary,e.condition,{left:e.condition,operator:"&&",right:t.condition.negate(n)}):e.condition=t.condition.negate(n);i=m(t.alternative);return B(n,t.body,i),f(i)}if((o=a(t.alternative))instanceof AST_Break&&!s(o)){e.condition?e.condition=p(AST_Binary,e.condition,{left:e.condition,operator:"&&",right:t.condition}):e.condition=t.condition;i=m(t.body);return B(n,t.alternative,i),f(i)}}return e;function a(e){return e instanceof AST_BlockStatement?e.body[0]:e}function s(e){return n.loopcontrol_target(e)!==n.self()}function f(t){return e.body instanceof AST_BlockStatement?(e.body=e.body.clone(),e.body.body=t.concat(e.body.body.slice(1)),e.body=e.body.transform(n)):e.body=p(AST_BlockStatement,e.body,{body:t}).transform(n),re(e,n)}}function oe(e,n,t){if(e instanceof AST_Binary)if(e.left instanceof AST_String){if(e.right instanceof AST_UnaryPrefix&&"typeof"==e.right.operator){var i=e.right.expression;if(w(i)){var r,o="undefined"==e.left.value;switch(e.operator){case"==":r=o?t:n;break;case"!=":r=o?n:t;break;default:return}if(r){var a=i.definition(),s=new TreeWalker((function(e){if(e instanceof AST_Scope){var n=s.parent();if(n instanceof AST_Call&&n.expression===e)return;return!0}e instanceof AST_SymbolRef&&e.definition()===a&&(e.defined=!0)}));r.walk(s)}}}}else switch(e.operator){case"&&":oe(e.left,n),oe(e.right,n);break;case"||":oe(f(e.left),t),oe(f(e.right),t)}function f(e){if(e instanceof AST_Binary)switch(e.operator){case"==":return(e=e.clone()).operator="!=",e;case"!=":return(e=e.clone()).operator="==",e}}}function ae(e){return function(n,t){var i=!1;return this.definitions.forEach((function(r){r.value&&(i=!0),r.name.match_symbol((function(i){i instanceof AST_SymbolDeclaration&&t.push(p(AST_VarDef,i,{name:i,value:e(n,i)}))}),!0)})),i}}function se(e){return"arguments"!=e.name&&e.orig.length<(e.orig[0]instanceof AST_SymbolLambda?3:2)}function fe(e,n){if(e.exposed(n))return!0;for(var t=n.scope.resolve(),i=n.scope;i!==t;)if((i=i.parent_scope).var_names()[n.name])return!0}function ce(e){return p(AST_Var,e,{definitions:e.definitions.map((function(e){return p(AST_VarDef,e,{name:e.name.convert_symbol(AST_SymbolVar,(function(e,n){var t=e.definition();t.orig[t.orig.indexOf(n)]=e;var i=t.scope.resolve();t.scope!==i&&(t.scope=i,i.variables.set(t.name,t))})),value:e.value})}))})}function ue(e,n){return n.option("varify")&&all(e.definitions,(function(e){return!e.name.match_symbol((function(e){if(e instanceof AST_SymbolDeclaration){var t=e.definition();return!e.fixed_value()||!se(t)||fe(n,t)}}),!0)}))?ce(e):e}function le(e,n){var t=e.expression;if(!(t instanceof AST_Sequence))return e;var i=t.expressions.slice(),r=e.clone();return r.expression=i.pop(),i.push(r),d(e,i)}function _e(e,n,t){var i=e.expression,r=i instanceof AST_SymbolRef?i.fixed_value():i;if(r instanceof AST_Lambda&&!r.uses_arguments&&!r.pinned()&&!(t&&t.indexOf(r)<0)){var o=e.args;if(all(o,(function(e){return!(e instanceof AST_Spread)}))){for(var a=0,s=0,f=r===i&&!r.name&&n.drop_fargs(r,e)?function(e,t){return!e||(e instanceof AST_DestructuredArray?0==e.elements.length&&t instanceof AST_Array:e instanceof AST_DestructuredObject?0==e.properties.length&&t&&!t.may_throw_on_access(n):e.__unused)}:return_false,c=[],u=0;u<o.length;u++){var l=r.argnames[u];if(n.option("default_values")&&l instanceof AST_DefaultValue&&o[u].is_defined(n)&&(r.argnames[u]=l=l.name),!l||"__unused"in l){var _=o[u].drop_side_effect_free(n);if(f(l)){l&&r.argnames.splice(u,1),o.splice(u,1),_&&c.push(_),u--;continue}if(_)c.push(_),o[a++]=d(e,c),c=[];else if(l){if(!c.length){o[a++]=p(AST_Number,o[u],{value:0});continue}o[a++]=d(e,c),c=[]}}else{if(l&&f(l,o[u])){_=o[u].drop_side_effect_free(n);r.argnames.splice(u,1),o.splice(u,1),_&&c.push(_),u--;continue}c.push(o[u]),o[a++]=d(e,c),c=[]}s=a}for(;u<r.argnames.length;u++)f(r.argnames[u])&&r.argnames.splice(u--,1);if(o.length=s,c.length){var S=d(e,c);o.push(o.length<r.argnames.length?p(AST_UnaryPrefix,e,{operator:"void",expression:S}):S)}}}}function Se(e,n,t,i){if(i instanceof AST_Binary&&U[i.operator]&&i.right instanceof AST_Assign&&"="==i.right.operator&&i.right.left instanceof AST_SymbolRef&&i.right.left.definition()===n&&!t.has_side_effects(e)&&r(i.left)&&r(i.right.right))return n.replaced++,"&&"==i.operator?p(AST_Conditional,i,{condition:i.left,consequent:i.right.right,alternative:t}):p(AST_Conditional,i,{condition:i.left,consequent:t,alternative:i.right.right});function r(t){if(!t.has_side_effects(e)){var i=!1;return t.walk(new TreeWalker((function(e){return!!i||(e instanceof AST_SymbolRef&&e.definition()===n?i=!0:void 0)}))),!i}}}e(AST_Directive,(function(e,n){return!n.option("directives")||J[e.value]&&n.has_directive(e.value)===e?e:p(AST_EmptyStatement,e)})),e(AST_Debugger,(function(e,n){return n.option("drop_debugger")?p(AST_EmptyStatement,e):e})),e(AST_LabeledStatement,(function(e,n){return n.option("dead_code")&&e.body instanceof AST_Break&&n.loopcontrol_target(e.body)===e.body?p(AST_EmptyStatement,e):n.option("unused")&&0==e.label.references.length?e.body:e})),e(AST_Block,(function(e,n){return e.body=O(e.body,n),e})),e(AST_BlockStatement,(function(e,n){return e.body=O(e.body,n),X(e)})),e(AST_Arrow,(function(e,n){if(!n.option("arrows"))return e;var t=O(e.value?[e.first_statement()]:e.body,n);switch(t.length){case 1:var i=t[0];if(i instanceof AST_Return){e.body.length=0,e.value=i.value;break}default:e.body=t,e.value=null}return e})),e(AST_Function,(function(e,n){if(e.body=O(e.body,n),n.option("inline"))for(var t=0;t<e.body.length;t++){var i=e.body[t];if(!(i instanceof AST_Directive)){if(i instanceof AST_Return){var r=i.value;if(!r||"Call"!=r.TYPE)break;if(r.is_expr_pure(n))break;var o=r.expression;if(o instanceof AST_SymbolRef){if(e.name&&e.name.definition()===o.definition())break;o=o.fixed_value()}if(!(o instanceof AST_Defun||o instanceof AST_Function))break;if(o.uses_arguments)break;if(o===r.expression){if(o.parent_scope!==e)break;if(!all(o.enclosed,(function(n){return n.scope!==e})))break}if(o.contains_this())break;var a=o.argnames.length;if(a>0&&n.option("inline")<2)break;if(a>e.argnames.length)break;if(!all(e.argnames,(function(e){return e instanceof AST_SymbolFunarg})))break;if(!all(r.args,(function(e){return!(e instanceof AST_Spread)})))break;for(var s=0;s<a;s++){var f=r.args[s];if(!(f instanceof AST_SymbolRef))break;if(f.definition()!==e.argnames[s].definition())break}if(s<a)break;for(;s<r.args.length&&!r.args[s].has_side_effects(n);s++);if(s<r.args.length)break;if(a<e.argnames.length&&!n.drop_fargs(e,n.parent())){if(!n.drop_fargs(o,r))break;do{o.argnames.push(o.make_var(AST_SymbolFunarg,o,"argument_"+a))}while(++a<e.argnames.length)}return r.expression}break}}return e})),AST_Scope.DEFMETHOD("merge_variables",(function(e){if(e.option("merge_vars")){var n,t=this,i={},r=[],o=[],a=0,s=new Dictionary,f=Object.create(null),c=Object.create(null),u=new TreeWalker((function(e,r){if(e instanceof AST_Assign){var o=e.left;if(o instanceof AST_Destructured){e.right.walk(u);var a=new TreeWalker((function(e){if(!(e instanceof AST_Destructured))return e instanceof AST_DestructuredKeyVal?e.key instanceof AST_Node?(g(),e.key.walk(u),y(),g(),e.value.walk(a),y()):e.value.walk(a):e instanceof AST_SymbolRef?b(e,!1,!0):e.walk(u),!0}));return o.walk(a),!0}return o instanceof AST_SymbolRef?("="!=e.operator&&b(o,!0,!1),e.right.walk(u),b(o,!1,!0),!0):void 0}if(e instanceof AST_Binary){if(!U[e.operator])return;return e.left.walk(u),g(),e.right.walk(u),y(),!0}var c;if(e instanceof AST_Break)return(c=u.loopcontrol_target(e))instanceof AST_IterationStatement||x(c),!0;if(e instanceof AST_Call){var l=e.expression,_=l.tail_node();if(!is_function(_))return;return l!==_&&l.expressions.slice(0,-1).forEach((function(e){e.walk(u)})),e.args.forEach((function(e){e.walk(u)})),_.walk(u),!0}if(e instanceof AST_Conditional)return e.condition.walk(u),g(),e.consequent.walk(u),y(),g(),e.alternative.walk(u),y(),!0;if(e instanceof AST_Continue)return(c=u.loopcontrol_target(e))instanceof AST_Do&&x(c),!0;if(e instanceof AST_Do){g(),i.block=e,i.loop=!0;var S=i;return e.body.walk(u),i.inserted===e&&(i=S),e.condition.walk(u),y(),!0}if(e instanceof AST_For)return e.init&&e.init.walk(u),g(),i.block=e,i.loop=!0,e.condition&&e.condition.walk(u),e.body.walk(u),e.step&&e.step.walk(u),y(),!0;if(e instanceof AST_ForIn)return e.object.walk(u),g(),i.block=e,i.loop=!0,e.init.walk(u),e.body.walk(u),y(),!0;if(e instanceof AST_If)return e.condition.walk(u),g(),e.body.walk(u),y(),e.alternative&&(g(),e.alternative.walk(u),y()),!0;if(e instanceof AST_LabeledStatement){g(),i.block=e;S=i;return e.body.walk(u),i.inserted===e&&(i=S),y(),!0}if(e instanceof AST_Scope){if(g(),i.block=e,e===t&&(n=i),e instanceof AST_Lambda){e.name&&(f[e.name.definition().id]=!1);a=e.uses_arguments&&!u.has_directive("use strict")?function(e){e instanceof AST_SymbolFunarg&&(f[e.definition().id]=!1)}:function(e){e instanceof AST_SymbolFunarg&&b(e,!1,!0)};var p=new TreeWalker((function(n){if(n instanceof AST_SymbolDeclaration&&(f[n.definition().id]=!1),n instanceof AST_SymbolRef){var t=n.definition(),r=e.variables.get(n.name);if(r&&(r===t||t.undeclared||e.parent_scope.find_variable(n.name)===t))f[t.id]=!1,f[r.id]=!1;else{var o=i;y(),b(n,!0,!1),i=o}return!0}}));e.argnames.forEach((function(e){e.mark_symbol(a,p)}))}return e instanceof AST_Arrow&&e.value?e.value.walk(u):walk_body(e,u),y(),!0}if(e instanceof AST_Switch){e.expression.walk(u);S=i;return e.body.forEach((function(e){e instanceof AST_Default||(e.expression.walk(u),S===i&&g())})),i=S,e.body.forEach((function(n){g(),i.block=e;var t=i;walk_body(n,u),i.inserted===e&&(i=t),y()})),!0}if(e instanceof AST_SymbolRef)return b(e,!0,!1),!0;if(e instanceof AST_Try)return g(),i.block=e,walk_body(e,u),y(),e.bcatch&&(e.bcatch.argname&&e.bcatch.argname.mark_symbol((function(e){if(e instanceof AST_SymbolCatch){var n=e.definition();f[n.id]=!1,(n=n.redefined())&&(f[n.id]=!1)}}),u),g(),e.bfinally&&(i.block=e.bcatch),walk_body(e.bcatch,u),y()),e.bfinally&&e.bfinally.walk(u),!0;if(e instanceof AST_Unary){if(!UNARY_POSTFIX[e.operator])return;var d=e.expression;if(!(d instanceof AST_SymbolRef))return;return b(d,!0,!0),!0}return e instanceof AST_VarDef?(e.value&&e.value.walk(u),e.name.mark_symbol(e.value?function(e){if(e instanceof AST_SymbolDeclaration)return e instanceof AST_SymbolVar?b(e,!1,!0):f[e.definition().id]=!1,!0}:function(e){if(e instanceof AST_SymbolDeclaration){var n=e.definition().id;return e instanceof AST_SymbolVar?n in f?f[n]&&f[n].push(e):s.add(n,e):f[n]=!1,!0}},u),!0):e instanceof AST_While?(g(),i.block=e,i.loop=!0,r(),y(),!0):void 0}));u.directives=Object.create(e.directives),t.walk(u);for(var l=Object.create(null);r.length&&o.length;){var _=r.pop(),S=_.definition;if(S.id in c&&f[S.id]){for(var p={start:f[S.id].start};S.id in l;)S=l[S.id];p.end=f[S.id].end;var d=[];do{var T=o.pop();if(T&&!(T.index>_.index)){var A=T.definition.id,h=f[A];if(h){if(p.start.block===h.start.block&&w(p,h)&&(!p.start.loop||w(h,p))&&all(h,(function(e){return e.scope.find_variable(S.name)===S}))){var v=[],m=[];h.forEach((function(e){e.thedef=S,e.name=S.name,e instanceof AST_SymbolRef?m.push(e):v.push(e)})),S.orig=v.concat(S.orig),S.references=m.concat(S.references),S.fixed=T.definition.fixed&&S.fixed,l[A]=S;break}d.unshift(T)}}}while(o.length);d.length&&(o=o.concat(d))}}}function g(){i=Object.create(i)}function y(){i=Object.getPrototypeOf(i)}function b(u,l,_){var S,p=u.definition();if(p.id in f){if(!(d=f[p.id]))return;if(d.start.block!==i.block)return f[p.id]=!1;if(d.push(u),d.end=i,p.id in c)o[c[p.id]]=null;else if(!l)return}else{if((S=t.variables.get(p.name))!==p)return S&&n===i&&(f[S.id]=!1),f[p.id]=!1;if(e.exposed(p)||"arguments"==u.name||"await"==u.name)return f[p.id]=!1;var d;if((d=s.get(p.id)||[]).push(u),f[p.id]=d,!l)return d.start=i,r.push({index:a++,definition:p});if(i.block!==t)return f[p.id]=!1;d.start=n}c[p.id]=o.length,o.push({index:a++,definition:p})}function x(e){for(var n=[];;){if(HOP(i,"block")){var t=i.block;if(t instanceof AST_LabeledStatement&&(t=t.body),t===e)break}n.push(i),y()}for(i.inserted=i.block,g();n.length;){var r=n.pop();g(),HOP(r,"block")&&(i.block=r.block),HOP(r,"loop")&&(i.loop=r.loop)}}function k(e,n){return e===n||e.isPrototypeOf(n)}function w(e,n){return k(e.start,e.end)||k(e.start,n.start)}})),AST_Scope.DEFMETHOD("drop_unused",(function(e){if(e.option("unused")){var n=this,t=!(n instanceof AST_Toplevel)||e.toplevel.funcs,i=!(n instanceof AST_Toplevel)||e.toplevel.vars,o=/keep_assign/.test(e.option("unused"))?return_false:function(n,t){var i,r=!1;if(n instanceof AST_Assign?(n.write_only||"="==n.operator)&&(i=n.left):n instanceof AST_Unary&&n.write_only&&(i=n.expression),/strict/.test(e.option("pure_getters")))for(;i instanceof AST_PropAccess&&!i.expression.may_throw_on_access(e);)i instanceof AST_Sub&&t.unshift(i.property),i=i.expression,r=!0;if(i instanceof AST_SymbolRef&&!e.exposed(i.definition())&&s(i,r))return i},f=Object.create(null),c=function(t){return(c=function n(t,i,r){var o=e.parent(i);if(!o)return r;if(o instanceof AST_DestructuredKeyVal){var a=e.parent(i+1);if(o.key===t){var s=e.parent(i+2);if(s instanceof AST_Lambda)return n(s,i+3,s.argnames.indexOf(a)>=0?function(e){var n=r(e);if(n)return n;if(n=s.variables.get(e)){var t=n.orig[0];if(t instanceof AST_SymbolFunarg||t instanceof AST_SymbolLambda)return n}}:function(e){return r(e)||s.variables.get(e)})}return n(a,i+2,r)}return n(o,i+1,o.variables?function(e){return r(e)||o.variables.get(e)}:r)}(n,0,noop))(t)},u=Object.create(null),l=[],_=Object.create(null),S=Object.create(null),T=Object.create(null);n instanceof AST_Toplevel&&e.top_retain&&n.variables.each((function(n){e.top_retain(n)&&!(n.id in _)&&(_[n.id]=!0,l.push(n))}));var A=new Dictionary,v=new Dictionary,m=new Dictionary,y=this,b=new TreeWalker((function(r,o){if(r instanceof AST_Lambda&&r.uses_arguments&&!b.has_directive("use strict")&&r.each_argname((function(e){var n=e.definition();n.id in _||(_[n.id]=!0,l.push(n))})),r!==n){if(y===n){if(is_defun(r)){var a=r.name.definition();return t||a.id in _||(_[a.id]=!0,l.push(a)),m.add(a.id,r),!0}if(r instanceof AST_Definitions)return r.definitions.forEach((function(n){var t=n.value&&(n.name instanceof AST_Destructured||n.value.has_side_effects(e));n.name.mark_symbol((function(e){if(e instanceof AST_SymbolDeclaration){var o=e.definition();if(v.add(o.id,n),r instanceof AST_Var&&o.orig[0]instanceof AST_SymbolCatch){var a=o.redefined();a&&v.add(a.id,n)}return o.id in _||i&&!(r instanceof AST_Const?o.redefined():o.const_redefs)&&(r instanceof AST_Var||se(o))||(_[o.id]=!0,l.push(o)),n.value&&(t||m.add(o.id,n.value),A.add(o.id,n)),!0}}),b),t&&n.value.walk(b)})),!0;if(r instanceof AST_SymbolFunarg){a=r.definition();return v.add(a.id,r),A.add(a.id,r),!0}}return M(r,o,!0)}}));b.directives=Object.create(e.directives),n.walk(b),b=new TreeWalker(M);for(var x=0;x<l.length;x++){var k=m.get(l[x].id);k&&k.forEach((function(e){e.walk(b)}))}Object.keys(f).forEach((function(e){var n=f[e];if(n){n=n.reduce((function(e,n){return n.forEach((function(n){push_uniq(e,n)})),e}),[]);var t=(A.get(e)||[]).filter((function(e){return find_if(e instanceof AST_Unary?function(n){return n===e}:function(n){return n===e||!(n instanceof AST_Unary)&&D(n)===D(e)},n)}));n.length==t.length?f[e]=t:delete f[e]}else delete f[e]}));var w=e.option("keep_fnames")?return_false:e.option("ie8")?function(n){return!e.exposed(n)&&n.references.length==n.replaced}:function(e){return!(e.id in _)||!(e.orig.length<2)&&(e.orig[1]instanceof AST_SymbolFunarg||all(e.references,(function(e){return!e.in_arg})))},E=[],R=[],N=[],C=new TreeTransformer((function(n){if(n instanceof AST_DefaultValue)return W(C,n);if(n instanceof AST_DestructuredArray){for(var t=!0,i=n.elements.length;--i>=0;){var r=n.elements[i].transform(C);r?(n.elements[i]=r,t=!1):t?n.elements.pop():n.elements[i]=p(AST_Hole,n.elements[i])}return n}if(n instanceof AST_DestructuredKeyVal){var o=!1;if(n.key instanceof AST_Node&&(n.key=n.key.transform(P),o=n.key.has_side_effects(e)),o&&Y(n.value))n.value=n.value.transform(P);else{var a=n.value.transform(C);if(!a)return List.skip;n.value=a}return n}return n instanceof AST_SymbolDeclaration?n.definition().id in _?n:null:void 0})),P=new TreeTransformer((function(r,a,c){var l=P.parent();if(i){var S=[];if(x=o(r,S)){var T,A=(k=x.definition()).id in _;if(r instanceof AST_Assign?(!A||r.left===x&&V(k,r)<0)&&(T=I(r),!0===r.write_only&&(T=T.drop_side_effect_free(e)||p(AST_Number,r,{value:0}))):(!A||r.expression===x&&V(k,r)<0)&&(T=p(AST_Number,r,{value:0})),T)switch(l instanceof AST_Sequence&&l.tail_node()!==r&&(T=T.drop_side_effect_free(e)),T&&S.push(T),S.length){case 0:return List.skip;case 1:return h(0,l,r,S[0].transform(P));default:return d(r,S.map((function(e){return e.transform(P)})))}}else if(r instanceof AST_UnaryPostfix&&r.expression instanceof AST_SymbolRef&&V(r.expression.definition(),r)<0)return p(AST_UnaryPrefix,r,{operator:"+",expression:r.expression})}if(r instanceof AST_Call&&R.push(r),y===n){if(r instanceof AST_Lambda){if(t&&r!==n&&is_defun(r))if(!((k=r.name.definition()).id in _))return O(r.name,"Dropping unused function {name}"),k.eliminated++,c?List.skip:p(AST_EmptyStatement,r);if(is_function(r)&&r.name&&w(r.name.definition())&&E.push(r),!(r instanceof AST_Accessor)){for(var m=e.drop_fargs(r,l),g=r.argnames,b=g.length;--b>=0;){var x,k;if((x=g[b])instanceof AST_SymbolFunarg)(k=x.definition()).id in _?(m=!1,V(k,x)<0&&(x.__unused=null)):m?(O(x,"Dropping unused function argument {name}"),g.pop()):x.__unused=!0;else x.transform(C)?m=!1:m?(O(x.name,"Dropping unused function argument {name}"),g.pop()):(x.name.__unused=!0,g[b]=x.name)}N.push(r)}}if(r instanceof AST_Catch&&r.argname instanceof AST_Destructured&&r.argname.transform(C),r instanceof AST_Definitions&&!(l instanceof AST_ForIn&&l.init===r)){var D=[],U=[],z=[],j=[],q=0,L=r instanceof AST_Var;switch(r.definitions.forEach((function(n){if(n.value&&(n.value=n.value.transform(P)),n.name instanceof AST_Destructured){K(n.name,n.value,(function(e){return i?e.definition().id in _||A(e)||L&&!s(e)?e:null:e}))?h():(f=n.value.drop_side_effect_free(e))&&j.push(f)}else{var t=n.name.definition(),o=L?s(n.name):se(t);if(o&&i&&!(t.id in _))if(A(n.name)){(f=n.value&&n.value.drop_side_effect_free(e))&&j.push(f),(u=v.get(t.id)).length>1?(AST_Node.warn("Dropping duplicated declaration of variable {name} [{file}:{line},{col}]",B(n.name)),remove(u,n),t.eliminated++):(n.value=null,U.push(n))}else{(f=n.value&&!n.value.single_use&&n.value.drop_side_effect_free(e))?(AST_Node.warn("Side effects in initialization of unused variable {name} [{file}:{line},{col}]",B(n.name)),j.push(f)):O(n.name,"Dropping unused variable {name}"),t.eliminated++}else{if(n.value&&V(t,n)<0){var a=n.value.write_only,f=n.value.drop_side_effect_free(e);n.value!==f?n.value=f&&d(n.value,[f,p(AST_Number,n.value,{value:0})]):n.value.write_only!==a&&(n.value.write_only=a)}var c,u=v.get(t.id);if(n.value||r instanceof AST_Let)if(e.option("functions")&&!e.option("ie8")&&!(r instanceof AST_Const||r instanceof AST_Let)&&1==u.length&&0==t.assignments&&n.value instanceof AST_Function&&(t.references.length?all(t.references,(function(e){return n.value===e.fixed_value()})):n.value===n.name.fixed_value())&&(!n.value.name||0==(c=n.value.name.definition()).assignments&&(c.name==n.name.name||all(c.references,(function(e){return e.scope.find_variable(n.name.name)===n.name.definition()}))))&&(e.has_directive("use strict")?l instanceof AST_Scope:l instanceof AST_Block||l instanceof AST_For&&l.init===r||l instanceof AST_If)&&function(e,n){var t=e.variables.get(n);return!t||e.name&&t===e.name.definition()}(n.value,n.name.name)){AST_Node.warn("Declaring {name} as function [{file}:{line},{col}]",B(n.name));var S=p(AST_Defun,n,n.value);S.name=p(AST_SymbolDefun,n.name,n.name);var T=n.name.scope.resolve().def_function(S.name);c&&c.references.forEach((function(e){e.name=T.name,e.thedef=T,e.reference({})})),D.push(S)}else o&&u.length>1&&t.orig.indexOf(n.name)>t.eliminated&&(remove(u,n),q++),h();else o&&u.length>1?(AST_Node.info("Dropping declaration of variable {name} [{file}:{line},{col}]",B(n.name)),remove(u,n),t.eliminated++):U.push(n)}}function A(e){var n=e.definition();return n.orig[0]instanceof AST_SymbolCatch&&n.scope.resolve()===e.scope.resolve()}function h(){j.length>0&&(0==z.length?D.push(p(AST_SimpleStatement,r,{body:d(r,j)})):n.value?(j.push(n.value),n.value=d(n.value,j)):n.value=p(AST_UnaryPrefix,n,{operator:"void",expression:d(n,j)}),j=[]),z.push(n)}})),U.length){case 0:if(0==z.length)break;if(z.length==q){[].unshift.apply(j,z.map((function(e){AST_Node.warn("Dropping duplicated definition of variable {name} [{file}:{line},{col}]",B(e.name));var n=e.name.definition(),t=p(AST_SymbolRef,e.name,e.name);n.references.push(t);var i=p(AST_Assign,e,{operator:"=",left:t,right:e.value}),r=V(n,e);return r>=0&&(f[n.id][r]=i),n.eliminated++,i})));break}case 1:if(0==z.length){var H=U[0].name.definition().id;if(H in u){r.definitions=U,u[H].init=r;break}}default:r.definitions=U.concat(z),D.push(r)}return j.length>0&&D.push(p(AST_SimpleStatement,r,{body:d(r,j)})),F(D,r,c)}if(r instanceof AST_Assign){if(a(r,P),r.left instanceof AST_Destructured){var M=K(r.left,r.right,(function(e){return e}));if(!M)return r.right;r.left=M}return r}if(r instanceof AST_LabeledStatement&&r.body instanceof AST_For){if(a(r,P),r.body instanceof AST_BlockStatement){var Y=r.body;return r.body=Y.body.pop(),Y.body.push(r),c?List.splice(Y.body):Y}return r}if(r instanceof AST_Scope){var W=y;return y=r,a(r,P),y=W,r}}}),(function(n,t){if(n instanceof AST_BlockStatement)switch(n.body.length){case 0:return t?List.skip:p(AST_EmptyStatement,n);case 1:var r=n.body[0];if(!(r instanceof AST_Const||r instanceof AST_Let))return r}else{var o;if(n instanceof AST_For)return n.init instanceof AST_BlockStatement&&(o=n.init,n.init=o.body.pop(),o.body.push(n)),n.init instanceof AST_Defun?(o||(o=p(AST_BlockStatement,n,{body:[n]})),o.body.splice(-1,0,n.init),n.init=null):n.init instanceof AST_SimpleStatement?n.init=n.init.body:g(n.init)&&(n.init=null),o?t?List.splice(o.body):o:n;if(n instanceof AST_ForIn){if(!i||!e.option("loops"))return;if(!g(n.body))return;var a=H(n);if(!a)return;var s=a.definition();if(s.id in _)return;O(a,"Dropping unused loop variable {name}"),u[s.id]===n&&delete u[s.id];var f=[],c=n.object.drop_side_effect_free(e);return c&&(AST_Node.warn("Side effects in object of for-in loop [{file}:{line},{col}]",c.start),f.push(p(AST_SimpleStatement,n,{body:c}))),n.init instanceof AST_Definitions&&s.orig[0]instanceof AST_SymbolCatch&&f.push(n.init),F(f,n,t)}if(n instanceof AST_Sequence&&1==n.expressions.length)return n.expressions[0]}}));P.push(e.parent()),n.transform(P),n instanceof AST_Lambda&&1==n.body.length&&n.body[0]instanceof AST_Directive&&"use strict"==n.body[0].value&&(n.body.length=0),E.forEach((function(e){e.name=null})),R.forEach((function(n){_e(n,e,N)}))}function O(e,n){AST_Node[e.definition().references.length>0?"info":"warn"](n+" [{file}:{line},{col}]",B(e))}function B(e){return{name:e.name,file:e.start.file,line:e.start.line,col:e.start.col}}function F(e,n,t){switch(e.length){case 0:return t?List.skip:p(AST_EmptyStatement,n);case 1:return e[0];default:return t?List.splice(e):p(AST_BlockStatement,n,{body:e})}}function j(e,t){return e.scope===n&&(e.fixed&&t.fixed||(f[e.id]=!1),!1!==f[e.id])}function q(e,n){f[e.id]||(f[e.id]=[]),n.fixed.assigns&&push_uniq(f[e.id],n.fixed.assigns)}function V(e,n){var t=f[e.id];return t&&t.indexOf(n)}function L(e,n,t){e.id in _||(n&&t?(_[e.id]=!0,l.push(e)):(S[e.id]=n,T[e.id]=t))}function I(n){var t=n.right;if(!n.write_only)return t;if(!(t instanceof AST_Binary&&U[t.operator]))return t;if(!(t.left instanceof AST_SymbolRef))return t;if(!(n.left instanceof AST_SymbolRef))return t;var i=n.left.definition();return t.left.definition()!==i||t.right.has_side_effects(e)?t:(j(i,t.left)&&q(i,t.left),t.right)}function H(e){var n=e.init;if(n instanceof AST_Definitions)return(n=n.definitions[0].name)instanceof AST_SymbolDeclaration&&n;for(;n instanceof AST_PropAccess;)n=n.expression.tail_node();return n instanceof AST_SymbolRef?n:void 0}function M(t,s,f){t instanceof AST_Assign&&t.left instanceof AST_SymbolRef&&((w=t.left.definition()).scope===n&&A.add(w.id,t));t instanceof AST_Unary&&t.expression instanceof AST_SymbolRef&&((w=t.expression.definition()).scope===n&&A.add(w.id,t));var p,d=[];if((k=o(t,d))&&n.variables.get(k.name)===(p=k.definition())&&(!r(p)||all(n.argnames,(function(e){return!e.match_symbol((function(e){if(e instanceof AST_SymbolFunarg){var n=e.definition();return n.references.length>n.replaced}}),!0)})))){if(d.forEach((function(e){e.walk(b)})),t instanceof AST_Assign){if("p"===t.write_only&&t.right.may_throw_on_access(e))return;var h=I(t);if(f&&!0===t.write_only&&p.scope===n&&!h.has_side_effects(e)?m.add(p.id,h):h.walk(b),t.left===k)t.write_only||L(p,!0,T[p.id]);else{var v=k.fixed_value();v&&v.is_constant()||L(p,S[p.id],!0)}}return j(p,k)&&z(k,t)!==k&&q(p,k),!0}if(t instanceof AST_ForIn){if(t.init instanceof AST_SymbolRef&&y===n){var x=t.init.definition().id;x in u||(u[x]=t)}if(!i||!e.option("loops"))return;if(!g(t.body))return;if(t.init.has_side_effects(e))return;var k,w;if(!(k=H(t)))return;if((w=k.definition()).scope!==n){var D=c(k.name);if((D&&D.redefined()||D)===w)return}return t.object.walk(b),!0}if(t instanceof AST_SymbolRef){if((p=t.definition()).id in _||(_[p.id]=!0,l.push(p)),a(p.scope,t.scope)){var E=p.redefined();E&&!(E.id in _)&&(_[E.id]=!0,l.push(E))}return j(p,t)&&q(p,t),!0}if(t instanceof AST_Scope){var R=y;return y=t,s(),y=R,!0}}function Y(e){return(e instanceof AST_DefaultValue?e.name:e)instanceof AST_SymbolDeclaration}function W(n,t){t.value=t.value.transform(P);var i=t.name.transform(n);if(!i){var r=t.value.drop_side_effect_free(e);if(!r)return null;(i=t.name)instanceof AST_Destructured?((i=i.clone())[i instanceof AST_DestructuredArray?"elements":"properties"]=[],r instanceof AST_Array||r.is_string(e)||i instanceof AST_DestructuredObject&&(r instanceof AST_Object||r.is_boolean(e)||r.is_number(e))||(r=p(AST_Array,r,{elements:[r]})),t.name=i):O(i,"Side effects in default value of unused variable {name}"),t.value=r}return t}function K(n,t,i){var r=new TreeTransformer((function(n){if(n instanceof AST_DefaultValue){if(!(e.option("default_values")&&t&&t.is_defined(e)))return W(r,n);n=n.name}if(n instanceof AST_DestructuredArray){var o=t;t instanceof AST_SymbolRef&&(t=t.fixed_value());var a=t instanceof AST_Array&&t.elements,s=[];if(n.elements.forEach((function(e,n){e instanceof AST_Hole||(t=a&&a[n],(e=e.transform(r))&&(s[n]=e))})),t=o,a&&0==s.length)return null;for(var f=s.length;--f>=0;)s[f]||(s[f]=p(AST_Hole,n.elements[f]||n));return n.elements=s,n}if(n instanceof AST_DestructuredObject){o=t;if(t instanceof AST_SymbolRef&&(t=t.fixed_value()),t instanceof AST_Object){a=Object.create(null);for(f=0;f<t.properties.length;f++){var c=t.properties[f];if("string"!=typeof c.key){a=null;break}a[c.key]=c.value}}var u=[];return n.properties.forEach((function(n){var i;if(n.key instanceof AST_Node?(n.key=n.key.transform(P),t=null,i=n.key.has_side_effects(e)):(t=a&&a[n.key],i=!1),i&&Y(n.value))n.value=n.value.transform(P),u.push(n);else{var o=n.value.transform(r);o&&(n.value=o,u.push(n))}})),t=o,0==u.length&&t&&!t.may_throw_on_access(e)?null:(n.properties=u,n)}return i(n)}));return n.transform(r)}})),AST_Scope.DEFMETHOD("hoist_declarations",(function(e){if(!e.has_directive("use asm")){var n=e.option("hoist_funs"),t=e.option("hoist_vars"),i=this;if(t){var r=0;i.walk(new TreeWalker((function(e){return r>1||(e instanceof AST_Scope&&e!==i||(e instanceof AST_Var?(r++,!0):void 0))}))),r<=1&&(t=!1)}if(n||t){var o=Object.create(null),a=[],s=[],f=new Dictionary,c=0,u=new TreeTransformer((function(r){if(r!==i){if(r instanceof AST_Directive)return a.push(r),p(AST_EmptyStatement,r);if(n&&r instanceof AST_Defun&&(u.parent()===i||!e.has_directive("use strict")))return s.push(r),p(AST_EmptyStatement,r);if(t&&r instanceof AST_Var){if(!all(r.definitions,(function(e){var n=e.name;return n instanceof AST_SymbolVar&&!o[n.name]&&i.find_variable(n.name)===n.definition()})))return r;r.definitions.forEach((function(e){f.set(e.name.name,e),++c}));var l=r.to_assignments(),_=u.parent();if(_ instanceof AST_ForIn&&_.init===r){if(l)return l;var S=r.definitions[0].name;return p(AST_SymbolRef,S,S)}return _ instanceof AST_For&&_.init===r?l:l?p(AST_SimpleStatement,r,{body:l}):p(AST_EmptyStatement,r)}return r instanceof AST_Scope?r:r instanceof AST_SymbolConst?(o[r.name]=!0,r):void 0}}));if(i.transform(u),c>0){var l=[];f.each((function(e,n){i instanceof AST_Lambda&&!all(i.argnames,(function(e){return e.name!=n}))?f.del(n):((e=e.clone()).value=null,l.push(e),f.set(n,e))})),l.length>0&&(!function e(n){for(;n.length;){var t=n[0];if(t instanceof AST_SimpleStatement){var i,r,o=t.body;if(o instanceof AST_Assign&&"="==o.operator&&(i=o.left)instanceof AST_Symbol&&f.has(i.name)){if((a=f.get(i.name)).value)break;a.value=o.right,remove(l,a),l.push(a),n.shift();continue}if(o instanceof AST_Sequence&&(r=o.expressions[0])instanceof AST_Assign&&"="==r.operator&&(i=r.left)instanceof AST_Symbol&&f.has(i.name)){var a;if((a=f.get(i.name)).value)break;a.value=r.right,remove(l,a),l.push(a),t.body=d(o,o.expressions.slice(1));continue}}if(t instanceof AST_EmptyStatement)n.shift();else{if(!(t instanceof AST_BlockStatement)||e(t.body))break;n.shift()}}return n.length}(i.body),l=p(AST_Var,i,{definitions:l}),s.push(l))}i.body=a.concat(s,i.body)}}})),AST_Scope.DEFMETHOD("process_boolean_returns",noop),AST_Defun.DEFMETHOD("process_boolean_returns",(function(e){if(e.option("booleans")){var n=Z(this);ee(this.name.definition(),n,e)&&ne(this,e)}})),AST_Function.DEFMETHOD("process_boolean_returns",(function(e){if(e.option("booleans")){var n=Z(this);if(!this.name||ee(this.name.definition(),n,e)){var t=e.parent();if(t instanceof AST_Assign){if("="!=t.operator)return;if(!((i=t.left)instanceof AST_SymbolRef))return;if(!ee(i.definition(),n,e))return}else if(t instanceof AST_Call&&t.expression!==this){var i,r=t.expression;if(r instanceof AST_SymbolRef&&(r=r.fixed_value()),!(r instanceof AST_Lambda))return;if(r.uses_arguments||r.pinned())return;if((i=r.argnames[t.args.indexOf(this)])instanceof AST_DefaultValue&&(i=i.name),i instanceof AST_SymbolFunarg&&!ee(i.definition(),n,e))return}else{if("Call"!=t.TYPE)return;e.pop();var o=e.in_boolean_context();if(e.push(this),!o)return}ne(this,e)}}})),AST_BlockScope.DEFMETHOD("var_names",(function(){var e=this._var_names;return e||(this._var_names=e=Object.create(null),this.enclosed.forEach((function(n){e[n.name]=!0})),this.variables.each((function(n,t){e[t]=!0}))),e})),AST_Scope.DEFMETHOD("make_var",(function(e,n,t){var i=[this];n instanceof AST_SymbolDeclaration&&n.definition().references.forEach((function(e){var n=e.scope;if(!member(n,i))do{push_uniq(i,n),n=n.parent_scope}while(n&&n!==this)}));for(var r=t=t.replace(/(?:^[^a-z_$]|[^a-z0-9_$])/gi,"_"),o=0;!all(i,(function(e){return!e.var_names()[r]}));o++)r=t+"$"+o;var a=p(e,n,{name:r,scope:this}),s=this.def_variable(a);return i.forEach((function(e){e.enclosed.push(s),e.var_names()[r]=!0})),a})),AST_Scope.DEFMETHOD("hoist_properties",(function(e){if(e.option("hoist_props")&&!e.has_directive("use asm")){var n=this,t=n instanceof AST_Toplevel&&e.top_retain||return_false,i=Object.create(null);n.transform(new TreeTransformer((function(e,t){if(e instanceof AST_Assign){if("="!=e.operator)return;if(!e.write_only)return;if(e.left.scope!==n)return;if(!r(e.left,e.right,1))return;t(e,this);var o=new Dictionary,a=[],s=[];return e.right.properties.forEach((function(t){var i=c(e.left,t.key);s.push(p(AST_VarDef,e,{name:i,value:null}));var r=p(AST_SymbolRef,e,{name:i.name,scope:n,thedef:i.definition()});r.reference({}),a.push(p(AST_Assign,e,{operator:"=",left:r,right:t.value}))})),i[e.left.definition().id]=o,n.body.splice(n.body.indexOf(this.stack[1])+1,0,p(AST_Var,e,{definitions:s})),d(e,a)}if(e instanceof AST_Scope)return e===n?void 0:e;if(e instanceof AST_VarDef){if(!r(e.name,e.value,0))return;t(e,this);o=new Dictionary;var f=[];return e.value.properties.forEach((function(n){f.push(p(AST_VarDef,e,{name:c(e.name,n.key),value:n.value}))})),i[e.name.definition().id]=o,List.splice(f)}function c(e,t){var i=n.make_var(AST_SymbolVar,e,e.name+"_"+t);return o.set(t,i.definition()),i}}))),n.transform(new TreeTransformer((function(e,n){if(e instanceof AST_Binary)return a("right");if(e instanceof AST_PropAccess){if(!(e.expression instanceof AST_SymbolRef))return;var t=i[e.expression.definition().id];if(!t)return;var r=t.get(e.getProperty()),o=p(AST_SymbolRef,e,{name:r.name,scope:e.expression.scope,thedef:r});return o.reference({}),o}if(e instanceof AST_Unary){if(unary_side_effects[e.operator])return;return a("expression")}function a(n){var t=e[n];if(t instanceof AST_SymbolRef&&t.definition().id in i){var r=e.clone();return r[n]=p(AST_Object,t,{properties:[]}),r}}})))}function r(e,n,i){if(e instanceof AST_Symbol){var r=e.definition();if(r.assignments==i&&!r.direct_access&&1!=r.escaped.depth&&r.references.length-r.replaced!=i&&!r.single_use&&!t(r)&&e.fixed_value()===n)return n instanceof AST_Object&&n.properties.length>0&&all(n.properties,(function(e){return e instanceof AST_ObjectKeyVal&&"string"==typeof e.key}))&&all(r.references,(function(e){return e.fixed_value()===n}))&&s(e)}}})),function(e){function n(e,n,t,i){var r=e.length;if(!r)return null;for(var o=[],a=!1,s=0;s<r;s++){var f,c=e[s];(f=i&&c instanceof AST_Spread?i(c,n,t):c.drop_side_effect_free(n,t))!==c&&(a=!0),f&&(o.push(f),t=!1)}return a?o.length?o:null:e}function t(e,n,t){var i=e.expression;return i.is_string(n)?i.drop_side_effect_free(n,t):e}function i(e){return e instanceof AST_Spread?p(AST_Array,e,{elements:[e]}):e}e(AST_Node,return_this),e(AST_Accessor,return_null),e(AST_Array,(function(e,r){var o=n(this.elements,e,r,t);return o?o===this.elements&&all(o,(function(e){return e instanceof AST_Spread}))?this:d(this,o.map(i)):null})),e(AST_Arrow,return_null),e(AST_Assign,(function(e){var n=this.left;if(n instanceof AST_PropAccess){var t=n.expression;if(t instanceof AST_Assign&&"="==t.operator&&!t.may_throw_on_access(e)&&(t.write_only="p"),e.has_directive("use strict")&&t.is_constant())return this}return n.has_side_effects(e)?this:(this.write_only=!0,x(n).is_constant_expression(e.find_parent(AST_Scope))?this.right.drop_side_effect_free(e):this)})),e(AST_AsyncFunction,return_null),e(AST_Binary,(function(e,n){if("in"==this.operator&&!he(this.right))return(t=this.left.drop_side_effect_free(e,n))===this.left?this:((i=this.clone()).left=t||p(AST_Number,this.left,{value:0}),i);var t,i,r=this.right.drop_side_effect_free(e,n);return r?!U[this.operator]||r instanceof AST_Function?(t=this.left.drop_side_effect_free(e,n))?d(this,[t,r.drop_side_effect_free(e)]):r:(r!==(i=this).right&&((i=this.clone()).right=r.drop_side_effect_free(e)),(n?q:j)(i,p(AST_Binary,this,{operator:"&&"==i.operator?"||":"&&",left:i.left.negate(e,n),right:i.right}))):this.left.drop_side_effect_free(e,n)})),e(AST_Call,(function(e,r){var o=this;if(o.is_expr_pure(e)){o.pure&&AST_Node.warn("Dropping __PURE__ call [{file}:{line},{col}]",o.start);var a=n(o.args,e,r,t);return a&&d(o,a.map(i))}var s,f=o.expression;if(o.is_call_pure(e))return(u=o.args.slice()).unshift(f.expression),(u=n(u,e,r,t))&&d(o,u.map(i));if(f instanceof AST_Function&&!(f.name&&(s=f.name.definition()).references.length>s.replaced)&&(f.process_expression(!1,(function(n){var t=n.value&&n.value.drop_side_effect_free(e,!0);return t?p(AST_SimpleStatement,n,{body:t}):p(AST_EmptyStatement,n)})),Q(f,(function(n){n.value&&(n.value=n.value.drop_side_effect_free(e))})),(o=o.clone()).expression=f.clone()),o instanceof AST_New){var c=f;if(c instanceof AST_SymbolRef&&(c=c.fixed_value()),c instanceof AST_Lambda){c.new=!0;var u,l=all(c.body,(function(n){return!n.has_side_effects(e)}));if(delete c.new,l)return(u=o.args.slice()).unshift(f),(u=n(u,e,r,t))&&d(o,u.map(i));if(!c.contains_this())return p(AST_Call,o,o)}}return o})),e(AST_Conditional,(function(e){var n,t,i=this.consequent.drop_side_effect_free(e),r=this.alternative.drop_side_effect_free(e);return i===this.consequent&&r===this.alternative?this:(e.option("ie8")&&(n=[],i instanceof AST_Function&&(n.push(i),i=null),r instanceof AST_Function&&(n.push(r),r=null)),i?r?((t=this.clone()).consequent=i,t.alternative=r):t=p(AST_Binary,this,{operator:"&&",left:this.condition,right:i}):t=r?p(AST_Binary,this,{operator:"||",left:this.condition,right:r}):this.condition.drop_side_effect_free(e),e.option("ie8")?(t&&n.push(t),0==n.length?null:d(this,n)):t)})),e(AST_Constant,return_null),e(AST_Dot,(function(e,n){var t=this.expression;return t.may_throw_on_access(e)?this:t.drop_side_effect_free(e,n)})),e(AST_Function,(function(e){return te(this,e)?null:this})),e(AST_Object,(function(e,t){var i=[];this.properties.forEach((function(e){e instanceof AST_Spread?i.push(e):(e.key instanceof AST_Node&&i.push(e.key),i.push(e.value))}));var r=n(i,e,t,(function(e,n,t){var i=e.expression;return $(i)?e:i.drop_side_effect_free(n,t)}));return r?r!==i||all(r,(function(e){return!(e instanceof AST_Spread)}))?d(this,r.map((function(e){return e instanceof AST_Spread?p(AST_Object,e,{properties:[e]}):e}))):this:null})),e(AST_Sequence,(function(e,t){var i=n(this.expressions,e,t);if(!i)return null;var r,o,a,s=i.length-1;return e.option("conditionals")&&s>0&&(r=i[s-1])instanceof AST_Assign&&"="==r.operator&&(a=r.left)instanceof AST_SymbolRef&&(o=Se(e,a.definition(),r.right,i[s]))&&((r=r.clone()).right=o,(i=i.slice(0,-2)).push(r)),i===this.expressions?this:d(this,i)})),e(AST_Sub,(function(e,n){if(this.expression.may_throw_on_access(e))return this;var t=this.expression.drop_side_effect_free(e,n);if(!t)return this.property.drop_side_effect_free(e,n);var i=this.property.drop_side_effect_free(e);return i?d(this,[t,i]):t})),e(AST_SymbolRef,(function(e){return this.is_declared(e)&&s(this)?null:this})),e(AST_This,return_null),e(AST_Unary,(function(e,n){var t=this.expression;if(unary_side_effects[this.operator])return this.write_only=!t.has_side_effects(e),this;if("typeof"==this.operator&&t instanceof AST_SymbolRef&&s(t))return null;var i=t.drop_side_effect_free(e,n);return n&&i&&k(i)?i===t&&"!"==this.operator?this:i.negate(e,n):i}))}((function(e,n){e.DEFMETHOD("drop_side_effect_free",n)})),e(AST_SimpleStatement,(function(e,n){if(n.option("side_effects")){var t=e.body,i=t.drop_side_effect_free(n,!0);if(!i)return AST_Node.warn("Dropping side-effect-free statement [{file}:{line},{col}]",e.start),p(AST_EmptyStatement,e);if(i!==t)return p(AST_SimpleStatement,e,{body:i})}return e})),e(AST_While,(function(e,n){return n.option("loops")?p(AST_For,e,e).optimize(n):e})),e(AST_Do,(function(e,n){if(!n.option("loops"))return e;var t=e.condition.is_truthy()||e.condition.evaluate(n,!0);if(!(t instanceof AST_Node)){if(t&&!ie(e,n.parent(),AST_Continue))return p(AST_For,e,{body:p(AST_BlockStatement,e.body,{body:[e.body,p(AST_SimpleStatement,e.condition,{body:e.condition})]})}).optimize(n);if(!ie(e,n.parent()))return p(AST_BlockStatement,e.body,{body:[e.body,p(AST_SimpleStatement,e.condition,{body:e.condition})]}).optimize(n)}if(e.body instanceof AST_BlockStatement&&!ie(e,n.parent(),AST_Continue)){for(var i=e.body.body,r=i.length;--r>=0;){var o=i[r];if(o instanceof AST_If&&!o.alternative&&o.body instanceof AST_Break&&n.loopcontrol_target(o.body)===e){if(a(o.condition))break;e.condition=p(AST_Binary,e,{operator:"&&",left:o.condition.negate(n),right:e.condition}),i.splice(r,1)}else if(o instanceof AST_SimpleStatement){if(a(o.body))break;e.condition=d(e,[o.body,e.condition]),i.splice(r,1)}else if(!P(o))break}e.body=X(e.body)}return e.body instanceof AST_EmptyStatement?p(AST_For,e,e).optimize(n):e.body instanceof AST_SimpleStatement?p(AST_For,e,{condition:d(e.condition,[e.body.body,e.condition]),body:p(AST_EmptyStatement,e)}).optimize(n):e;function a(n){var t=!1;return n.walk(new TreeWalker((function(n){return!!t||(n instanceof AST_SymbolRef?(member(n.definition(),e.enclosed)||(t=!0),!0):void 0)}))),t}})),e(AST_For,(function(e,n){if(!n.option("loops"))return e;if(n.option("side_effects")&&(e.init&&(e.init=e.init.drop_side_effect_free(n)),e.step&&(e.step=e.step.drop_side_effect_free(n))),e.condition){var t=e.condition.evaluate(n);if(t instanceof AST_Node)t=e.condition.is_truthy()||e.condition.evaluate(n,!0);else if(t)e.condition=null;else if(!n.option("dead_code")){var i=e.condition;e.condition=T(t,e.condition),e.condition=j(e.condition.transform(n),i)}if(t)!e.condition||t instanceof AST_Node||(e.body=p(AST_BlockStatement,e.body,{body:[p(AST_SimpleStatement,e.condition,{body:e.condition}),e.body]}),e.condition=null);else if(n.option("dead_code")){var r=[];return e.init instanceof AST_Statement?r.push(e.init):e.init&&r.push(p(AST_SimpleStatement,e.init,{body:e.init})),r.push(p(AST_SimpleStatement,e.condition,{body:e.condition})),B(n,e.body,r),p(AST_BlockStatement,e,{body:r}).optimize(n)}}return re(e,n)})),e(AST_ForIn,(function(e,n){if(n.option("varify")&&(e.init instanceof AST_Const||e.init instanceof AST_Let)){var t=e.init.definitions[0].name;(t instanceof AST_Destructured||t instanceof AST_SymbolLet)&&!t.match_symbol((function(e){if(e instanceof AST_SymbolDeclaration)return fe(n,e.definition())}),!0)&&(e.init=ce(e.init))}return e})),e(AST_If,(function(e,n){if(g(e.alternative)&&(e.alternative=null),!n.option("conditionals"))return e;var t=e.condition.evaluate(n);if(!n.option("dead_code")&&!(t instanceof AST_Node)){var i=e.condition;e.condition=T(t,i),e.condition=j(e.condition.transform(n),i)}if(n.option("dead_code")){if(t instanceof AST_Node&&(t=e.condition.is_truthy()||e.condition.evaluate(n,!0)),!t){AST_Node.warn("Condition always false [{file}:{line},{col}]",e.condition.start);var r=[p(AST_SimpleStatement,e.condition,{body:e.condition})];return B(n,e.body,r),e.alternative&&r.push(e.alternative),p(AST_BlockStatement,e,{body:r}).optimize(n)}if(!(t instanceof AST_Node)){AST_Node.warn("Condition always true [{file}:{line},{col}]",e.condition.start);r=[p(AST_SimpleStatement,e.condition,{body:e.condition}),e.body];return e.alternative&&B(n,e.alternative,r),p(AST_BlockStatement,e,{body:r}).optimize(n)}}var o=e.condition.negate(n),a=e.condition.print_to_string().length,s=o.print_to_string().length,f=s<a;if(e.alternative&&f){f=!1,e.condition=o;var c=e.body;e.body=e.alternative||p(AST_EmptyStatement,e),e.alternative=c}r=[];var u=[],l=[],_=v(e.body,r,u,l),S=v(e.alternative,r,u,l);if(_&&S)return u.length>0&&r.push(p(AST_Var,e,{definitions:u})),0==_.length?r.push(p(AST_SimpleStatement,e.condition,{body:S.length>0?p(AST_Binary,e,{operator:"||",left:e.condition,right:d(e.alternative,S)}).transform(n):e.condition.clone()}).optimize(n)):0==S.length?(a===s&&!f&&e.condition instanceof AST_Binary&&"||"==e.condition.operator&&(f=!0),r.push(p(AST_SimpleStatement,e,{body:p(AST_Binary,e,{operator:f?"||":"&&",left:f?o:e.condition,right:d(e.body,_)}).transform(n)}).optimize(n))):r.push(p(AST_SimpleStatement,e,{body:p(AST_Conditional,e,{condition:e.condition,consequent:d(e.body,_),alternative:d(e.alternative,S)})}).optimize(n)),l.forEach((function(e){e.definition().references.push(e)})),p(AST_BlockStatement,e,{body:r}).optimize(n);if(g(e.body)&&(e=p(AST_If,e,{condition:o,body:e.alternative,alternative:null})),e.body instanceof AST_Exit&&e.alternative instanceof AST_Exit&&e.body.TYPE==e.alternative.TYPE){var A=p(e.body.CTOR,e,{value:p(AST_Conditional,e,{condition:e.condition,consequent:e.body.value||p(AST_Undefined,e.body).transform(n),alternative:e.alternative.value||p(AST_Undefined,e.alternative).transform(n)})});return A instanceof AST_Return&&(A.in_bool=e.body.in_bool||e.alternative.in_bool),A}if(e.body instanceof AST_If&&!e.body.alternative&&!e.alternative&&(e=p(AST_If,e,{condition:p(AST_Binary,e.condition,{operator:"&&",left:e.condition,right:e.body.condition}),body:e.body.body,alternative:null})),G(e.body)&&e.alternative){var h=e.alternative;return e.alternative=null,p(AST_BlockStatement,e,{body:[e,h]}).optimize(n)}if(G(e.alternative)){r=e.body;return e.body=e.alternative,e.condition=f?o:e.condition.negate(n),e.alternative=null,p(AST_BlockStatement,e,{body:[e,r]}).optimize(n)}return n.option("typeofs")&&oe(e.condition,e.body,e.alternative),e;function v(e,t,i,r){if(null==e)return[];if(e instanceof AST_BlockStatement){for(var o=[],a=0;a<e.body.length;a++){var s=e.body[a];if(s instanceof AST_Defun)t.push(s);else{if(s instanceof AST_EmptyStatement)continue;if(s instanceof AST_SimpleStatement){if(!n.option("sequences")&&o.length>0)return;o.push(s.body)}else{if(!(s instanceof AST_Var))return;if(!n.option("sequences")&&o.length>0)return;s.remove_initializers(n,i),s.definitions.forEach(f)}}}return o}if(e instanceof AST_Defun)return t.push(e),[];if(e instanceof AST_EmptyStatement)return[];if(e instanceof AST_SimpleStatement)return[e.body];if(e instanceof AST_Var){o=[];return e.remove_initializers(n,i),e.definitions.forEach(f),o}function f(e){e.value&&o.push(p(AST_Assign,e,{operator:"=",left:e.name.convert_symbol(AST_SymbolRef,(function(e){r.push(e)})),right:e.value}))}}})),e(AST_Switch,(function(e,n){if(!n.option("switches"))return e;var t,i=e.expression.evaluate(n);if(!(i instanceof AST_Node)){var r=e.expression;e.expression=T(i,r),e.expression=j(e.expression.transform(n),r)}if(!n.option("dead_code"))return e;i instanceof AST_Node&&(i=e.expression.evaluate(n,!0));for(var o,a,s=[],f=[],c=0,u=e.body.length;c<u&&!a;c++){if((t=e.body[c])instanceof AST_Default){var l=f[f.length-1];if(o||m(t.body[0],n)&&(!l||G(l))){b(t,l);continue}o=t}else if(!(i instanceof AST_Node)){if(!((S=t.expression.evaluate(n))instanceof AST_Node)&&S!==i){b(t,f[f.length-1]);continue}if(S instanceof AST_Node&&(S=t.expression.evaluate(n,!0)),S===i&&(a=t,o)){var _=f.indexOf(o);f.splice(_,1),b(o,f[_-1]),o=null}}if(G(t))G(l=f[f.length-1])&&l.body.length==t.body.length&&p(AST_BlockStatement,l,l).equivalent_to(p(AST_BlockStatement,t,t))&&(l.body=[]);f.push(t)}for(;c<u;)b(e.body[c++],f[f.length-1]);for(;t=f[f.length-1];){if(m(t.body[t.body.length-1],n)&&t.body.pop(),t===o){if(!y(t))break}else{if(t.expression.has_side_effects(n))break;if(o){if(!y(o))break;if(f[f.length-2]!==o)break;o.body=o.body.concat(t.body),t.body=[]}else if(!y(t))break}b(t),f.pop()===o&&(o=null)}if(0==f.length)return p(AST_BlockStatement,e,{body:s.concat(p(AST_SimpleStatement,e.expression,{body:e.expression}))}).optimize(n);if(f[0].body=s.concat(f[0].body),e.body=f,n.option("conditionals"))switch(f.length){case 1:if(!g(f[0]))break;var S=f[0].expression,d=f[0].body.slice();return f[0]!==o&&f[0]!==a?p(AST_If,e,{condition:p(AST_Binary,e,{operator:"===",left:e.expression,right:S}),body:p(AST_BlockStatement,e,{body:d}),alternative:null}).optimize(n):(S&&d.unshift(p(AST_SimpleStatement,S,{body:S})),d.unshift(p(AST_SimpleStatement,e.expression,{body:e.expression})),p(AST_BlockStatement,e,{body:d}).optimize(n));case 2:if(!member(o,f)||!g(f[1]))break;var A=(d=f[0].body.slice()).length&&m(d[d.length-1],n);if(A&&d.pop(),!all(d,g))break;var h=f[1].body.length&&p(AST_BlockStatement,f[1],f[1]),v=p(AST_If,e,{condition:p(AST_Binary,e,f[0]===o?{operator:"!==",left:e.expression,right:f[1].expression}:{operator:"===",left:e.expression,right:f[0].expression}),body:p(AST_BlockStatement,f[0],{body:d}),alternative:A&&h||null});return!A&&h&&(v=p(AST_BlockStatement,e,{body:[v,h]})),v.optimize(n)}return e;function m(n,t){return n instanceof AST_Break&&t.loopcontrol_target(n)===e}function g(n){var t=!1,i=new TreeWalker((function(e){if(t||e instanceof AST_Lambda||e instanceof AST_SimpleStatement)return!0;m(e,i)&&(t=!0)}));return i.push(e),n.walk(i),!t}function b(e,t){t&&!G(t)?t.body=t.body.concat(e.body):B(n,e,s)}})),e(AST_Try,(function(e,n){if(e.body=O(e.body,n),n.option("dead_code")){if(y(e)&&!(e.bcatch&&e.bcatch.argname&&e.bcatch.argname.match_symbol((function(e){return e instanceof AST_SymbolCatch&&!s(e)}),!0))){var t=[];return e.bcatch&&(B(n,e.bcatch,t),t.forEach((function(e){e instanceof AST_Var&&e.definitions.forEach((function(e){var n=e.name.definition().redefined();n&&(e.name=e.name.clone(),e.name.thedef=n)}))}))),t.unshift(p(AST_BlockStatement,e,e).optimize(n)),e.bfinally&&t.push(p(AST_BlockStatement,e.bfinally,e.bfinally).optimize(n)),p(AST_BlockStatement,e,{body:t}).optimize(n)}if(e.bfinally&&y(e.bfinally)){t=p(AST_BlockStatement,e.bfinally,e.bfinally).optimize(n);if(t=e.body.concat(t),!e.bcatch)return p(AST_BlockStatement,e,{body:t}).optimize(n);e.body=t,e.bfinally=null}}return e})),AST_Const.DEFMETHOD("remove_initializers",ae((function(e,n){return p(AST_Undefined,n).optimize(e)}))),AST_Let.DEFMETHOD("remove_initializers",ae(return_null)),AST_Var.DEFMETHOD("remove_initializers",ae(return_null)),AST_Definitions.DEFMETHOD("to_assignments",(function(){var e=this.definitions.reduce((function(e,n){var t=n.name.definition();if(n.value){var i=p(AST_SymbolRef,n.name,n.name);e.push(p(AST_Assign,n,{operator:"=",left:i,right:n.value})),t.references.push(i)}return t.eliminated++,e}),[]);return 0==e.length?null:d(this,e)})),e(AST_Const,ue),e(AST_Let,ue),e(AST_Call,(function(e,n){var t=e.expression;if(n.option("sequences"))if(t instanceof AST_PropAccess){if((o=le(t))!==t){var r=e.clone();return r.expression=o.expressions.pop(),o.expressions.push(r),o.optimize(n)}}else if(!A(0,t.tail_node())){var o;if((o=le(e))!==e)return o.optimize(n)}if(n.option("unused")&&_e(e,n),n.option("unsafe"))if(w(t))switch(t.name){case"Array":if(1==e.args.length){if((l=e.args[0])instanceof AST_Number)try{var a=l.value;if(a>6)break;for(var s=Array(a),f=0;f<a;f++)s[f]=p(AST_Hole,e);return p(AST_Array,e,{elements:s})}catch(re){AST_Node.warn("Invalid array length: {length} [{file}:{line},{col}]",{length:a,file:e.start.file,line:e.start.line,col:e.start.col});break}if(!l.is_boolean(n)&&!l.is_string(n))break}return p(AST_Array,e,{elements:e.args});case"Object":if(0==e.args.length)return p(AST_Object,e,{properties:[]});break;case"String":if(0==e.args.length)return p(AST_String,e,{value:""});if(e.args.length<=1)return p(AST_Binary,e,{left:e.args[0],operator:"+",right:p(AST_String,e,{value:""})}).optimize(n);break;case"Number":if(0==e.args.length)return p(AST_Number,e,{value:0});if(1==e.args.length)return p(AST_UnaryPrefix,e,{expression:e.args[0],operator:"+"}).optimize(n);case"Boolean":if(0==e.args.length)return p(AST_False,e);if(1==e.args.length)return p(AST_UnaryPrefix,e,{expression:p(AST_UnaryPrefix,e,{expression:e.args[0],operator:"!"}),operator:"!"}).optimize(n);break;case"RegExp":var c=[];if(all(e.args,(function(e){var t=e.evaluate(n);return c.unshift(t),e!==t})))try{return V(n,e,p(AST_RegExp,e,{value:RegExp.apply(RegExp,c)}))}catch(re){AST_Node.warn("Error converting {expr} [{file}:{line},{col}]",{expr:e,file:e.start.file,line:e.start.line,col:e.start.col})}}else if(t instanceof AST_Dot)switch(t.property){case"toString":if(0==e.args.length&&!t.expression.may_throw_on_access(n))return p(AST_Binary,e,{left:p(AST_String,e,{value:""}),operator:"+",right:t.expression}).optimize(n);break;case"join":var u;if(t.expression instanceof AST_Array)if(!(e.args.length>0&&(u=e.args[0].evaluate(n))===e.args[0])){s=[];var l,S=[];return t.expression.elements.forEach((function(t){var i=t.evaluate(n);i!==t?S.push(i):(S.length>0&&(s.push(p(AST_String,e,{value:S.join(u)})),S.length=0),s.push(t))})),S.length>0&&s.push(p(AST_String,e,{value:S.join(u)})),0==s.length?p(AST_String,e,{value:""}):1==s.length?s[0].is_string(n)?s[0]:p(AST_Binary,s[0],{operator:"+",left:p(AST_String,e,{value:""}),right:s[0]}):""==u?(l=s[0].is_string(n)||s[1].is_string(n)?s.shift():p(AST_String,e,{value:""}),s.reduce((function(e,n){return p(AST_Binary,n,{operator:"+",left:e,right:n})}),l).optimize(n)):((G=e.clone()).expression=G.expression.clone(),G.expression.expression=G.expression.expression.clone(),G.expression.expression.elements=s,V(n,e,G))}break;case"charAt":if(e.args.length<2)return(G=p(AST_Sub,e,{expression:t.expression,property:e.args.length?p(AST_Binary,e.args[0],{operator:"|",left:p(AST_Number,e,{value:0}),right:e.args[0]}):p(AST_Number,e,{value:0})})).is_string=return_true,G.optimize(n);break;case"apply":if(2==e.args.length&&e.args[1]instanceof AST_Array)return(K=e.args[1].elements.slice()).unshift(e.args[0]),p(AST_Call,e,{expression:p(AST_Dot,t,{expression:t.expression,property:"call"}),args:K}).optimize(n);break;case"call":var T=t.expression;if(T instanceof AST_SymbolRef&&(T=T.fixed_value()),T instanceof AST_Lambda&&!T.contains_this())return(e.args.length?d(this,[e.args[0],p(AST_Call,e,{expression:t.expression,args:e.args.slice(1)})]):p(AST_Call,e,{expression:t.expression,args:[]})).optimize(n)}if(n.option("unsafe_Function")&&w(t)&&"Function"==t.name){if(0==e.args.length)return p(AST_Function,e,{argnames:[],body:[]}).init_vars(t.scope);if(all(e.args,(function(e){return e instanceof AST_String})))try{var v="n(function("+e.args.slice(0,-1).map((function(e){return e.value})).join(",")+"){"+e.args[e.args.length-1].value+"})",m=parse(v),y={ie8:n.option("ie8")};m.figure_out_scope(y);var b,x=new i(n.options);(m=m.transform(x)).figure_out_scope(y),m.compute_char_frequency(y),m.mangle_names(y),m.walk(new TreeWalker((function(e){return!!b||(e instanceof AST_Lambda?(b=e,!0):void 0)})));v=OutputStream();return AST_BlockStatement.prototype._codegen.call(b,v),e.args=[p(AST_String,e,{value:b.argnames.map((function(e){return e.print_to_string()})).join(",")}),p(AST_String,e.args[e.args.length-1],{value:v.get().replace(/^\{|\}$/g,"")})],e}catch(re){if(!(re instanceof JS_Parse_Error))throw re;AST_Node.warn("Error parsing code passed to new Function [{file}:{line},{col}]",e.args[e.args.length-1].start),AST_Node.warn(re.toString())}}var D=t instanceof AST_SymbolRef?t.fixed_value():t,E=D instanceof AST_Arrow||D instanceof AST_Defun||D instanceof AST_Function,R=E&&D.first_statement(),C=!1,P=E&&all(D.argnames,(function(n,t){if(n instanceof AST_DefaultValue){C=!0;var i=e.args[t];if(i&&!F(i))return!1;var r=!1;if(n.value.walk(new TreeWalker((function(e){return!!r||(e instanceof AST_SymbolRef&&D.find_variable(e.name)===e.definition()?r=!0:void 0)}))),r)return!1;n=n.name}return!(n instanceof AST_Destructured)})),O=P&&n.option("inline")&&!e.is_expr_pure(n);if(O&&R instanceof AST_Return){var B=R.value;if(t===D&&(!B||B.is_constant_expression()&&Q(B)))return d(e,X(B)).optimize(n)}if(E){var q,L=!1;if(O&&!D.uses_arguments&&!D.pinned()&&!(D.name&&D instanceof AST_Function)&&(t===D||!me(n,q=t.definition())&&D.is_constant_expression(_(n)))&&all(e.args,(function(e){return!(e instanceof AST_Spread)}))&&(B=function(e){var t=D.body.length;if(t<2&&(e=Z(e)))return e;if(n.option("inline")<3)return!1;e=null;for(var i=0;i<t;i++){var r=D.body[i];if(r instanceof AST_Var){if((L||!all(r.definitions,(function(e){return!e.value})))&&(L=!0,e))return!1}else{if(r instanceof AST_AsyncDefun||r instanceof AST_Defun||r instanceof AST_EmptyStatement)continue;if(e)return!1;e=r}}return Z(e)}(R))&&!D.contains_this()){var I,M,Y,W=t===D||q.single_use&&q.references.length-q.replaced==1;if(function(){if(C)return;if(L)return;if(n.option("inline")<2&&D.argnames.length)return;if(!D.variables.all((function(e){return e.references.length-e.replaced<2&&e.orig[0]instanceof AST_SymbolFunarg})))return;var t,i=!1,r=[],o=!1,a=!0;if(B.walk(new TreeWalker((function(e,s){if(i)return!0;if(e instanceof AST_Binary&&U[e.operator]||e instanceof AST_Conditional)r=null;else{if(e instanceof AST_Scope)return i=!0;if(a&&e instanceof AST_Symbol&&"await"==e.name){if(is_async(n.find_parent(AST_Scope)))return i=!0;a=!1}if(!(e instanceof AST_SymbolRef))return e.has_side_effects(n)?(s(),o=!0,!0):void 0;var f=e.definition();if(D.variables.get(e.name)!==f)return void(r=null);if(is_defun(f.init))return i=!0;if(z(e,this.parent()))return i=!0;var c=ee(f);if(t<c||(t=c),!r)return;o?r=null:r.push(D.argnames[c])}}))),i)return;var s=e.args.length;if(r&&D.argnames.length>=s){for(s=D.argnames.length;s-- >t&&D.argnames[s]===r.pop(););s++}var f=o&&!r&&n.find_parent(AST_Scope);return s<=t||all(e.args.slice(t,s),f?function(e){return e.is_constant_expression(f)}:function(e){return!e.has_side_effects(n)})}()){var K=e.args.slice(),$=[];K.push(B.clone(!0).transform(new TreeTransformer((function(n){if(n instanceof AST_SymbolRef){var t=n.definition();if(D.variables.get(n.name)!==t)return $.push(n),n;var i=ee(t),r=K[i];if(!r)return p(AST_Undefined,e);K[i]=null;var o=this.parent();return o?h(0,o,n,r):r}}))));var G=d(e,K.filter((function(e){return e}))).optimize(n);if(G=h(0,n.parent(),n.self(),G),W||j(G,e)===G)return $.forEach((function(e){var n=e.definition();n.references.push(e),W?n.replaced++:n.single_use=!1})),G}if(W&&function(){var e,i=Object.create(null),r=0;Y=n.self();do{if(Y.variables&&Y.variables.each((function(e){i[e.name]=!0})),e=Y,(Y=n.parent(r++))instanceof AST_DWLoop)M=[];else if(Y instanceof AST_For){if(Y.init===e)continue;M=[]}else if(Y instanceof AST_ForIn){if(Y.init===e)continue;if(Y.object===e)continue;M=[]}else if(Y instanceof AST_SymbolRef&&Y.fixed_value()instanceof AST_Scope)return!1}while(!(Y instanceof AST_Scope));if(!(I=Y.body.indexOf(e)+1))return!1;if(!Q(D))return!1;var o=t!==D||D.parent_scope.resolve()===Y;Y instanceof AST_Toplevel&&(n.toplevel.vars?i.arguments=!0:o=!1);var a=n.option("inline"),s=Object.create(i);return!!function(e,n,t){for(var i=0;i<D.argnames.length;i++){var r=D.argnames[i];if(!r.__unused){if(r instanceof AST_DefaultValue&&(r=r.name),!t||ne(e,r.name))return!1;n[r.name]=!0,M&&M.push(r.definition())}}return!0}(i,s,a>=2&&o)&&(!!function(e,n,t){for(var i=0;i<D.body.length;i++){var r=D.body[i];if(is_defun(r)){if(!t||ne(n,r.name.name))return!1;if(!all(r.enclosed,(function(n){return n.scope===r||!e[n.name]})))return!1}else if(r instanceof AST_Var){if(!t)return!1;for(var o=r.definitions.length;--o>=0;){var a=r.definitions[o].name;if(ne(e,a.name))return!1;M&&M.push(a.definition())}}}return!0}(i,s,a>=3&&o)&&(!M||0==M.length||!ye(D,M)))}()){D._squeezed=!0,t!==D&&(D.parent_scope=t.scope);G=d(e,function(){var n=[],t=[];(function(n,t){for(var i=D.argnames.length,r=e.args.length;--r>=i;)t.push(e.args[r]);for(r=i;--r>=0;){var o=D.argnames[r],a=e.args[r];if(o instanceof AST_DefaultValue&&(a=a?d(e,[a,o.value]):o.value,o=o.name),o.__unused||Y.var_names()[o.name])a&&t.push(a);else{var s=p(AST_SymbolVar,o,o);o.definition().orig.push(s),!a&&M&&(a=p(AST_Undefined,e)),"__unused"in o?(ie(n,t,s),a&&t.push(a)):ie(n,t,s,a)}}n.reverse(),t.reverse()})(n,t),function(e,n){for(var t=n.length,i=0;i<D.body.length;i++){var r=D.body[i];if(r instanceof AST_Var)for(var o=0;o<r.definitions.length;o++){var a=r.definitions[o],s=a.name,f=s.definition().redefined();if(f&&((s=s.clone()).thedef=f),ie(e,n,s,a.value),M&&all(D.argnames,(function(e){return e instanceof AST_DefaultValue&&(e=e.name),e.name!=s.name}))){var c=D.variables.get(s.name),u=p(AST_SymbolRef,s,s);c.references.push(u),n.splice(t++,0,p(AST_Assign,a,{operator:"=",left:u,right:p(AST_Undefined,s)}))}}}}(n,t),t.push(B);var i=D.body.filter((function(e){if(is_defun(e)){var n=e.name.definition();return Y.functions.set(n.name,n),Y.variables.set(n.name,n),Y.enclosed.push(n),Y.var_names()[n.name]=!0,!0}}));i.unshift(I,0),n.length&&i.push(p(AST_Var,D,{definitions:n}));return[].splice.apply(Y.body,i),D.enclosed.forEach((function(e){Y.var_names()[e.name]||(Y.enclosed.push(e),Y.var_names()[e.name]=!0)})),t}()).optimize(n);return h(0,n.parent(),n.self(),G)}}if(n.option("side_effects")&&P&&all(D.body,g)&&(D!==t||te(D,n))&&!(D instanceof AST_Arrow&&D.value))return d(e,X()).optimize(n)}if(n.option("drop_console")&&t instanceof AST_PropAccess){for(var J=t.expression;J.expression;)J=J.expression;if(w(J)&&"console"==J.name)return p(AST_Undefined,e).optimize(n)}return n.option("negate_iife")&&n.parent()instanceof AST_SimpleStatement&&k(e)?e.negate(n,!0):H(n,e);function X(n){var t=e.args.map((function(e){return e instanceof AST_Spread?p(AST_Array,e,{elements:[e]}):e}));return D.argnames.forEach((function(e,n){e instanceof AST_DefaultValue&&t.push(e.value)})),t.push(n||p(AST_Undefined,e)),t}function Q(e){if(!is_async(Y||n.find_parent(AST_Scope)))return!0;var t=!0,i=new TreeWalker((function(e){if(!t)return!0;if(e instanceof AST_Scope){if(e===D)return;if(e instanceof AST_Arrow)for(var n=0;t&&n<e.argnames.length;n++)e.argnames[n].walk(i);else is_defun(e)&&"await"==e.name.name&&(t=!1);return!0}e instanceof AST_Symbol&&"await"==e.name&&e!==D.name&&(t=!1)}));return e.walk(i),t}function Z(n){return n?n instanceof AST_Return?n.value||p(AST_Undefined,e):n instanceof AST_SimpleStatement?p(AST_UnaryPrefix,n,{operator:"void",expression:n.body}):void 0:p(AST_Undefined,e)}function ee(e){for(var n=D.argnames.length;--n>=0;)if(D.argnames[n].definition()===e)return n}function ne(e,n){return e[n]||N[n]||Y.var_names()[n]}function ie(n,t,i,r){var o=i.definition();if(Y.variables.set(i.name,o),Y.enclosed.push(o),Y.var_names()[i.name]||(Y.var_names()[i.name]=!0,n.push(p(AST_VarDef,i,{name:i,value:null}))),r){var a=p(AST_SymbolRef,i,i);o.references.push(a),t.push(p(AST_Assign,e,{operator:"=",left:a,right:r}))}}})),e(AST_New,(function(e,n){if(n.option("sequences")){var t=le(e);if(t!==e)return t.optimize(n)}if(n.option("unsafe")){var i=e.expression;if(w(i))switch(i.name){case"Object":case"RegExp":case"Function":case"Error":case"Array":return p(AST_Call,e,e).transform(n)}}return e})),e(AST_Sequence,(function(e,n){var t=function(){if(!n.option("side_effects"))return e.expressions;var t=[],i=first_in_statement(n),r=e.expressions.length-1;return e.expressions.forEach((function(e,o){o<r&&(e=e.drop_side_effect_free(n,i)),e&&(v(t,e),i=!1)})),t}(),i=t.length-1;return function(){if(!n.option("conditionals"))return;for(var e=1;e<i;e++){var r=t[e-1];if(r instanceof AST_Assign&&("="==r.operator&&r.left instanceof AST_SymbolRef)){var o=r.left.definition(),a=Se(n,o,r.right,t[e]);a&&(r.right=a,t.splice(e,1),i--)}}}(),function(){if(!n.option("side_effects"))return;for(;i>0&&F(t[i],n);)i--;i<t.length-1&&(t[i]=p(AST_UnaryPrefix,e,{operator:"void",expression:t[i]}),t.length=i+1)}(),0==i?((e=h(0,n.parent(),n.self(),t[0]))instanceof AST_Sequence||(e=e.optimize(n)),e):(e.expressions=t,e)})),e(AST_UnaryPostfix,(function(e,n){if(n.option("sequences")){var t=le(e);if(t!==e)return t.optimize(n)}return H(n,e)}));var pe=makePredicate("+ -"),de=makePredicate("* / %");e(AST_UnaryPrefix,(function(e,n){var t,i=e.operator,r=e.expression;if(n.option("evaluate")&&"delete"==i&&!(r instanceof AST_SymbolRef||r instanceof AST_PropAccess||(t=r,t instanceof AST_Infinity||t instanceof AST_NaN||t instanceof AST_Undefined)))return r instanceof AST_Sequence?((r=r.expressions.slice()).push(p(AST_True,e)),d(e,r).optimize(n)):d(e,[r,p(AST_True,e)]).optimize(n);if(n.option("sequences")&&("typeof"!=i||!w(r.tail_node()))){var o=le(e);if(o!==e)return o.optimize(n)}if(n.option("side_effects")&&"void"==i)return(r=r.drop_side_effect_free(n))?(e.expression=r,e):p(AST_Undefined,e).optimize(n);if(n.option("booleans")){if("!"==i&&r.is_truthy())return d(e,[r,p(AST_False,e)]).optimize(n);if(n.in_boolean_context())switch(i){case"!":if(r instanceof AST_UnaryPrefix&&"!"==r.operator)return r.expression;r instanceof AST_Binary&&(e=V(n,e,r.negate(n,first_in_statement(n))));break;case"typeof":AST_Node.warn("Boolean expression always true [{file}:{line},{col}]",e.start);var a=[p(AST_True,e)];return r instanceof AST_SymbolRef&&s(r)||a.unshift(r),d(e,a).optimize(n)}}return"-"==i&&r instanceof AST_Infinity&&(r=r.transform(n)),n.option("evaluate")&&r instanceof AST_Binary&&pe[i]&&de[r.operator]&&(r.left.is_constant()||!r.right.has_side_effects(n))?p(AST_Binary,e,{operator:r.operator,left:p(AST_UnaryPrefix,r.left,{operator:i,expression:r.left}),right:r.right}):"-"==i&&(r instanceof AST_Number||r instanceof AST_Infinity)?e:H(n,e)})),AST_Binary.DEFMETHOD("lift_sequences",(function(e){if(this.left instanceof AST_PropAccess){if(!(this.left.expression instanceof AST_Sequence))return this;var n=this.left.expression.expressions.slice();return(t=this.clone()).left=t.left.clone(),t.left.expression=n.pop(),n.push(t),d(this,n)}if(this.left instanceof AST_Sequence){n=this.left.expressions.slice();return(t=this.clone()).left=n.pop(),n.push(t),d(this,n)}if(this.right instanceof AST_Sequence){if(this.left.has_side_effects(e))return this;for(var t,i="="==this.operator&&this.left instanceof AST_SymbolRef,r=(n=this.right.expressions).length-1,o=0;o<r&&(i||!n[o].has_side_effects(e));o++);if(o==r)return n=n.slice(),(t=this.clone()).right=n.pop(),n.push(t),d(this,n);if(o>0)return(t=this.clone()).right=d(this.right,n.slice(o)),(n=n.slice(0,o)).push(t),d(this,n)}return this}));var Te=makePredicate("indexOf lastIndexOf"),Ae=makePredicate("== === != !== * & | ^");function he(e){return e instanceof AST_Assign?"="==e.operator&&he(e.right):e instanceof AST_Sequence?he(e.tail_node()):e instanceof AST_SymbolRef?he(e.fixed_value()):e instanceof AST_Array||e instanceof AST_Lambda||e instanceof AST_New||e instanceof AST_Object}function ve(e,n){return n instanceof AST_Dot?ve(e,n.expression):n instanceof AST_Sub?ve(e,n.expression)&&ve(e,n.property):n instanceof AST_Symbol||!n.has_side_effects(e)}function me(e,n){var t=0,i=e.self();do{if(i instanceof AST_Lambda&&i.name&&i.name.definition()===n)return i}while(i=e.parent(t++))}function ge(e,n){return e instanceof AST_SymbolRef||e.TYPE===n.TYPE}function ye(e,n){var t=!1,i=new TreeWalker((function(e){return!!t||(e instanceof AST_SymbolRef&&member(e.definition(),n)?t=!0:void 0)})),r=new TreeWalker((function(n){if(t)return!0;if(n instanceof AST_Scope&&n!==e){var o=r.parent();if(o instanceof AST_Call&&o.expression===n)return;return n.walk(i),!0}}));return e.walk(r),t}e(AST_Binary,(function(e,n){function t(){return e.left.is_constant()||e.right.is_constant()||!e.left.has_side_effects(n)&&!e.right.has_side_effects(n)}function i(n){if(t()){n&&(e.operator=n);var i=e.left;e.left=e.right,e.right=i}}function r(){var t=e.right;e.left=p(AST_Binary,e,{operator:e.operator,left:e.left,right:t.left,start:e.left.start,end:t.left.end}),e.right=t.right,e.left=e.left.transform(n)}if(!Ae[e.operator]||!e.right.is_constant()||e.left.is_constant()||e.left instanceof AST_Binary&&PRECEDENCE[e.left.operator]>=PRECEDENCE[e.operator]||i(),n.option("sequences")){var o=e.lift_sequences(n);if(o!==e)return o.optimize(n)}if(n.option("assignments")&&U[e.operator]){var a=e.right;if(e.left instanceof AST_SymbolRef&&a instanceof AST_Assign&&"="==a.operator&&e.left.equivalent_to(a.left))return e.right=a.right,a.right=e,a}if(n.option("comparisons"))switch(e.operator){case"===":case"!==":if(F(e.left,n)&&e.right.is_defined(n))return AST_Node.warn("Expression always defined [{file}:{line},{col}]",e.start),d(e,[e.right,p("==="==e.operator?AST_False:AST_True,e)]).optimize(n);var s=!0;(e.left.is_string(n)&&e.right.is_string(n)||e.left.is_number(n)&&e.right.is_number(n)||e.left.is_boolean(n)&&e.right.is_boolean(n)||ve(n,e.left)&&e.left.equivalent_to(e.right))&&(e.operator=e.operator.slice(0,2));case"==":case"!=":if(!s&&F(e.left,n))e.left=p(AST_Null,e.left);else if(n.option("typeofs")&&e.left instanceof AST_String&&"undefined"==e.left.value&&e.right instanceof AST_UnaryPrefix&&"typeof"==e.right.operator){var f=e.right.expression;(f instanceof AST_SymbolRef?!f.is_declared(n):f instanceof AST_PropAccess&&n.option("ie8"))||(e.right=f,e.left=p(AST_Undefined,e.left).optimize(n),2==e.operator.length&&(e.operator+="="))}else if(e.left instanceof AST_SymbolRef&&e.right instanceof AST_SymbolRef&&e.left.definition()===e.right.definition()&&he(e.left))return p("="==e.operator[0]?AST_True:AST_False,e).optimize(n);break;case"&&":case"||":if((g=e.left).operator==e.operator&&(g=g.right),g instanceof AST_Binary&&g.operator==("&&"==e.operator?"!==":"===")&&e.right instanceof AST_Binary&&g.operator==e.right.operator&&(F(g.left,n)&&e.right.left instanceof AST_Null||g.left instanceof AST_Null&&F(e.right.left,n))&&!g.right.has_side_effects(n)&&g.right.equivalent_to(e.right.right)){var c=p(AST_Binary,e,{operator:g.operator.slice(0,-1),left:p(AST_Null,e),right:g.right});return g!==e.left&&(c=p(AST_Binary,e,{operator:e.operator,left:e.left.left,right:c})),c}}var u=n.option("booleans")&&n.in_boolean_context();if(u)switch(e.operator){case"+":var l=e.left.evaluate(n),_=e.right.evaluate(n);if(l&&"string"==typeof l)return AST_Node.warn("+ in boolean context always true [{file}:{line},{col}]",e.start),d(e,[e.right,p(AST_True,e)]).optimize(n);if(_&&"string"==typeof _)return AST_Node.warn("+ in boolean context always true [{file}:{line},{col}]",e.start),d(e,[e.left,p(AST_True,e)]).optimize(n);break;case"==":if(e.left instanceof AST_String&&""==e.left.value&&e.right.is_string(n))return p(AST_UnaryPrefix,e,{operator:"!",expression:e.right}).optimize(n);break;case"!=":if(e.left instanceof AST_String&&""==e.left.value&&e.right.is_string(n))return e.right.optimize(n)}var S=n.parent();if(n.option("comparisons")&&e.is_boolean(n)){if(!(S instanceof AST_Binary)||S instanceof AST_Assign){var T=V(n,e,p(AST_UnaryPrefix,e,{operator:"!",expression:e.negate(n,first_in_statement(n))}));if(T!==e)return T}switch(e.operator){case">":i("<");break;case">=":i("<=")}}if(n.option("conditionals")&&U[e.operator]&&e.right instanceof AST_Binary&&e.operator==e.right.operator&&r(),n.option("strings")&&"+"==e.operator){if(e.right instanceof AST_String&&""==e.right.value&&e.left.is_string(n))return e.left.optimize(n);if(e.left instanceof AST_String&&""==e.left.value&&e.right.is_string(n))return e.right.optimize(n);if(e.left instanceof AST_Binary&&"+"==e.left.operator&&e.left.left instanceof AST_String&&""==e.left.left.value&&e.right.is_string(n))return e.left=e.left.right,e.optimize(n);e.right instanceof AST_Binary&&e.operator==e.right.operator&&(e.left.is_string(n)&&e.right.is_string(n)||e.right.left.is_string(n)&&(e.left.is_constant()||!e.right.right.has_side_effects(n)))&&r()}if(n.option("evaluate")){var A=!0;switch(e.operator){case"&&":if(!(l=R(e.left)))return AST_Node.warn("Condition left of && always false [{file}:{line},{col}]",e.start),h(0,S,n.self(),e.left).optimize(n);if(!(l instanceof AST_Node))return AST_Node.warn("Condition left of && always true [{file}:{line},{col}]",e.start),d(e,[e.left,e.right]).optimize(n);if(_=e.right.evaluate(n)){if(!(_ instanceof AST_Node)&&(u||"&&"==S.operator&&S.left===n.self()))return AST_Node.warn("Dropping side-effect-free && [{file}:{line},{col}]",e.start),e.left.optimize(n)}else{if(u)return AST_Node.warn("Boolean && always false [{file}:{line},{col}]",e.start),d(e,[e.left,p(AST_False,e)]).optimize(n);e.falsy=!0}if("||"==e.left.operator)if(!(v=e.left.right.evaluate(n,!0)))return p(AST_Conditional,e,{condition:e.left.left,consequent:e.right,alternative:e.left.right}).optimize(n);break;case"||":var v;if(!(l=R(e.left)))return AST_Node.warn("Condition left of || always false [{file}:{line},{col}]",e.start),d(e,[e.left,e.right]).optimize(n);if(!(l instanceof AST_Node))return AST_Node.warn("Condition left of || always true [{file}:{line},{col}]",e.start),h(0,S,n.self(),e.left).optimize(n);if(_=e.right.evaluate(n)){if(!(_ instanceof AST_Node)){if(u)return AST_Node.warn("Boolean || always true [{file}:{line},{col}]",e.start),d(e,[e.left,p(AST_True,e)]).optimize(n);e.truthy=!0}}else if(u||"||"==S.operator&&S.left===n.self())return AST_Node.warn("Dropping side-effect-free || [{file}:{line},{col}]",e.start),e.left.optimize(n);if("&&"==e.left.operator)if((v=e.left.right.is_truthy()||e.left.right.evaluate(n,!0))&&!(v instanceof AST_Node))return p(AST_Conditional,e,{condition:e.left.left,consequent:e.left.right,alternative:e.right}).optimize(n);break;case"+":if(e.left instanceof AST_Constant&&e.right instanceof AST_Binary&&"+"==e.right.operator&&e.right.left instanceof AST_Constant&&e.right.is_string(n)&&(e=p(AST_Binary,e,{operator:"+",left:p(AST_String,e.left,{value:""+e.left.value+e.right.left.value,start:e.left.start,end:e.right.left.end}),right:e.right.right})),e.right instanceof AST_Constant&&e.left instanceof AST_Binary&&"+"==e.left.operator&&e.left.right instanceof AST_Constant&&e.left.is_string(n)&&(e=p(AST_Binary,e,{operator:"+",left:e.left.left,right:p(AST_String,e.right,{value:""+e.left.right.value+e.right.value,start:e.left.right.start,end:e.right.end})})),e.right instanceof AST_UnaryPrefix&&"-"==e.right.operator&&e.left.is_number(n)){e=p(AST_Binary,e,{operator:"-",left:e.left,right:e.right.expression});break}if(e.left instanceof AST_UnaryPrefix&&"-"==e.left.operator&&t()&&e.right.is_number(n)){e=p(AST_Binary,e,{operator:"-",left:e.right,right:e.left.expression});break}if(n.option("unsafe_math")&&e.left instanceof AST_Binary&&PRECEDENCE[e.left.operator]==PRECEDENCE[e.operator]&&e.right.is_constant()&&(e.right.is_boolean(n)||e.right.is_number(n))&&e.left.is_number(n)&&!e.left.right.is_constant()&&(e.left.left.is_boolean(n)||e.left.left.is_number(n))){e=p(AST_Binary,e,{operator:e.left.operator,left:p(AST_Binary,e,{operator:e.operator,left:e.right,right:e.left.left}),right:e.left.right});break}case"-":if(e.right instanceof AST_UnaryPrefix&&"-"==e.right.operator&&e.left.is_number(n)&&e.right.expression.is_number(n)){e=p(AST_Binary,e,{operator:"+",left:e.left,right:e.right.expression});break}case"*":case"/":A=n.option("unsafe_math"),"+"!=e.operator&&["left","right"].forEach((function(t){var i=e[t];if(i instanceof AST_UnaryPrefix&&"+"==i.operator){var r=i.expression;(r.is_boolean(n)||r.is_number(n)||r.is_string(n))&&(e[t]=r)}}));case"&":case"|":case"^":if("-"!=e.operator&&"/"!=e.operator&&(e.left.is_boolean(n)||e.left.is_number(n))&&(e.right.is_boolean(n)||e.right.is_number(n))&&t()&&!(e.left instanceof AST_Binary&&e.left.operator!=e.operator&&PRECEDENCE[e.left.operator]>=PRECEDENCE[e.operator])){var m=p(AST_Binary,e,{operator:e.operator,left:e.right,right:e.left});e=e.right instanceof AST_Constant&&!(e.left instanceof AST_Constant)?V(n,m,e):V(n,e,m)}if(!A||!e.is_number(n))break;if(!(e.right instanceof AST_Binary&&"%"!=e.right.operator&&PRECEDENCE[e.right.operator]==PRECEDENCE[e.operator]&&e.right.is_number(n)&&("+"!=e.operator||e.right.left.is_boolean(n)||e.right.left.is_number(n)))||"-"==e.operator&&e.left.is_negative_zero()||!e.right.left.is_constant_expression()&&e.right.right.has_side_effects(n)||"+"!=(e=p(AST_Binary,e,{operator:D(e.operator,e.right.operator),left:p(AST_Binary,e.left,{operator:e.operator,left:e.left,right:e.right.left,start:e.left.start,end:e.right.left.end}),right:e.right.right})).operator||e.right.is_boolean(n)||e.right.is_number(n)||(e.right=p(AST_UnaryPrefix,e.right,{operator:"+",expression:e.right})),e.right instanceof AST_Constant&&e.left instanceof AST_Binary&&"%"!=e.left.operator&&PRECEDENCE[e.left.operator]==PRECEDENCE[e.operator]&&e.left.is_number(n))if(e.left.left instanceof AST_Constant){var g=E(e.left,e.operator,e.left.left,e.right,e.left.left.start,e.right.end);e=E(e,e.left.operator,H(n,g),e.left.right)}else if(e.left.right instanceof AST_Constant){var y=D(e.left.operator,e.operator),b=H(n,E(e.left,y,e.left.right,e.right));!b.is_constant()||"-"==e.left.operator&&0!=e.right.value&&0==+b.value&&e.left.left.is_negative_zero()||(e=E(e,e.left.operator,e.left.left,b))}}if(!(S instanceof AST_UnaryPrefix&&"delete"==S.operator)){if(e.left instanceof AST_Number&&!e.right.is_constant())switch(e.operator){case"+":if(0==e.left.value){if(e.right.is_boolean(n))return p(AST_UnaryPrefix,e,{operator:"+",expression:e.right}).optimize(n);if(e.right.is_number(n)&&!e.right.is_negative_zero())return e.right}break;case"*":if(1==e.left.value)return e.right.is_number(n)?e.right:p(AST_UnaryPrefix,e,{operator:"+",expression:e.right}).optimize(n)}if(e.right instanceof AST_Number&&!e.left.is_constant())switch(e.operator){case"+":if(0==e.right.value){if(e.left.is_boolean(n))return p(AST_UnaryPrefix,e,{operator:"+",expression:e.left}).optimize(n);if(e.left.is_number(n)&&!e.left.is_negative_zero())return e.left}break;case"-":if(0==e.right.value)return e.left.is_number(n)?e.left:p(AST_UnaryPrefix,e,{operator:"+",expression:e.left}).optimize(n);break;case"/":if(1==e.right.value)return e.left.is_number(n)?e.left:p(AST_UnaryPrefix,e,{operator:"+",expression:e.left}).optimize(n)}}}if(n.option("typeofs"))switch(e.operator){case"&&":oe(e.left,e.right,null);break;case"||":oe(e.left,null,e.right)}if(n.option("unsafe")){var x=N(e.right);if(u&&x&&("=="==e.operator||"!="==e.operator)&&e.left instanceof AST_Number&&0==e.left.value)return("=="==e.operator?p(AST_UnaryPrefix,e,{operator:"!",expression:e.right}):e.right).optimize(n);var k=N(e.left);if(n.option("comparisons")&&function(){switch(e.operator){case"<=":return x&&e.left instanceof AST_Number&&0==e.left.value;case"<":if(k&&e.right instanceof AST_Number&&0==e.right.value)return!0;case"==":case"!=":return!!x&&(e.left instanceof AST_Number&&-1==e.left.value||e.left instanceof AST_UnaryPrefix&&"-"==e.left.operator&&e.left.expression instanceof AST_Number&&1==e.left.expression.value)}}()){var w=p(AST_UnaryPrefix,e,{operator:"!",expression:p(AST_UnaryPrefix,e,{operator:"~",expression:k?e.left:e.right})});switch(e.operator){case"<":if(k)break;case"<=":case"!=":w=p(AST_UnaryPrefix,e,{operator:"!",expression:w})}return w.optimize(n)}}return H(n,e);function D(e,n){switch(e){case"-":return"+"==n?"-":"+";case"/":return"*"==n?"/":"*";default:return n}}function E(e,t,i,r,o,a){return"+"==t&&(i.is_boolean(n)||i.is_number(n)||(i=p(AST_UnaryPrefix,i,{operator:"+",expression:i})),r.is_boolean(n)||r.is_number(n)||(r=p(AST_UnaryPrefix,r,{operator:"+",expression:r}))),p(AST_Binary,e,{operator:t,left:i,right:r,start:o,end:a})}function R(e){return!!e.truthy||!e.falsy&&(!!e.is_truthy()||e.evaluate(n,!0))}function N(e){return"Call"==e.TYPE&&e.expression instanceof AST_Dot&&Te[e.expression.property]}})),e(AST_SymbolRef,(function(e,n){if(!n.option("ie8")&&w(e)&&(!e.scope.resolve().uses_with||!n.find_parent(AST_With)))switch(e.name){case"undefined":return p(AST_Undefined,e).optimize(n);case"NaN":return p(AST_NaN,e).optimize(n);case"Infinity":return p(AST_Infinity,e).optimize(n)}var t=n.parent();if(n.option("reduce_vars")&&z(n.self(),t)!==n.self()){var i=e.definition(),r=e.fixed_value(),a=i.single_use&&!(t instanceof AST_Call&&t.is_expr_pure(n));if(a)if(r instanceof AST_Lambda){if(i.scope===e.scope.resolve()&&!i.in_loop||n.option("reduce_funcs")&&1!=i.escaped.depth&&!r.inlined)if(me(n,i))a=!1;else if(r.name&&r.name.definition()!==i)a=!1;else if(r.parent_scope!==e.scope.resolve()||o(i)){if("f"==(a=r.is_constant_expression(e.scope))){var s=e.scope;do{(is_defun(s)||is_function(s))&&(s.inlined=!0)}while(s=s.parent_scope)}}else r.name&&"await"==r.name.name&&is_async(r)&&(a=!1);else a=!1;a&&(r.parent_scope=e.scope)}else r&&r.is_constant_expression()||(a=!1);if(a){if(i.single_use=!1,r._squeezed=!0,r.single_use=!0,r instanceof AST_AsyncDefun?(r=p(AST_AsyncFunction,r,r)).name=p(AST_SymbolLambda,r.name,r.name):r instanceof AST_Defun&&((r=p(AST_Function,r,r)).name=p(AST_SymbolLambda,r.name,r.name)),r instanceof AST_Lambda){s=e.scope.resolve();r.enclosed.forEach((function(e){r.variables.has(e.name)||s.var_names()[e.name]||(s.enclosed.push(e),s.var_names()[e.name]=!0)}))}if(i.recursive_refs>0){var f=(v=r.clone(!0)).name.definition(),c=v.variables.get(v.name.name),u=c&&c.orig[0];u instanceof AST_SymbolLambda||((u=p(AST_SymbolLambda,v.name,v.name)).scope=v,v.name=u,(c=v.def_function(u)).recursive_refs=i.recursive_refs),v.walk(new TreeWalker((function(e){if(e instanceof AST_SymbolRef){var n=e.definition();if(n===f)e.thedef=c,c.references.push(e);else{n.single_use=!1;var t=e.fixed_value();if(!(t instanceof AST_Lambda))return;if(!t.name)return;if(t.name.definition()!==n)return;if(n.scope!==t.name.scope)return;if(r.variables.get(t.name.name)!==n)return;t.name=t.name.clone();var i=v.variables.get(t.name.name)||v.def_function(t.name);e.thedef=i,i.references.push(e)}}})))}else(v=r.optimize(n))===r&&(v=v.transform(new TreeTransformer((function(e,n){return e instanceof AST_Scope||n(e=e.clone(),this),e}))));return i.replaced++,v}var l=e.fixed!==i.fixed;if(r&&(l||!1!==i.should_replace)){var _;if(r instanceof AST_This)!o(i)&&m(i)&&(_=r);else{var S=r.evaluate(n,!0);S!==r&&"function"!=typeof S&&("object"!=typeof S||S instanceof RegExp&&n.option("unsafe_regexp")&&!i.cross_loop&&m(i))&&(_=T(S,r))}if(_){if(!l&&void 0===i.should_replace){var d=_.optimize(n).print_to_string().length;g(r)||(d=Math.min(d,r.print_to_string().length));var A=i.name.length;if(n.option("unused")&&!n.exposed(i))A+=(A+2+d)/(i.references.length-i.replaced-i.assignments);var h=d-Math.floor(A);i.should_replace=h<n.eval_threshold}var v;if(l||i.should_replace)return g(r)?(v=_.optimize(n))===_&&(v=v.clone(!0)):(v=j(_.optimize(n),r))!==_&&v!==r||(v=v.clone(!0)),i.replaced++,v}}}return e;function m(e){var n=e.scope.resolve();return all(e.references,(function(e){return n===e.scope.resolve()}))}function g(e){var n;return e.walk(new TreeWalker((function(e){if(e instanceof AST_SymbolRef&&(n=!0),n)return!0}))),n}})),e(AST_Undefined,(function(e,n){if(n.option("unsafe_undefined")){var t=_(n).find_variable("undefined");if(t){var i=p(AST_SymbolRef,e,{name:"undefined",scope:t.scope,thedef:t});return i.is_undefined=!0,i}}var r=z(n.self(),n.parent());return r&&ge(r,e)?e:p(AST_UnaryPrefix,e,{operator:"void",expression:p(AST_Number,e,{value:0})})})),e(AST_Infinity,(function(e,n){var t=z(n.self(),n.parent());return t&&ge(t,e)?e:!n.option("keep_infinity")||t||_(n).find_variable("Infinity")?p(AST_Binary,e,{operator:"/",left:p(AST_Number,e,{value:1}),right:p(AST_Number,e,{value:0})}):e})),e(AST_NaN,(function(e,n){var t=z(n.self(),n.parent());return t&&ge(t,e)?e:t||_(n).find_variable("NaN")?p(AST_Binary,e,{operator:"/",left:p(AST_Number,e,{value:0}),right:p(AST_Number,e,{value:0})}):e}));var be=makePredicate("+ - * / % >> << >>> | ^ &"),xe=makePredicate("* | ^ &");function ke(e,n){if(e instanceof AST_SymbolRef&&(e=e.fixed_value()),!e)return!1;if(!(e instanceof AST_Lambda))return!0;var t=n.parent();return"Call"!=t.TYPE||(t.expression!==n.self()||!e.contains_this())}e(AST_Assign,(function(e,n){if(n.option("dead_code"))if(e.left instanceof AST_PropAccess){if("="==e.operator){if(e.__drop){var t=[e.left.expression];return e.left instanceof AST_Sub&&t.push(e.left.property),t.push(e.right),d(e,t).optimize(n)}if(e.left.equivalent_to(e.right)&&!e.left.has_side_effects(n))return e.right;var i=e.left.expression;if(i instanceof AST_Lambda||!n.has_directive("use strict")&&i instanceof AST_Constant&&!i.may_throw_on_access(n))return e.left instanceof AST_Dot?e.right:d(e,[e.left.property,e.right]).optimize(n)}}else if(e.left instanceof AST_SymbolRef&&all(e.left.definition().orig,(function(e){return!(e instanceof AST_SymbolConst)}))){var r;if("="==e.operator&&e.left.equivalent_to(e.right)&&!((r=n.parent())instanceof AST_UnaryPrefix&&"delete"==r.operator))return e.right;if(e.left.is_immutable())return T();var o,a=e.left.definition(),s=a.scope.resolve(),f=s===n.find_parent(AST_Lambda),c=0;r=e;do{if(o=r,(r=n.parent(c++))instanceof AST_Assign){var u=!1;if(r.left.match_symbol((function(e){if(e instanceof AST_PropAccess)return!0;if(!u&&e instanceof AST_SymbolRef&&e.definition()===a){if(S(c,r))return!0;a.fixed=!1,u=!0}})))break;if(u)return T()}else{if(r instanceof AST_Exit){if(!f)break;if(S(c,r))break;if(ye(s,[a]))break;return a.fixed=!1,T()}if(r instanceof AST_VarDef){if(!(r.name instanceof AST_SymbolDeclaration))continue;if(r.name.definition()!==a)continue;if(S(c,r))break;return a.fixed=!1,T()}}}while(r instanceof AST_Binary&&r.right===o||r instanceof AST_Sequence&&r.tail_node()===o||r instanceof AST_UnaryPrefix)}if(n.option("sequences")){var l=e.lift_sequences(n);if(l!==e)return l.optimize(n)}if(n.option("assignments")){if("="==e.operator&&e.left instanceof AST_SymbolRef&&e.right instanceof AST_Binary){if(e.right.left instanceof AST_SymbolRef&&e.right.left.name==e.left.name&&be[e.right.operator])return p(AST_Assign,e,{operator:e.right.operator+"=",left:e.left,right:e.right.right}).optimize(n);if(e.right.right instanceof AST_SymbolRef&&e.right.right.name==e.left.name&&xe[e.right.operator]&&!e.right.left.has_side_effects(n))return p(AST_Assign,e,{operator:e.right.operator+"=",left:e.left,right:e.right.left}).optimize(n)}if(("-="==e.operator||"+="==e.operator&&(e.left.is_boolean(n)||e.left.is_number(n)))&&e.right instanceof AST_Number&&1==e.right.value){var _=e.operator.slice(0,-1);return p(AST_UnaryPrefix,e,{operator:_+_,expression:e.left})}}return H(n,e);function S(t,i){var r=e.right;e.right=p(AST_Null,r);var o,a=i.may_throw(n);for(e.right=r;o=n.parent(t++);){if(o===s)return!1;if(o instanceof AST_Try){if(o.bfinally)return!0;if(a&&o.bcatch)return!0}}}function T(){return("="!=e.operator?p(AST_Binary,e,{operator:e.operator.slice(0,-1),left:e.left,right:e.right}):h(0,n.parent(),e,e.right)).optimize(n)}})),e(AST_Conditional,(function(e,n){if(n.option("sequences")&&e.condition instanceof AST_Sequence){var t=e.condition.expressions.slice();return e.condition=t.pop(),t.push(e),d(e,t)}if(!n.option("conditionals"))return e;var i=e.condition.is_truthy()||e.condition.evaluate(n,!0);if(!i)return AST_Node.warn("Condition always false [{file}:{line},{col}]",e.start),d(e,[e.condition,e.alternative]).optimize(n);if(!(i instanceof AST_Node))return AST_Node.warn("Condition always true [{file}:{line},{col}]",e.start),d(e,[e.condition,e.consequent]).optimize(n);var r=i.negate(n,first_in_statement(n));V(n,i,r)===r&&(e=p(AST_Conditional,e,{condition:r,consequent:e.alternative,alternative:e.consequent}),r=i,i=e.condition);var o=e.consequent,a=e.alternative;if(ve(n,i)){if(i.equivalent_to(o))return p(AST_Binary,e,{operator:"||",left:i,right:a}).optimize(n);if(i.equivalent_to(a))return p(AST_Binary,e,{operator:"&&",left:i,right:o}).optimize(n)}var s=o.tail_node();if(s instanceof AST_Assign){var f="="==s.operator,c=f?a.tail_node():a;if((f||o===s)&&c instanceof AST_Assign&&s.operator==c.operator&&s.left.equivalent_to(c.left)&&(f&&s.left instanceof AST_SymbolRef||!i.has_side_effects(n)&&g(o)&&g(a)))return p(AST_Assign,e,{operator:s.operator,left:s.left,right:p(AST_Conditional,e,{condition:i,consequent:y(o),alternative:y(a)})})}if(o.equivalent_to(a))return d(e,[i,o]).optimize(n);var u,l=function n(t,r,o){if(!m(t,r))return!o&&p(AST_Conditional,e,{condition:i,consequent:t,alternative:r});var a=n(t.expression,r.expression);if(!a)return;var s=t.clone();return s.expression=a,s}(o,a,!0);if(l)return l;if(o instanceof AST_Call&&a.TYPE==o.TYPE&&(u=v(o,a))>=0&&o.expression.equivalent_to(a.expression)&&!i.has_side_effects(n)&&!o.expression.has_side_effects(n)){var _=o.clone();return _.args[u]=p(AST_Conditional,e,{condition:i,consequent:o.args[u],alternative:a.args[u]}),_}if(o instanceof AST_Conditional&&o.alternative.equivalent_to(a))return p(AST_Conditional,e,{condition:p(AST_Binary,e,{left:i,operator:"&&",right:o.condition}),consequent:o.consequent,alternative:a});if(o instanceof AST_Conditional&&o.consequent.equivalent_to(a))return p(AST_Conditional,e,{condition:p(AST_Binary,e,{left:r,operator:"||",right:o.condition}),consequent:a,alternative:o.alternative});if(a instanceof AST_Conditional&&o.equivalent_to(a.consequent))return p(AST_Conditional,e,{condition:p(AST_Binary,e,{left:i,operator:"||",right:a.condition}),consequent:o,alternative:a.alternative});if(a instanceof AST_Conditional&&o.equivalent_to(a.alternative))return p(AST_Conditional,e,{condition:p(AST_Binary,e,{left:r,operator:"&&",right:a.condition}),consequent:a.consequent,alternative:o});if((o instanceof AST_Sequence||a instanceof AST_Sequence)&&o.tail_node().equivalent_to(a.tail_node()))return d(e,[p(AST_Conditional,e,{condition:i,consequent:b(o),alternative:b(a)}),o.tail_node()]).optimize(n);if(o instanceof AST_Binary&&"&&"==o.operator&&o.right.equivalent_to(a))return p(AST_Binary,e,{operator:"&&",left:p(AST_Binary,e,{operator:"||",left:r,right:o.left}),right:a}).optimize(n);if(o instanceof AST_Binary&&"||"==o.operator&&o.right.equivalent_to(a))return p(AST_Binary,e,{operator:"||",left:p(AST_Binary,e,{operator:"&&",left:i,right:o.left}),right:a}).optimize(n);if(a instanceof AST_Binary&&"&&"==a.operator&&a.right.equivalent_to(o))return p(AST_Binary,e,{operator:"&&",left:p(AST_Binary,e,{operator:"||",left:i,right:a.left}),right:o}).optimize(n);if(a instanceof AST_Binary&&"||"==a.operator&&a.right.equivalent_to(o))return p(AST_Binary,e,{operator:"||",left:p(AST_Binary,e,{operator:"&&",left:r,right:a.left}),right:o}).optimize(n);var S=n.option("booleans")&&n.in_boolean_context();return A(o)?h(a)?T(i):p(AST_Binary,e,{operator:"||",left:T(i),right:a}):h(o)?A(a)?T(i.negate(n)):p(AST_Binary,e,{operator:"&&",left:T(i.negate(n)),right:a}):A(a)?p(AST_Binary,e,{operator:"||",left:T(i.negate(n)),right:o}):h(a)?p(AST_Binary,e,{operator:"&&",left:T(i),right:o}):(n.option("typeofs")&&oe(i,o,a),e);function T(e){return e.is_boolean(n)?e:p(AST_UnaryPrefix,e,{operator:"!",expression:e.negate(n)})}function A(e){return e instanceof AST_True||S&&e instanceof AST_Constant&&e.value||e instanceof AST_UnaryPrefix&&"!"==e.operator&&e.expression instanceof AST_Constant&&!e.expression.value}function h(e){return e instanceof AST_False||S&&(e instanceof AST_Constant&&!e.value||e instanceof AST_UnaryPrefix&&"void"==e.operator&&!e.expression.has_side_effects(n))||e instanceof AST_UnaryPrefix&&"!"==e.operator&&e.expression instanceof AST_Constant&&e.expression.value}function v(e,n){var t=e.args,i=n.args,r=t.length;if(r!=i.length)return-2;for(var o=0;o<r;o++)if(!t[o].equivalent_to(i[o])){for(var a=o+1;a<r;a++)if(!t[a].equivalent_to(i[a]))return-2;return o}return-1}function m(e,n){if(e.TYPE==n.TYPE){if(e instanceof AST_Call){if(-1!=v(e,n))return;return"Call"!=e.TYPE||!(e.expression instanceof AST_PropAccess||n.expression instanceof AST_PropAccess)||m(e.expression,n.expression)}return e instanceof AST_Dot?e.property==n.property:e instanceof AST_Sub?e.property.equivalent_to(n.property):void 0}}function g(e){return e===e.tail_node()||all(e.expressions.slice(0,-1),(function(e){return!e.has_side_effects(n)}))}function y(e){if(!(e instanceof AST_Sequence))return e.right;var n=e.expressions.slice();return n.push(n.pop().right),d(e,n)}function b(e){return e instanceof AST_Sequence?d(e,e.expressions.slice(0,-1)):p(AST_Number,e,{value:0})}})),e(AST_Boolean,(function(e,n){if(!n.option("booleans"))return e;if(n.in_boolean_context())return p(AST_Number,e,{value:+e.value});var t=n.parent();return t instanceof AST_Binary&&("=="==t.operator||"!="==t.operator)?(AST_Node.warn("Non-strict equality against boolean: {operator} {value} [{file}:{line},{col}]",{operator:t.operator,value:e.value,file:t.start.file,line:t.start.line,col:t.start.col}),p(AST_Number,e,{value:+e.value})):p(AST_UnaryPrefix,e,{operator:"!",expression:p(AST_Number,e,{value:1-e.value})})})),e(AST_Spread,(function(e,n){var t=e.expression;return n.option("spread")&&t instanceof AST_Array&&!(n.parent()instanceof AST_Object)?List.splice(t.elements.map((function(e){return e instanceof AST_Hole?p(AST_Undefined,e).optimize(n):e}))):e})),e(AST_Sub,(function(e,n){var t=e.expression,i=e.property;if(n.option("properties")){var o=i.evaluate(n);if(o!==i){if("string"==typeof o)if("undefined"==o)o=void 0;else(D=parseFloat(o)).toString()==o&&(o=D);i=e.property=j(i,T(o,i).transform(n));var a=""+o;if(is_identifier_string(a)&&a.length<=i.print_to_string().length+1)return p(AST_Dot,e,{expression:t,property:a}).optimize(n)}}var s,f,c,u,l=n.parent(),_=z(n.self(),l);if(n.option("arguments")&&t instanceof AST_SymbolRef&&r(s=t.definition())&&!t.in_arg&&i instanceof AST_Number&&(f=s.scope)===function(){var e,t=0;for(;e=n.parent(t++);)if(e instanceof AST_Lambda){if(e instanceof AST_Accessor)return;if(e instanceof AST_Arrow)continue;return c=n.parent(t),e}}()&&f.uses_arguments<(_?2:3)){var S=i.value;l instanceof AST_UnaryPrefix&&"delete"==l.operator&&(s.deleted||(s.deleted=[]),s.deleted[S]=!0);var A=f.argnames[S];if(s.deleted&&s.deleted[S])A=null;else if(A){var h;A instanceof AST_SymbolFunarg?t.scope.find_variable(A.name)!==(h=A.definition())?A=null:!n.has_directive("use strict")&&!f.name&&c instanceof AST_Call&&S<c.args.length&&all(f.argnames,(function(e){return e instanceof AST_SymbolFunarg}))||(!n.option("reduce_vars")||s.reassigned||h.assignments||h.orig.length>1)&&(A=null):A=null}else if(S<f.argnames.length+5&&n.drop_fargs(f,c))for(;S>=f.argnames.length;)A=f.make_var(AST_SymbolFunarg,f,"argument_"+f.argnames.length),f.argnames.push(A);if(A&&find_if((function(e){return e.name===A.name}),f.argnames)===A){s.reassigned=!1;var v=p(AST_SymbolRef,e,A);return v.reference({}),delete A.__unused,v}}if(_)return e;if(n.option("sequences")&&"Call"!=l.TYPE&&!(l instanceof AST_ForIn&&l.init===e)){var m=le(e);if(m!==e)return m.optimize(n)}if(o!==i){var g=e.flatten_object(a,n);g&&(t=e.expression=g.expression,i=e.property=g.property)}if(n.option("properties")&&n.option("side_effects")&&i instanceof AST_Number&&t instanceof AST_Array&&all(u=t.elements,(function(e){return!(e instanceof AST_Spread)}))){var y=u[S=i.value];if(ke(y,n)){for(var b=y instanceof AST_Hole,x=!b,k=[],w=u.length;--w>S;){(D=u[w].drop_side_effect_free(n))&&(k.unshift(D),x&&D.has_side_effects(n)&&(x=!1))}for(x||k.unshift(y);--w>=0;){var D;(D=u[w].drop_side_effect_free(n))?k.unshift(D):b?k.unshift(p(AST_Hole,u[w])):S--}return x?(k.push(y),d(e,k).optimize(n)):p(AST_Sub,e,{expression:p(AST_Array,t,{elements:k}),property:p(AST_Number,i,{value:S})})}}return H(n,e)})),AST_Arrow.DEFMETHOD("contains_this",return_false),AST_Scope.DEFMETHOD("contains_this",(function(){var e,n=this;return n.walk(new TreeWalker((function(t){return!!e||(t instanceof AST_This?e=!0:t!==n&&t instanceof AST_Scope&&!(t instanceof AST_Arrow)||void 0)}))),e})),AST_PropAccess.DEFMETHOD("flatten_object",(function(e,n){if(n.option("properties")){var t=this.expression;if(t instanceof AST_Object)for(var i=t.properties,r=i.length;--r>=0;){var o=i[r];if(o.key==e){if(!all(i,(function(e){return e instanceof AST_ObjectKeyVal&&"string"==typeof e.key})))break;if(!ke(o.value,n))break;return p(AST_Sub,this,{expression:p(AST_Array,t,{elements:i.map((function(e){return e.value}))}),property:p(AST_Number,this,{value:r})})}}}})),e(AST_Dot,(function(e,n){"arguments"!=e.property&&"caller"!=e.property||AST_Node.warn("Function.prototype.{prop} not supported [{file}:{line},{col}]",{prop:e.property,file:e.start.file,line:e.start.line,col:e.start.col});var t=n.parent();if(z(n.self(),t))return e;if(n.option("sequences")&&"Call"!=t.TYPE&&!(t instanceof AST_ForIn&&t.init===e)){var i=le(e);if(i!==e)return i.optimize(n)}if(n.option("unsafe_proto")&&e.expression instanceof AST_Dot&&"prototype"==e.expression.property){var r=e.expression.expression;if(w(r))switch(r.name){case"Array":e.expression=p(AST_Array,e.expression,{elements:[]});break;case"Function":e.expression=p(AST_Function,e.expression,{argnames:[],body:[]}).init_vars(r.scope);break;case"Number":e.expression=p(AST_Number,e.expression,{value:0});break;case"Object":e.expression=p(AST_Object,e.expression,{properties:[]});break;case"RegExp":e.expression=p(AST_RegExp,e.expression,{value:/t/});break;case"String":e.expression=p(AST_String,e.expression,{value:""})}}var o=e.flatten_object(e.property,n);return o?o.optimize(n):H(n,e)})),e(AST_DestructuredKeyVal,(function(e,n){if(n.option("objects")){var t=e.key;t instanceof AST_Node&&(t=t.evaluate(n))!==e.key&&(e.key=""+t)}return e})),e(AST_Object,(function(e,n){if(!n.option("objects"))return e;var t=!1,i=!1,r=!1,o=n.has_directive("use strict"),a=new Dictionary,s=[];if(e.properties.forEach((function(e){if(!(e instanceof AST_Spread))return u(e);i=!0;var o=e.expression;n.option("spread")&&o instanceof AST_Object&&all(o.properties,(function(e){return!(e instanceof AST_ObjectGetter||e instanceof AST_Spread)}))?(t=!0,o.properties.forEach((function(e){u(e instanceof AST_ObjectSetter?p(AST_ObjectKeyVal,e,{key:e.key,value:p(AST_Undefined,e).optimize(n)}):e)}))):(r=!0,c(),s.push(e))})),c(),!t)return e;if(i&&r&&1==s.length){var f=s[0];f instanceof AST_ObjectProperty&&f.key instanceof AST_Number&&(f.key=""+f.key.value)}return t?p(AST_Object,e,{properties:s}):e;function c(){a.each((function(n){if(1==n.length)return s.push(n[0]);t=!0;var i=o&&!r&&n.pop();s.push(1==n.length?n[0]:p(AST_ObjectKeyVal,e,{key:n[0].key,value:d(e,n.map((function(e){return e.value})))})),i&&s.push(i)})),a=new Dictionary}function u(e){var t=e.key;t instanceof AST_Node&&(i=!0,(t=t.evaluate(n))===e.key?r=!0:t=e.key=""+t),e instanceof AST_ObjectKeyVal&&"string"==typeof t?(e.value.has_side_effects(n)&&c(),a.add(t,e)):(c(),s.push(e)),i&&!r&&"string"==typeof t&&/^[1-9]*[0-9]$/.test(t)&&(r=!0,a.has(t)&&(e=a.get(t)[0]),e.key=p(AST_Number,e,{value:+t}))}})),e(AST_Return,(function(e,n){return e.value&&F(e.value,n)&&(e.value=null),e}))}((function(e,n){e.DEFMETHOD("optimize",(function(e){var t=this;if(t._optimized)return t;if(e.has_directive("use asm"))return t;var i=n(t,e);return i._optimized=!0,i}))}))}}]);